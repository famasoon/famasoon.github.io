<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.120.4"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>x64.moe</title>
<meta name=keywords content="Blog,Portfolio"><meta name=description content="FAMASoon's blog"><meta name=author content="FAMASoon"><link rel=canonical href=https://famasoon.github.io/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><link rel=icon href=https://famasoon.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://famasoon.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://famasoon.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://famasoon.github.io/apple-touch-icon.png><link rel=mask-icon href=https://famasoon.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://famasoon.github.io/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZJPXHR8YPR"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZJPXHR8YPR",{anonymize_ip:!1})}</script><meta property="og:title" content="x64.moe"><meta property="og:description" content="FAMASoon's blog"><meta property="og:type" content="website"><meta property="og:url" content="https://famasoon.github.io/"><meta property="og:image" content="https://famasoon.github.io/static/famasoon.jpg"><meta property="og:site_name" content="x64.moe"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://famasoon.github.io/static/famasoon.jpg"><meta name=twitter:title content="x64.moe"><meta name=twitter:description content="FAMASoon's blog"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"x64.moe","url":"https://famasoon.github.io/","description":"FAMASoon\u0026#39;s blog","thumbnailUrl":"https://famasoon.github.io/favicon.ico","sameAs":["https://twitter.com/FAMASoon","https://github.com/famasoon"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://famasoon.github.io/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://famasoon.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://famasoon.github.io/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class="first-entry home-info"><header class=entry-header><h1>x64.moe ğŸ‘‹</h1></header><div class=entry-content>Welcome to FAMASoon&rsquo;s blog</div><footer class=entry-footer><div class=social-icons><a href=https://twitter.com/FAMASoon target=_blank rel="noopener noreferrer me" title=Twitter><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a><a href=https://github.com/famasoon target=_blank rel="noopener noreferrer me" title=Github><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></div></footer></article><article class=post-entry><header class=entry-header><h2>DLL proxying with Rust</h2></header><div class=entry-content><p>DLL proxying with Rust what is dll proxying? DLL proxying, also known as DLL redirection or DLL hijacking, is a technique used by attackers or developers to manipulate the way Windows loads dynamic link libraries (DLLs). DLLs are files that contain code and data that multiple programs can use simultaneously. They provide a way to modularize code and promote code reuse.
DLL proxying involves placing a malicious or modified DLL in a location that is searched by a target application before the legitimate DLL is located....</p></div><footer class=entry-footer>&lt;span title='2023-11-23 00:00:00 +0000 UTC'>November 23, 2023&lt;/span>&amp;nbsp;Â·&amp;nbsp;3 min&amp;nbsp;Â·&amp;nbsp;521 words&amp;nbsp;Â·&amp;nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to DLL proxying with Rust" href=https://famasoon.github.io/posts/proxyingdll/></a></article><article class=post-entry><header class=entry-header><h2>Anti-debug introduction</h2></header><div class=entry-content><p>Anti-debug ã‚¢ãƒ³ãƒãƒ‡ãƒãƒƒã‚°ã®ã‚„ã‚Šæ–¹ã¯ãŸãã•ã‚“ã‚ã‚‹ãŒã€ãã®ä¸­ã§ã‚‚ã‚ˆãä½¿ã‚ã‚Œã‚‹ã‚‚ã®ã‚’ç´¹ä»‹ã™ã‚‹ã€‚
ç¶²ç¾…çš„ã«æŠŠæ¡ã—ãŸã„å ´åˆã¯ä¸‹è¨˜ãƒªãƒ³ã‚¯ã‚’å‚ç…§ã™ã‚‹ã¨è‰¯ã„ã€‚
https://unprotect.it/category/anti-debugging/
å¤å…¸çš„ãªã‚¢ãƒ³ãƒãƒ‡ãƒãƒƒã‚° bool FindDebugger() { bool bDetect = false; HWND hDebugger = ::FindWindow(NULL, "OllyDBG"); if (hDebugger) { bDetect = true; AfxMessageBox("Can not use debugger"); } return bDetect; } ãƒ‡ãƒãƒƒã‚¬ãƒ¼ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ‚äº†ã•ã›ã‚‹ã€‚
IsDebuggerPresent MSDNã«è¨˜è¼‰ã•ã‚Œã¦ã„ã¦kernel32.dllã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ã‚‹ã€‚
if (IsDebuggerPresent()) { exit(1); } ã‚¢ã‚»ãƒ³ãƒ–ãƒªã«ãªã‚‹ã¨ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚‹
mov eax, dword ptf fs:[18] mov eax, dword ptr ds:[eax+30] movzx eax, byte ptr ds:[eax+2] retn fs:[18] ã¯TEBã‚’æŒ‡ã™ã€‚(Thread Environment Block)
TEBã‚’EAXã«å…¥ã‚ŒãŸãŒãã“ã‹ã‚‰30ç•ªåœ°é›¢ã‚ŒãŸã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å†ã³EAXã«å…¥åŠ›ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã ã€‚
TEBã‹ã‚‰0x30é›¢ã‚ŒãŸã¨ã“ã‚ã«ã¯PEB(Process Environment Block) ãŒã‚ã‚‹ã€‚
EAXã«ã¯PEBãŒå…¥ã£ã¦ã„ã¦ã€ãã“ã‹ã‚‰+2ç§»å‹•ã—ãŸã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰1ãƒã‚¤ãƒˆæŒã£ã¦ãã¦ã„ã‚‹ã¨è§£é‡ˆã§ãã‚‹ã€‚
PEBã®æ§‹é€ ä½“ã¯ä¸‹è¨˜ã®é€šã‚Šã€‚
typedef struct _PEB { BYTE Reserved1[2]; BYTE BeingDebugged; BYTE Reserved2[1]; PVOID Reserved3[2]; PPEB_LDR_DATA Ldr; PRTL_USER_PROCESS_PARAMETERS ProcessParameters; PVOID Reserved4[3]; PVOID AtlThunkSListPtr; PVOID Reserved5; ULONG Reserved6; PVOID Reserved7; ULONG Reserved8; ULONG AtlThunkSListPtr32; PVOID Reserved9[45]; BYTE Reserved10[96]; PPS_POST_PROCESS_INIT_ROUTINE PostProcessInitRoutine; BYTE Reserved11[128]; PVOID Reserved12[1]; ULONG SessionId; } PEB, *PPEB; BeingDebugged ã¨ã„ã†åå‰ã®ç®‡æ‰€ã®å€¤ã‚’å…¥ã‚Œã¦ã„ã‚‹ã€‚...</p></div><footer class=entry-footer>&lt;span title='2023-10-12 00:00:00 +0000 UTC'>October 12, 2023&lt;/span>&amp;nbsp;Â·&amp;nbsp;5 min&amp;nbsp;Â·&amp;nbsp;854 words&amp;nbsp;Â·&amp;nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to Anti-debug introduction" href=https://famasoon.github.io/posts/antidebug/></a></article><article class=post-entry><header class=entry-header><h2>AMSI bypass</h2></header><div class=entry-content><p>ã‚¹ã‚­ãƒ£ãƒ³è¦æ±‚ã‚’å¤±æ•—ã•ã›ã‚‹ãŸã‚ã«ã€ã™ã§ã«ãƒ¡ãƒ¢ãƒªã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹AMSI ãƒ©ã‚¤ãƒ–ãƒ©ãƒªè‡ªä½“ã®ã‚³ãƒ¼ãƒ‰ã‚’æ”¹ã–ã‚“ã™ã‚‹. ãƒ¡ãƒ¢ãƒªã«ã™ã§ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ AmsiScanBuffer ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ¢ã—å‡ºã—ã€ãã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å‘½ä»¤ã‚’ä¸Šæ›¸ãã—ã¦ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã•ã›ã¾ã™ã€‚ã“ã®æ”»æ’ƒã§ã¯ã€ãƒãƒ«ã‚¦ã‚§ã‚¢ãŒãƒ¡ãƒ¢ãƒªå†…ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€ŒAmsiScanBufferã€ã‚’æ¢ã—å‡ºã—ã€ãã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å‘½ä»¤ã‚’ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹æ–°ã—ã„å‘½ä»¤ã§ä¸Šæ›¸ãã—ã¾ã™ã€‚
[package] name = "amsibypass" version = "0.1.0" edition = "2021" # See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html [[bin]] name = "amsi_bypass" path = "src/main.rs" [dependencies] winapi = {version = "0.3.9", features=["memoryapi", "libloaderapi", "processthreadsapi"]} win32-error = "0.9.0" use std::{ffi::CString, ptr}; use winapi::{ um::{ memoryapi::{ VirtualProtect, WriteProcessMemory }, libloaderapi::{ LoadLibraryA, GetProcAddress }, processthreadsapi::GetCurrentProcess, winnt::PAGE_READWRITE }, shared::{ minwindef::{ DWORD, FALSE }, ntdef::NULL } }; fn main() { println!...</p></div><footer class=entry-footer>&lt;span title='2023-10-11 00:00:00 +0000 UTC'>October 11, 2023&lt;/span>&amp;nbsp;Â·&amp;nbsp;1 min&amp;nbsp;Â·&amp;nbsp;167 words&amp;nbsp;Â·&amp;nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to AMSI bypass" href=https://famasoon.github.io/posts/amsibypass/></a></article><article class=post-entry><header class=entry-header><h2>Offensive Rustã®ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2></header><div class=entry-content><p>Offensive Rust ã‹ã‚“ãŸã‚“ãªã¾ã¨ã‚: Rustã§ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ãƒ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã‚’æ›¸ããŸã„äººã«ãŠã™ã™ã‚ã€‚
ãƒªãƒ³ã‚¯ https://redteamsorcery.teachable.com/courses/enrolled/1973492
https://www.udemy.com/course/offensive-rust/
ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆã¯ãªã„ã§ã™ã€‚
æ¦‚è¦ æœ¬æ•™æã§ã¯ã‚ªãƒ•ã‚§ãƒ³ã‚·ãƒ–ãªã‚³ãƒ¼ãƒ‰ã€ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ãƒ å‘ã‘ã®ã‚³ãƒ¼ãƒ‰ã‚’Rustã§æ›¸ã„ã¦ã„ãã€‚
ãªãŠã€å¯¾è±¡ç’°å¢ƒã¯Windowsã€‚
WSLã¨ã‹ã§ã¯ãªãWindowsã«ç›´æ¥Rustã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚
å†…å®¹ å†…å®¹ã¯ã‹ãªã‚Šå¤šå²ã«ã‚ãŸã‚‹ã€‚
æœ€åˆã®æ–¹ã§ã¯Rustã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’å®Ÿæ–½ã—ã€åŸºç¤çš„ãªRustã®æ›¸ãæ–¹ã‚’æ•™ãˆã¦ãã‚Œã‚‹ã€‚
ä¸­ç›¤ã‹ã‚‰ã¯ã‚ªãƒ•ã‚§ãƒ³ã‚·ãƒ–ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ãã€‚
ä¾‹ãˆã°LDAPã‚’ç”¨ã„ãŸActive Directoryã®åˆ—æŒ™ã§ã‚ã£ãŸã‚Šã€ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ãŸã‚Šã€DLLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡Œã£ãŸã‚Šã¨ã€åŸºæœ¬çš„ãªRustã®æ›¸ãæ–¹ã‚’æŠ‘ãˆã¤ã¤ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ãƒ å‘ã‘ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ãã€‚
ã¾ãŸã€Reflective PE Loaderã‚’æ›¸ã„ãŸã‚Šã€Process Hollowingã‚’ã‚„ã£ãŸã‚Šã€ãƒãƒƒã‚·ãƒ¥åŒ–ã—ãŸé–¢æ•°å‘¼ã³å‡ºã—ã‚’ã—ãŸã‚Šã¨ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ãƒ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã§å®Ÿè¡Œã—ãã†ãªå†…å®¹ã‚’Rustã§ã©ã®ã‚ˆã†ã«æ›¸ãã‹æ•™ãˆã¦ãã‚Œã‚‹ã€‚
ä»¥é™ã‚‚AMSIã®ãƒã‚¤ãƒ‘ã‚¹ã®ä»•æ–¹ã‚„Process Doppelgangingã®ä»•æ–¹ã‚’Rustã§è§£èª¬ã—ã¦ãã‚Œã‚‹ã€‚
ç·ã˜ã¦ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ãƒ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã‚’Rustã§æ›¸ã„ã¦ã¿ãŸã„ã¨æ–¹ã«ã¯ãŠã™ã™ã‚ã®å†…å®¹ã€‚
å„ãƒ‘ãƒ¼ãƒˆã¯ä½“æ„Ÿã§ã¯ãã“ã¾ã§é•·ããªãã€ã‚µãƒƒã¨æ›¸ã„ã¦ã‚µãƒƒã¨è©¦ã™ã¨ã„ã†ã“ã¨ã‚’ã‚„ã£ã¦ã„ãã€‚
ã¾ã¨ã‚ ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ãƒ å‘ã‘ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã‚’æ›¸ããŸã„ã¨ãªã£ãŸã¨ãã€å€™è£œã¨ã—ã¦ã¯C/C++ãŒæŒ™ãŒã‚‹ãŒRustã§æ›¸ããŸã„äººã¯ã€ã“ã®æ•™æã‚’è²·ã£ã¦è¦‹ã¦ã¿ã‚‹ã¨è‰¯ã„ã ã‚ã†ã€‚</p></div><footer class=entry-footer>&lt;span title='2023-10-11 00:00:00 +0000 UTC'>October 11, 2023&lt;/span>&amp;nbsp;Â·&amp;nbsp;1 min&amp;nbsp;Â·&amp;nbsp;28 words&amp;nbsp;Â·&amp;nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to Offensive Rustã®ãƒ¬ãƒ“ãƒ¥ãƒ¼" href=https://famasoon.github.io/posts/offensiverustreview/></a></article><article class=post-entry><header class=entry-header><h2>PEã«ã¤ã„ã¦ãƒ¡ãƒ¢</h2></header><div class=entry-content><p>What is PE PEãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯Portable Executable File Formatã®ç•¥ã€‚
ãƒãƒ¼ã‚¿ãƒ–ãƒ«ãªå®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚ã‚‹ã€‚
ãƒ“ãƒ«ãƒ‰ ãŸã¨ãˆã°test.cppã¨ã„ã£ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã¨ã€ã¾ãšé–¢é€£ã™ã‚‹ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ã‚½ãƒ¼ã‚¹ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—1ã¤ã®æ©Ÿæ¢°èªã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã€‚
ã“ã®æ®µéšã§Releaseãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«objãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚
æ¬¡ã«ãƒªãƒ³ã‚¯ä½œæ¥­ãŒè¡Œã‚ã‚Œã‚‹ã€‚
ãƒªãƒ³ã‚«ã¯OSã§ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«å‹•çš„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚„æ§˜ã€…ãªãƒªã‚½ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ã€ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ»ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã®æƒ…å ±ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãå‡ºã™ã€‚
ã“ã®éš›ã«Windowsã¯æ±ºã¾ã£ãŸãƒ«ãƒ¼ãƒ«ã«æ²¿ã£ã¦æƒ…å ±ã‚’ç”¨æ„ã—Exeãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹éš›ã«ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã«æƒ…å ±ã‚’æ›¸ãè¾¼ã‚€ã€‚
ã“ã‚ŒãŒPEãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ä½œæˆã™ã‚‹å‡¦ç†ã§ã‚ã‚‹ã€‚
PEãƒ˜ãƒƒãƒ€ãƒ¼ã®ä¸­ã«ã¯å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«æ§˜ã€…ãªæƒ…å ±ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹ã€‚
PEãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€  IMAGE_DOS_HEADER IMAGE_NT_HEADER IMAGE_FILE_HEADER IMAGE_OPTIONAL_HEADER IMAGE_SECTION_HEADER IMAGE_IMPORT_DESCRIPTOR IMAGE_EXPORT_DIRECTORY IMAGE_IMPORT_BY_NAME IMAGE_THUNK_DATA32 ä¸»è¦ãªæ§‹é€ ä½“ã¯ä¸Šè¨˜ã®é€šã‚Šã€‚
IMAGE_DOS_HEADER typedef struct _IMAGE_DOS_HEADER { // DOS .EXE header WORD e_magic; // Magic number WORD e_cblp; // Bytes on last page of file WORD e_cp; // Pages in file WORD e_crlc; // Relocations WORD e_cparhdr; // Size of header in paragraphs WORD e_minalloc; // Minimum extra paragraphs needed WORD e_maxalloc; // Maximum extra paragraphs needed WORD e_ss; // Initial (relative) SS value WORD e_sp; // Initial SP value WORD e_csum; // Checksum WORD e_ip; // Initial IP value WORD e_cs; // Initial (relative) CS value WORD e_lfarlc; // File address of relocation table WORD e_ovno; // Overlay number WORD e_res[4]; // Reserved words WORD e_oemid; // OEM identifier (for e_oeminfo) WORD e_oeminfo; // OEM information; e_oemid specific WORD e_res2[10]; // Reserved words LONG e_lfanew; // File address of new exe header } IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER; e_magic , e_lfanew ã«ã¤ã„ã¦æ³¨ç›®ã™ã‚‹ã¨ã‚ˆã„ã€‚...</p></div><footer class=entry-footer>&lt;span title='2023-07-21 00:00:00 +0000 UTC'>July 21, 2023&lt;/span>&amp;nbsp;Â·&amp;nbsp;3 min&amp;nbsp;Â·&amp;nbsp;590 words&amp;nbsp;Â·&amp;nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to PEã«ã¤ã„ã¦ãƒ¡ãƒ¢" href=https://famasoon.github.io/posts/whatispe/></a></article><article class=post-entry><header class=entry-header><h2>LibFuzzerã‚’ä½¿ã£ãŸ</h2></header><div class=entry-content><p>LibFuzzerã‚’ä½¿ã£ãŸ https://x64.moe/posts/whatslibfuzzer/ ã“ã‚“ãªæ„Ÿã˜ã«ãƒ•ã‚¡ã‚¸ãƒ³ã‚°ã§ãã‚‹LibFuzzerã‚’ä½¿ã£ã¦ã¿ãŸã€‚ çµè«–ã¨ã—ã¦ã¯ã©ã‚Œã‚‚ã†ã¾ãã„ã‹ãªã‹ã£ãŸ(ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã„ãƒ»ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ã¦ã‚‚é…å¸ƒã•ã‚Œã‚‹ãƒ“ãƒ«ãƒ‰ã®ã‚‚ã®ã ã¨ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã„ç­‰ãªã©)
ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ Jansson https://github.com/akheron/jansson ãªã‚“ã‹ã®ãƒ‘ãƒ¼ã‚µãŒã‚„ã‚Šã‚„ã™ã„ã‹ãªã¨æ€ã£ã¦JSONãƒ‘ãƒ¼ã‚µã®Janssonã‚’é¸ã‚“ã ã€‚
#include &lt;stddef.h> #include &lt;stdint.h> #include "jansson.h" int parseJson(const char *buffer, size_t buflen) { json_error_t error; json_t *root; json_t *obj; const char *str; double dValue; int iValue; root = json_loadb(buffer, buflen, 0, &amp;error); if (root == NULL) { return 0; } obj = json_object_get(root, "dateTime"); if (json_is_string(obj)) { str = json_string_value(obj); } obj = json_object_get(root, "eventType"); if (json_is_string(obj)) { str = json_string_value(obj); } obj = json_object_get(root, "DependOnSequentialEvent"); if (json_is_object(obj)) { json_t *obj2; obj2 = json_object_get(obj, "valPercent"); if (json_is_real(obj2)) { dValue = json_real_value(obj2); } else if (json_is_integer(obj2)) { iValue = json_integer_value(obj2); } obj2 = json_object_get(obj, "alive"); if (json_is_string(obj2)) { str = json_string_value(obj2); } obj2 = json_object_get(obj, "isScript"); } return 0; } extern "C" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) { if (size &lt; 0) { return -1; } parseJson((const char *)data, size); return 0; } ãƒ“ãƒ«ãƒ‰å†…å®¹ã¯ä¸‹è¨˜ã®ã‚ˆã†ãªæ„Ÿã˜ ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã‹ã£ãŸã€‚...</p></div><footer class=entry-footer>&lt;span title='2023-07-04 00:00:00 +0000 UTC'>July 4, 2023&lt;/span>&amp;nbsp;Â·&amp;nbsp;2 min&amp;nbsp;Â·&amp;nbsp;306 words&amp;nbsp;Â·&amp;nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to LibFuzzerã‚’ä½¿ã£ãŸ" href=https://famasoon.github.io/posts/libfuzzerfail/></a></article><article class=post-entry><header class=entry-header><h2>LibFuzzer's Example</h2></header><div class=entry-content><p>What is LibuFuzzer? Libfuzzer is a library part of LLVM that can be used to fuzz test programs.
Example Build the fuzzing target.
#include &lt;stdint.h> #include &lt;stddef.h> bool FuzzMe(const uint8_t *Data, size_t DataSize) { return DataSize >= 3 && Data[0] == 'F' && Data[1] == 'U' && Data[2] == 'Z' && Data[3] == 'Z'; } extern "C" int LLVMFuzzerTestOneInput(const uint8_t *Data, size_t Size) { FuzzMe(Data, Size); return 0; } First, write LLVMFuzzerTestOneInput function....</p></div><footer class=entry-footer>&lt;span title='2023-06-29 00:00:00 +0000 UTC'>June 29, 2023&lt;/span>&amp;nbsp;Â·&amp;nbsp;4 min&amp;nbsp;Â·&amp;nbsp;805 words&amp;nbsp;Â·&amp;nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to LibFuzzer's Example" href=https://famasoon.github.io/posts/whatslibfuzzer/></a></article><article class=post-entry><header class=entry-header><h2>[Note] LibAFLã¨ã¯ãªã«ã‹</h2></header><div class=entry-content><p>LibAFL ã¨ã¯ https://aflplus.plus/libafl-book/libafl.html ãƒ•ã‚¡ã‚¸ãƒ³ã‚°ã®ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚ AFL, libFuzzer, honggfuzz ã¨ã„ã£ãŸãƒ•ã‚¡ã‚¶ãƒ¼ã¯å­˜åœ¨ã™ã‚‹ãŒæ‹¡å¼µæ€§ãŒãªã„ã€‚ å€‹ã€…ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«å¯¾ã—ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½ãªãƒ•ã‚¡ã‚¶ãƒ¼ã‚’ä½œã‚‹ãŸã‚ã«é–‹ç™ºã•ã‚ŒãŸã€‚
ç‰¹å¾´ ãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œ OSä¾å­˜ã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’å¿…è¦ã¨ã—ã¦ã„ãªã„ ãªã®ã§çµ„ã¿è¾¼ã¿ãƒ‡ãƒã‚¤ã‚¹ã‚„ãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ã€WASMãªã©ã«ã¤ã‹ãˆã‚‹(ã‚‰ã—ã„) AFLPlusPlusã§åŸ¹ã£ãŸçµŒé¨“ãŒæ´»ã‹ã•ã‚Œã¦ã„ã‚‹ ã‚¹ã‚±ãƒ¼ãƒ«ã—ã‚„ã™ã„ã‚‰ã—ã„ æ—©ã„ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«åˆã‚ã›ã¦ã‚«ã‚¹ã‚¿ãƒ ã§ãã‚‹ å…¥é–€ crate ã¨ã—ã¦ä½¿ãˆã‚‹ã€‚ æ³¨æ„ç‚¹ã¨ã—ã¦Clangã«ä¾å­˜ã—ã¦ã„ã‚‹ã®ã§äºˆã‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
å„ç¨®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ cargo build --release ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ãƒ“ãƒ«ãƒ‰ã§ãã‚‹ã€‚ ä¸‹è¨˜ã®ã‚ˆã†ã« Cargo.toml ã«æ›¸ã‘ã°è‰¯ã„(ç§ã¯ cargo add ã§å…¥ã‚ŒãŸ)
[dependencies] libafl = { version = "*" } è‰²ã€…ã¨ã‚«ã‚¹ã‚¿ãƒ ã§ãã‚‹ãŒã‚¯ãƒ¬ãƒ¼ãƒˆã¨ã—ã¦ã¯ libafl ã‚’ä½¿ãˆã°è‰¯ã•ãã†ã€‚ ä»–ã®ã‚¯ãƒ¬ãƒ¼ãƒˆã®èª¬æ˜ã¯ã“ã¡ã‚‰ã€‚ https://aflplus.plus/libafl-book/getting_started/crates.html
ã‚³ãƒ³ã‚»ãƒ—ãƒˆ Observer ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®ã·ã‚ãã‚‰ã‚€ã®å®Ÿè¡Œã‚’ç›£è¦–ã—ã€ãã®æƒ…å ±ã‚’ãƒ•ã‚¡ã‚¶ãƒ¼ã«æä¾›ã™ã‚‹ã‚‚ã®ã§ã™ã€‚ ã“ã‚Œã¯ Observer ãƒˆãƒ¬ã‚¤ãƒˆã«æ›¸ã‹ã‚Œã¦ã„ã‚‹ã€‚ å„ãƒ•ã‚¡ã‚¸ãƒ³ã‚°ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã—ãŸã‚Šãƒ•ã‚¡ã‚¸ãƒ³ã‚°ã‚±ãƒ¼ã‚¹ã®å‰å¾Œã§ãƒ•ãƒƒã‚¯ã—ãŸã‚Šã§ãã‚‹ã€‚
Executor ãƒ†ã‚¹ãƒˆå¯¾å‡¦ã®å®Ÿè¡Œã«é–¢ã™ã‚‹æ“ä½œã‚’å®šç¾©ã™ã‚‹ã‚‚ã®ã€‚ ãƒ•ã‚¡ã‚¶ãƒ¼ï¼ãŒå®Ÿè¡Œã§ä½¿ç”¨ã—ãŸã„å…¥åŠ›ã«ã¤ã„ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«é€šçŸ¥ã—ã€ç‰¹å®šã®ãƒ¡ãƒ¢ãƒªã®å ´æ‰€ã«æ›¸ãè¾¼ã‚“ã ã‚Šã€ãã‚Œã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ãƒãƒ¼ãƒã‚¹ã«æ¸¡ã™è²¬ä»»ãŒã‚ã‚‹ã€‚ Executor ãƒˆãƒ¬ã‚¤ã¨ã§æä¾›ã•ã‚Œã¦ã„ã‚‹ã€‚ InprocessExecutor ã¯ãƒ—ãƒ­ã‚»ã‚¹å†…ã®ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã‚’æ¤œå‡ºã™ã‚‹ã€‚ ForkserverExecutor å­ãƒ—ãƒ­ã‚»ã‚¹ã‚’ãƒ•ã‚¡ã‚ºã™ã‚‹ã¨ãã«ä½¿ã†ã€‚
InprocessExecotr ã¯ãƒ•ã‚¡ã‚¶ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹å†…ã®ãƒãƒ¼ãƒã‚¹ã‚’å®Ÿè¡Œã™ã‚‹ã€‚ ãƒãƒ¼ãƒã‚¹ã‚’ã§ãã‚‹ã ã‘æ—©ãå®Ÿè¡Œã—ãŸã„ã¨ãã¯ã“ã‚Œã‚’æ¡ç”¨ã™ã‚‹ã€‚ æ³¨æ„ã™ã‚‹ã¹ãç‚¹ã¯ãƒãƒ¼ãƒã‚¹ã«ãƒ’ãƒ¼ãƒ—å‘¨ã‚Šã®ãƒã‚°ãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹å ´åˆã€ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãŸãƒ’ãƒ¼ãƒ—ãŒãƒ•ã‚¡ã‚¶ãƒ¼ã«å½±éŸ¿ã‚’ä¸ãˆãªã„ã‚ˆã†ã«åˆ¥ã®ã‚¢ãƒ­ã‚±ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ ä¾‹ãˆã°MiMallocã‚’ä½¿ç”¨ã™ã‚‹ãªã©ã€‚ ã‚ã‚‹ã„ã¯ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚µãƒ‹ã‚¿ã‚¤ã‚¶ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ãƒãƒ¼ãƒã‚¹ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ãƒ’ãƒ¼ãƒ—å‘¨ã‚Šã®ãƒã‚°ã‚’è£œè¶³ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
ForkserverExecutor ã¯å…±æœ‰ãƒ¡ãƒ¢ãƒªã‚’ä½¿ç”¨ã—ã¦ãƒãƒ¼ãƒã‚¹ã‚’å®Ÿè¡Œã™ã‚‹ã€‚
InprocessForkExecutor ã¯ãƒãƒ¼ãƒã‚¹ã‚’å®Ÿè¡Œã™ã‚‹å‰ã«åˆ†å²ã™ã‚‹ã€‚ ãƒãƒ¼ãƒã‚¹ãŒä¸å®‰å®šã«ãªã£ãŸã‚Šã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ã‚ˆã†ãªå ´åˆã€å­ãƒ—ãƒ­ã‚»ã‚¹ã§ãƒãƒ¼ãƒã‚¹ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ ãã®ã‚ˆã†ãªæ™‚ã«ä½¿ç”¨ã™ã‚‹ã€‚ ãŸã ã—ãƒãƒ¼ãƒã‚¹ã‚’å®Ÿè¡Œã—ã€ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’ãƒãƒƒãƒ—ã«æ›¸ãã®ã¯å­ãƒ—ãƒ­ã‚»ã‚¹ã€‚ è¦ªãƒ—ãƒ­ã‚»ã‚¹ã¨å­ãƒ—ãƒ­ã‚»ã‚¹ã®é–“ã§ãƒãƒƒãƒ—ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«å…±æœ‰ãƒ¡ãƒ¢ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã€‚...</p></div><footer class=entry-footer>&lt;span title='2023-06-10 00:00:00 +0000 UTC'>June 10, 2023&lt;/span>&amp;nbsp;Â·&amp;nbsp;1 min&amp;nbsp;Â·&amp;nbsp;104 words&amp;nbsp;Â·&amp;nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to [Note] LibAFLã¨ã¯ãªã«ã‹" href=https://famasoon.github.io/posts/libafl/></a></article><article class=post-entry><header class=entry-header><h2>Dll Injection with Rust</h2></header><div class=entry-content><p>winapi winapi provides raw FFI bindings to all of Windows API. So, I will use this crate.
code When run command cargo run, it can be inject dll to process
use winapi::ctypes::*; use winapi::um::libloaderapi::{GetModuleHandleA, GetProcAddress}; use winapi::um::memoryapi::{VirtualAllocEx, WriteProcessMemory}; use winapi::um::processthreadsapi::{CreateRemoteThread, OpenProcess}; pub fn DllInject(proc_handle: *mut c_void, dll_path: &amp;str) { unsafe { let remote_base = VirtualAllocEx( proc_handle, std::ptr::null_mut(), dll_path.len(), 0x1000, 0x40, ); WriteProcessMemory( proc_handle, remote_base, dll_path.as_bytes().as_ptr() as *const c_void, dll_path.len(), std::ptr::null_mut(), ); let dll_handle = GetModuleHandleA("kernel32....</p></div><footer class=entry-footer>&lt;span title='2023-06-06 00:00:00 +0000 UTC'>June 6, 2023&lt;/span>&amp;nbsp;Â·&amp;nbsp;1 min&amp;nbsp;Â·&amp;nbsp;129 words&amp;nbsp;Â·&amp;nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to Dll Injection with Rust" href=https://famasoon.github.io/posts/dllinjectionwithrust/></a></article><article class=post-entry><header class=entry-header><h2>Executing functions in Rust with winapi</h2></header><div class=entry-content><p>Motivation I want to how to allocate memory on windows and execute code in buffers.
winapi winapi provides raw FFI bindings to all of Windows API. So, I will use this crate.
code When run command cargo run, popup calc.exe
use std::mem::transmute; use winapi::um::errhandlingapi::GetLastError; use winapi::um::memoryapi::VirtualAlloc; use winapi::um::processthreadsapi::CreateThread; use winapi::um::synchapi::WaitForSingleObject; fn main() { let buffer: [u8; 276] = [ 0xfc, 0x48, 0x83, 0xe4, 0xf0, 0xe8, 0xc0, 0x00, 0x00, 0x00, 0x41, 0x51, 0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xd2, 0x65, 0x48, 0x8b, 0x52, 0x60, 0x48, 0x8b, 0x52, 0x18, 0x48, 0x8b, 0x52, 0x20, 0x48, 0x8b, 0x72, 0x50, 0x48, 0x0f, 0xb7, 0x4a, 0x4a, 0x4d, 0x31, 0xc9, 0x48, 0x31, 0xc0, 0xac, 0x3c, 0x61, 0x7c, 0x02, 0x2c, 0x20, 0x41, 0xc1, 0xc9, 0x0d, 0x41, 0x01, 0xc1, 0xe2, 0xed, 0x52, 0x41, 0x51, 0x48, 0x8b, 0x52, 0x20, 0x8b, 0x42, 0x3c, 0x48, 0x01, 0xd0, 0x8b, 0x80, 0x88, 0x00, 0x00, 0x00, 0x48, 0x85, 0xc0, 0x74, 0x67, 0x48, 0x01, 0xd0, 0x50, 0x8b, 0x48, 0x18, 0x44, 0x8b, 0x40, 0x20, 0x49, 0x01, 0xd0, 0xe3, 0x56, 0x48, 0xff, 0xc9, 0x41, 0x8b, 0x34, 0x88, 0x48, 0x01, 0xd6, 0x4d, 0x31, 0xc9, 0x48, 0x31, 0xc0, 0xac, 0x41, 0xc1, 0xc9, 0x0d, 0x41, 0x01, 0xc1, 0x38, 0xe0, 0x75, 0xf1, 0x4c, 0x03, 0x4c, 0x24, 0x08, 0x45, 0x39, 0xd1, 0x75, 0xd8, 0x58, 0x44, 0x8b, 0x40, 0x24, 0x49, 0x01, 0xd0, 0x66, 0x41, 0x8b, 0x0c, 0x48, 0x44, 0x8b, 0x40, 0x1c, 0x49, 0x01, 0xd0, 0x41, 0x8b, 0x04, 0x88, 0x48, 0x01, 0xd0, 0x41, 0x58, 0x41, 0x58, 0x5e, 0x59, 0x5a, 0x41, 0x58, 0x41, 0x59, 0x41, 0x5a, 0x48, 0x83, 0xec, 0x20, 0x41, 0x52, 0xff, 0xe0, 0x58, 0x41, 0x59, 0x5a, 0x48, 0x8b, 0x12, 0xe9, 0x57, 0xff, 0xff, 0xff, 0x5d, 0x48, 0xba, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8d, 0x8d, 0x01, 0x01, 0x00, 0x00, 0x41, 0xba, 0x31, 0x8b, 0x6f, 0x87, 0xff, 0xd5, 0xbb, 0xe0, 0x1d, 0x2a, 0x0a, 0x41, 0xba, 0xa6, 0x95, 0xbd, 0x9d, 0xff, 0xd5, 0x48, 0x83, 0xc4, 0x28, 0x3c, 0x06, 0x7c, 0x0a, 0x80, 0xfb, 0xe0, 0x75, 0x05, 0xbb, 0x47, 0x13, 0x72, 0x6f, 0x6a, 0x00, 0x59, 0x41, 0x89, 0xda, 0xff, 0xd5, 0x63, 0x61, 0x6c, 0x63, 0x2e, 0x65, 0x78, 0x65, 0x00, ]; unsafe { let baseptr = VirtualAlloc(std::ptr::null_mut(), buffer....</p></div><footer class=entry-footer>&lt;span title='2023-06-04 00:00:00 +0000 UTC'>June 4, 2023&lt;/span>&amp;nbsp;Â·&amp;nbsp;2 min&amp;nbsp;Â·&amp;nbsp;388 words&amp;nbsp;Â·&amp;nbsp;FAMASoon</footer><a class=entry-link aria-label="post link to Executing functions in Rust with winapi" href=https://famasoon.github.io/posts/execfuncrustwithwinapi/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://famasoon.github.io/page/2/>Next&nbsp;&nbsp;Â»</a></nav></footer></main><footer class=footer><span>&copy; 2023 <a href=https://famasoon.github.io/>x64.moe</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>